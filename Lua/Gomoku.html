<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>五子棋（Gomoku） | 潇淼文档</title>
    <meta name="generator" content="VuePress 1.7.1">
    <link rel="icon" href="/favicon.ico">
    <script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?bcbe8dcd550616b188183a023ba3e682";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>
    <meta name="description" content="MiniDoc">
    <meta name="robots" content="all">
    <meta name="author" content="msk11@qq.com">
    <meta name="copyright" content="Hcat">
    <meta name="revisit-after" content="7 days">
    <meta name="keywords" content="潇淼文档,潇淼,迷你世界,文档,迷你,mini,doc,世界,MiniWorld,脚本,教程">
    <meta name="apple-mobile-web-app-capable" content="yes">
    
    <link rel="preload" href="/assets/css/0.styles.84203ac8.css" as="style"><link rel="preload" href="/assets/js/app.ef735673.js" as="script"><link rel="preload" href="/assets/js/2.b51029ec.js" as="script"><link rel="preload" href="/assets/js/37.72568f5d.js" as="script"><link rel="prefetch" href="/assets/js/10.08f53c0a.js"><link rel="prefetch" href="/assets/js/11.852fe533.js"><link rel="prefetch" href="/assets/js/12.387441d1.js"><link rel="prefetch" href="/assets/js/13.026b2d2d.js"><link rel="prefetch" href="/assets/js/14.234e0442.js"><link rel="prefetch" href="/assets/js/15.05982601.js"><link rel="prefetch" href="/assets/js/16.6ddb7b54.js"><link rel="prefetch" href="/assets/js/17.c8e27348.js"><link rel="prefetch" href="/assets/js/18.bea8b7b8.js"><link rel="prefetch" href="/assets/js/19.8032166c.js"><link rel="prefetch" href="/assets/js/20.e8575946.js"><link rel="prefetch" href="/assets/js/21.78fb8e90.js"><link rel="prefetch" href="/assets/js/22.1d33cf5f.js"><link rel="prefetch" href="/assets/js/23.7b04bc71.js"><link rel="prefetch" href="/assets/js/24.e2b60efb.js"><link rel="prefetch" href="/assets/js/25.5d5a4485.js"><link rel="prefetch" href="/assets/js/26.8173389b.js"><link rel="prefetch" href="/assets/js/27.b71f4454.js"><link rel="prefetch" href="/assets/js/28.e1ca4b97.js"><link rel="prefetch" href="/assets/js/29.929be50a.js"><link rel="prefetch" href="/assets/js/3.df829fda.js"><link rel="prefetch" href="/assets/js/30.7e96e268.js"><link rel="prefetch" href="/assets/js/31.c0e69237.js"><link rel="prefetch" href="/assets/js/32.7a31538c.js"><link rel="prefetch" href="/assets/js/33.9f9fcbee.js"><link rel="prefetch" href="/assets/js/34.1a23bcc8.js"><link rel="prefetch" href="/assets/js/35.d646c169.js"><link rel="prefetch" href="/assets/js/36.23fde348.js"><link rel="prefetch" href="/assets/js/38.c16df410.js"><link rel="prefetch" href="/assets/js/39.beaf8a5b.js"><link rel="prefetch" href="/assets/js/4.af196e2c.js"><link rel="prefetch" href="/assets/js/40.a6c3be0f.js"><link rel="prefetch" href="/assets/js/41.55dcf4c0.js"><link rel="prefetch" href="/assets/js/42.194c1906.js"><link rel="prefetch" href="/assets/js/43.23218e8b.js"><link rel="prefetch" href="/assets/js/44.d7674f0c.js"><link rel="prefetch" href="/assets/js/45.98b149c7.js"><link rel="prefetch" href="/assets/js/46.b5d5ec9d.js"><link rel="prefetch" href="/assets/js/47.b3a38716.js"><link rel="prefetch" href="/assets/js/48.ea0a7e3f.js"><link rel="prefetch" href="/assets/js/5.18feaa6c.js"><link rel="prefetch" href="/assets/js/6.7e6925c7.js"><link rel="prefetch" href="/assets/js/7.1b7a5d04.js"><link rel="prefetch" href="/assets/js/8.f363ac78.js"><link rel="prefetch" href="/assets/js/9.61f6ba62.js">
    <link rel="stylesheet" href="/assets/css/0.styles.84203ac8.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">潇淼文档</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  主页
</a></div><div class="nav-item"><a href="/Hcat.html" class="nav-link">
  联系我们
</a></div><div class="nav-item"><a href="/about.html" class="nav-link">
  关于
</a></div><div class="nav-item"><a href="http://xor.hcat.work/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  XOR加密
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  主页
</a></div><div class="nav-item"><a href="/Hcat.html" class="nav-link">
  联系我们
</a></div><div class="nav-item"><a href="/about.html" class="nav-link">
  关于
</a></div><div class="nav-item"><a href="http://xor.hcat.work/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  XOR加密
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/" aria-current="page" class="sidebar-link">首页</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>基本要素</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Lua脚本</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Lua/2048.html" class="sidebar-link">Game 2048</a></li><li><a href="/Lua/void.html" class="sidebar-link">不那么仁慈的虚空</a></li><li><a href="/Lua/zfdm.html" class="sidebar-link">争分夺秒</a></li><li><a href="/Lua/tankx.html" class="sidebar-link">坦克对战</a></li><li><a href="/Lua/Stone_code.html" class="sidebar-link">Stone Code</a></li><li><a href="/Lua/Gomoku.html" aria-current="page" class="active sidebar-link">五子棋（Gomoku）</a></li><li><a href="/Lua/fight_for_gold_bricks.html" class="sidebar-link">夺金之战（Fight for Gold Bricks）</a></li><li><a href="/Lua/example.html" class="sidebar-link">示例整合Examples collection</a></li><li><a href="/Lua/Mini_Fast_Food_Restaurant.html" class="sidebar-link">迷你快餐店（Mini Fast Food Restaurant）</a></li><li><a href="/Lua/color_fight.html" class="sidebar-link">好色之途（Color Fight）</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>拓展元素</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>商业化[圈钱]</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>游戏全局数据表</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="五子棋-gomoku"><a href="#五子棋-gomoku" class="header-anchor">#</a> 五子棋（Gomoku）</h1> <div class="language-lua extra-class"><pre class="language-lua"><code><span class="token keyword">local</span> Api           <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">local</span> AIGame        <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">local</span> BattleGame    <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">local</span> Config        <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">local</span> GobangEvent   <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">local</span> GobangMgr     <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">local</span> GobangData    <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">local</span> LogicEvent    <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">local</span> SwitchCtrl    <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">local</span> SettingRule   <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">local</span> TimerManager  <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">listenevents_gobang</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    ScriptSupportEvent<span class="token punctuation">:</span><span class="token function">registerEvent</span><span class="token punctuation">(</span><span class="token string">[=[Block.PlaceBy]=]</span><span class="token punctuation">,</span>GobangEvent<span class="token punctuation">.</span>block_placedby<span class="token punctuation">)</span>
    ScriptSupportEvent<span class="token punctuation">:</span><span class="token function">registerEvent</span><span class="token punctuation">(</span><span class="token string">[=[Block.Trigger]=]</span><span class="token punctuation">,</span>GobangEvent<span class="token punctuation">.</span>block_trigger<span class="token punctuation">)</span>
    ScriptSupportEvent<span class="token punctuation">:</span><span class="token function">registerEvent</span><span class="token punctuation">(</span><span class="token string">[=[Game.AnyPlayer.LeaveGame]=]</span><span class="token punctuation">,</span>GobangEvent<span class="token punctuation">.</span>playerLeaveGame<span class="token punctuation">)</span>
    ScriptSupportEvent<span class="token punctuation">:</span><span class="token function">registerEvent</span><span class="token punctuation">(</span><span class="token string">[=[Game.Start]=]</span><span class="token punctuation">,</span>GobangEvent<span class="token punctuation">.</span>gamestart<span class="token punctuation">)</span>
    ScriptSupportEvent<span class="token punctuation">:</span><span class="token function">registerEvent</span><span class="token punctuation">(</span><span class="token string">[=[Game.Run]=]</span><span class="token punctuation">,</span>GobangEvent<span class="token punctuation">.</span>gamerun<span class="token punctuation">)</span>
    ScriptSupportEvent<span class="token punctuation">:</span><span class="token function">registerEvent</span><span class="token punctuation">(</span><span class="token string">[=[Player.AreaIn]=]</span><span class="token punctuation">,</span>GobangEvent<span class="token punctuation">.</span>playerAreaIn<span class="token punctuation">)</span>
    ScriptSupportEvent<span class="token punctuation">:</span><span class="token function">registerEvent</span><span class="token punctuation">(</span><span class="token string">[=[Player.AreaOut]=]</span><span class="token punctuation">,</span>GobangEvent<span class="token punctuation">.</span>playerAreaOut<span class="token punctuation">)</span>

<span class="token keyword">end</span>


Api <span class="token operator">=</span> <span class="token punctuation">{</span>
    Chat        <span class="token operator">=</span> class<span class="token punctuation">.</span>Chat<span class="token punctuation">.</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    Block       <span class="token operator">=</span> class<span class="token punctuation">.</span>Block<span class="token punctuation">.</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    Player      <span class="token operator">=</span> class<span class="token punctuation">.</span>Player<span class="token punctuation">.</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    Actor       <span class="token operator">=</span> class<span class="token punctuation">.</span>Actor<span class="token punctuation">.</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    Backpack    <span class="token operator">=</span> class<span class="token punctuation">.</span>Backpack<span class="token punctuation">.</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    Team        <span class="token operator">=</span> class<span class="token punctuation">.</span>Team<span class="token punctuation">.</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    MiniTimer   <span class="token operator">=</span> class<span class="token punctuation">.</span>MiniTimer<span class="token punctuation">.</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    Area        <span class="token operator">=</span> class<span class="token punctuation">.</span>Area<span class="token punctuation">.</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>


LogicEvent <span class="token operator">=</span> <span class="token punctuation">{</span>
    SwitchTriggerEvent <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>
    ChangeThreeModeEvent <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span>
    ChangeCampEvent <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span>
    SelectedStartThreeModeEvent<span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">,</span>
    AIStartThreeModeEvent <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">,</span>
    StartRoundEvent <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">,</span>
    StartBeginGameEvent <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">,</span>

    PlaceChessBlockEvent <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">,</span>
    ChangeCurPlaceChessTypeEvent <span class="token operator">=</span> <span class="token number">9</span><span class="token punctuation">,</span>
    AIModeWinEvent <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">,</span>
    AbstainEvent <span class="token operator">=</span> <span class="token number">11</span><span class="token punctuation">,</span>
    BattleModeWinEvent <span class="token operator">=</span> <span class="token number">12</span><span class="token punctuation">,</span>
    PlayerLeaveGame <span class="token operator">=</span> <span class="token number">13</span><span class="token punctuation">,</span>
    GameStartEvent <span class="token operator">=</span> <span class="token number">14</span><span class="token punctuation">,</span>
    PlayerAreaInEvent <span class="token operator">=</span> <span class="token number">15</span><span class="token punctuation">,</span>
    PlayerAreaOutEvent <span class="token operator">=</span> <span class="token number">16</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>


GobangMgr <span class="token operator">=</span> <span class="token punctuation">{</span>


    HandleEvent <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>event<span class="token punctuation">,</span>param<span class="token punctuation">)</span>
        <span class="token keyword">if</span> event <span class="token operator">==</span> LogicEvent<span class="token punctuation">.</span>SwitchTriggerEvent <span class="token keyword">then</span>
            <span class="token keyword">if</span> param<span class="token punctuation">.</span>blockid <span class="token operator">~=</span> <span class="token number">724</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>

            SwitchCtrl<span class="token punctuation">.</span><span class="token function">SwitchTrigger</span><span class="token punctuation">(</span>param<span class="token punctuation">.</span>x<span class="token punctuation">,</span>param<span class="token punctuation">.</span>y<span class="token punctuation">,</span>param<span class="token punctuation">.</span>z<span class="token punctuation">,</span>param<span class="token punctuation">.</span>eventobjid<span class="token punctuation">,</span>param<span class="token punctuation">.</span>blockid<span class="token punctuation">)</span>

        <span class="token keyword">elseif</span> event <span class="token operator">==</span> LogicEvent<span class="token punctuation">.</span>ChangeThreeModeEvent <span class="token keyword">then</span>
            SettingRule<span class="token punctuation">.</span><span class="token function">ChangeStartThreeChessPos</span><span class="token punctuation">(</span>param<span class="token punctuation">.</span>roomId<span class="token punctuation">)</span>

        <span class="token keyword">elseif</span> event <span class="token operator">==</span> LogicEvent<span class="token punctuation">.</span>ChangeCampEvent <span class="token keyword">then</span>
            SettingRule<span class="token punctuation">.</span><span class="token function">ChangePlayerPos</span><span class="token punctuation">(</span>param<span class="token punctuation">.</span>roomId<span class="token punctuation">)</span>

        <span class="token keyword">elseif</span> event <span class="token operator">==</span> LogicEvent<span class="token punctuation">.</span>AIStartThreeModeEvent <span class="token keyword">then</span>
            AIGame<span class="token punctuation">.</span><span class="token function">SetAIRoundBeforeData</span><span class="token punctuation">(</span>param<span class="token punctuation">.</span>roomId<span class="token punctuation">)</span>

        <span class="token keyword">elseif</span> event <span class="token operator">==</span> LogicEvent<span class="token punctuation">.</span>StartBeginGameEvent <span class="token keyword">then</span>
            AIGame<span class="token punctuation">.</span><span class="token function">ResetData</span><span class="token punctuation">(</span>param<span class="token punctuation">.</span>roomId<span class="token punctuation">)</span>
            BattleGame<span class="token punctuation">.</span><span class="token function">ResetData</span><span class="token punctuation">(</span>param<span class="token punctuation">.</span>roomId<span class="token punctuation">)</span>
            SettingRule<span class="token punctuation">.</span><span class="token function">SetDefaultThreeChess</span><span class="token punctuation">(</span>param<span class="token punctuation">.</span>roomId<span class="token punctuation">)</span>
            AIGame<span class="token punctuation">.</span><span class="token function">InitWinsList</span><span class="token punctuation">(</span>param<span class="token punctuation">.</span>roomId<span class="token punctuation">)</span>
            SettingRule<span class="token punctuation">.</span><span class="token function">SetPlayerPos</span><span class="token punctuation">(</span>param<span class="token punctuation">.</span>roomId<span class="token punctuation">)</span>
            BattleGame<span class="token punctuation">.</span><span class="token function">SetStartGameData</span><span class="token punctuation">(</span>param<span class="token punctuation">.</span>roomId<span class="token punctuation">)</span>

        <span class="token keyword">elseif</span> event <span class="token operator">==</span> LogicEvent<span class="token punctuation">.</span>StartRoundEvent <span class="token keyword">then</span>
            SettingRule<span class="token punctuation">.</span><span class="token function">GainItemChessToPlayer</span><span class="token punctuation">(</span>param<span class="token punctuation">.</span>roomId<span class="token punctuation">)</span>
            AIGame<span class="token punctuation">.</span><span class="token function">SetPlaceThreeChess</span><span class="token punctuation">(</span>param<span class="token punctuation">.</span>roomId<span class="token punctuation">)</span>
            AIGame<span class="token punctuation">.</span><span class="token function">StartRound</span><span class="token punctuation">(</span>param<span class="token punctuation">.</span>roomId<span class="token punctuation">)</span>
            BattleGame<span class="token punctuation">.</span><span class="token function">SetPlaceThreeChess</span><span class="token punctuation">(</span>param<span class="token punctuation">.</span>roomId<span class="token punctuation">)</span>
            BattleGame<span class="token punctuation">.</span><span class="token function">StartRound</span><span class="token punctuation">(</span>param<span class="token punctuation">.</span>roomId<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">elseif</span> event <span class="token operator">==</span> LogicEvent<span class="token punctuation">.</span>PlaceChessBlockEvent <span class="token keyword">then</span>
            GobangMgr<span class="token punctuation">.</span><span class="token function">PlaceChessBlock</span><span class="token punctuation">(</span>param<span class="token punctuation">)</span>

        <span class="token keyword">elseif</span> event <span class="token operator">==</span> LogicEvent<span class="token punctuation">.</span>ChangeCurPlaceChessTypeEvent <span class="token keyword">then</span>
            GobangMgr<span class="token punctuation">.</span><span class="token function">ChangeCurPlaceChessType</span><span class="token punctuation">(</span>param<span class="token punctuation">)</span>

        <span class="token keyword">elseif</span> event <span class="token operator">==</span> LogicEvent<span class="token punctuation">.</span>AIModeWinEvent <span class="token keyword">then</span>
            GobangMgr<span class="token punctuation">.</span><span class="token function">AIModeWin</span><span class="token punctuation">(</span>param<span class="token punctuation">)</span>

        <span class="token keyword">elseif</span>  event <span class="token operator">==</span> LogicEvent<span class="token punctuation">.</span>BattleModeWinEvent <span class="token keyword">then</span>
            GobangMgr<span class="token punctuation">.</span><span class="token function">BattleModeWin</span><span class="token punctuation">(</span>param<span class="token punctuation">)</span>

        <span class="token keyword">elseif</span> event <span class="token operator">==</span> LogicEvent<span class="token punctuation">.</span>PlayerLeaveGame <span class="token keyword">then</span>
            GobangMgr<span class="token punctuation">.</span><span class="token function">PlayerLeaveGame</span><span class="token punctuation">(</span>param<span class="token punctuation">.</span>eventobjid<span class="token punctuation">)</span>
        <span class="token keyword">elseif</span> event <span class="token operator">==</span> LogicEvent<span class="token punctuation">.</span>GameStartEvent <span class="token keyword">then</span>
            GobangMgr<span class="token punctuation">.</span><span class="token function">InitRoomArea</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

        <span class="token keyword">elseif</span> event <span class="token operator">==</span> LogicEvent<span class="token punctuation">.</span>PlayerAreaInEvent <span class="token keyword">then</span>
            SettingRule<span class="token punctuation">.</span><span class="token function">PlayerAreaIn</span><span class="token punctuation">(</span>param<span class="token punctuation">.</span>areaid<span class="token punctuation">,</span>param<span class="token punctuation">.</span>eventobjid<span class="token punctuation">)</span>
        <span class="token keyword">elseif</span> event <span class="token operator">==</span> LogicEvent<span class="token punctuation">.</span>PlayerAreaOutEvent <span class="token keyword">then</span>
            SettingRule<span class="token punctuation">.</span><span class="token function">PlayerAreaOut</span><span class="token punctuation">(</span>param<span class="token punctuation">.</span>areaid<span class="token punctuation">,</span>param<span class="token punctuation">.</span>eventobjid<span class="token punctuation">)</span>
        <span class="token keyword">end</span>

    <span class="token keyword">end</span><span class="token punctuation">,</span>


    JudgeChessInChessboard <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>roomId<span class="token punctuation">,</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>z<span class="token punctuation">)</span>
        <span class="token keyword">if</span> x <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">and</span> y <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">and</span> z <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">false</span> <span class="token keyword">end</span>


        <span class="token keyword">local</span> CheckerboardPos <span class="token operator">=</span> Config<span class="token punctuation">.</span>Checkerboard<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span>
        <span class="token keyword">if</span> CheckerboardPos <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">false</span> <span class="token keyword">end</span>
        <span class="token function">print</span><span class="token punctuation">(</span>CheckerboardPos<span class="token punctuation">)</span>
        <span class="token keyword">local</span> rangeBeginPos <span class="token operator">=</span> CheckerboardPos<span class="token punctuation">.</span>beginPos<span class="token punctuation">;</span>
        <span class="token keyword">local</span> rangeEndPos <span class="token operator">=</span> CheckerboardPos<span class="token punctuation">.</span>endPos<span class="token punctuation">;</span>

        <span class="token keyword">if</span> rangeBeginPos<span class="token punctuation">.</span>y <span class="token operator">~=</span> y <span class="token keyword">or</span> rangeEndPos<span class="token punctuation">.</span>y <span class="token operator">~=</span> y <span class="token keyword">then</span>
            <span class="token keyword">return</span> <span class="token keyword">false</span><span class="token punctuation">;</span>
        <span class="token keyword">end</span>

        <span class="token keyword">local</span> maxCoord <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">local</span> minCoord <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>


        maxCoord <span class="token operator">=</span> math<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>rangeEndPos<span class="token punctuation">.</span>x<span class="token punctuation">,</span> rangeBeginPos<span class="token punctuation">.</span>x<span class="token punctuation">)</span>
        minCoord <span class="token operator">=</span> math<span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>rangeEndPos<span class="token punctuation">.</span>x<span class="token punctuation">,</span> rangeBeginPos<span class="token punctuation">.</span>x<span class="token punctuation">)</span>
        <span class="token keyword">if</span> x <span class="token operator">&gt;</span> maxCoord <span class="token keyword">or</span> x <span class="token operator">&lt;</span>minCoord <span class="token keyword">then</span>
            <span class="token keyword">return</span> <span class="token keyword">false</span><span class="token punctuation">;</span>
        <span class="token keyword">end</span>

        maxCoord <span class="token operator">=</span> math<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>rangeEndPos<span class="token punctuation">.</span>z<span class="token punctuation">,</span> rangeBeginPos<span class="token punctuation">.</span>z<span class="token punctuation">)</span>
        minCoord <span class="token operator">=</span> math<span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>rangeEndPos<span class="token punctuation">.</span>z<span class="token punctuation">,</span> rangeBeginPos<span class="token punctuation">.</span>z<span class="token punctuation">)</span>
        <span class="token keyword">if</span> z <span class="token operator">&gt;</span> maxCoord <span class="token keyword">or</span> z <span class="token operator">&lt;</span>minCoord <span class="token keyword">then</span>
            <span class="token keyword">return</span> <span class="token keyword">false</span><span class="token punctuation">;</span>
        <span class="token keyword">end</span>

        <span class="token keyword">return</span> <span class="token keyword">true</span><span class="token punctuation">;</span>

    <span class="token keyword">end</span><span class="token punctuation">,</span>


    PlaceChessBlock <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>param<span class="token punctuation">)</span>
        <span class="token keyword">if</span> param <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>

        <span class="token keyword">local</span> curRoomId <span class="token operator">=</span> GobangMgr<span class="token punctuation">.</span><span class="token function">GetRoomidByPos</span><span class="token punctuation">(</span>param<span class="token punctuation">.</span>x<span class="token punctuation">,</span>param<span class="token punctuation">.</span>y<span class="token punctuation">,</span>param<span class="token punctuation">.</span>z<span class="token punctuation">)</span>
        <span class="token keyword">if</span> param<span class="token punctuation">.</span>eventobjid <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>


        <span class="token keyword">if</span> curRoomId <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;Fail to get the board ID&quot;</span><span class="token punctuation">)</span>
            Api<span class="token punctuation">.</span>Block<span class="token punctuation">:</span><span class="token function">destroyBlock</span><span class="token punctuation">(</span>param<span class="token punctuation">.</span>x<span class="token punctuation">,</span>param<span class="token punctuation">.</span>y<span class="token punctuation">,</span>param<span class="token punctuation">.</span>z<span class="token punctuation">,</span><span class="token keyword">false</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span>
        <span class="token keyword">end</span>


        <span class="token keyword">local</span> isRight <span class="token operator">=</span> SettingRule<span class="token punctuation">.</span><span class="token function">GetChessPlaceIsRight</span><span class="token punctuation">(</span>curRoomId<span class="token punctuation">,</span>param<span class="token punctuation">.</span>eventobjid<span class="token punctuation">,</span>param<span class="token punctuation">.</span>x<span class="token punctuation">,</span>param<span class="token punctuation">.</span>y<span class="token punctuation">,</span>param<span class="token punctuation">.</span>z<span class="token punctuation">,</span>param<span class="token punctuation">.</span>blockid<span class="token punctuation">)</span>
        <span class="token keyword">if</span> isRight <span class="token operator">==</span> <span class="token keyword">false</span> <span class="token keyword">then</span>
            <span class="token keyword">return</span>
        <span class="token keyword">end</span>


        <span class="token keyword">local</span> data <span class="token operator">=</span> GobangData<span class="token punctuation">[</span>curRoomId<span class="token punctuation">]</span>
        <span class="token keyword">if</span> data<span class="token punctuation">.</span>IsAI <span class="token keyword">and</span> data<span class="token punctuation">.</span>IsWin <span class="token operator">==</span><span class="token keyword">false</span> <span class="token keyword">then</span>

            AIGame<span class="token punctuation">.</span><span class="token function">ChessBlockPlaceTrigger</span><span class="token punctuation">(</span>param<span class="token punctuation">)</span>
        <span class="token keyword">else</span>

            <span class="token keyword">if</span> GobangData<span class="token punctuation">[</span>curRoomId<span class="token punctuation">]</span><span class="token punctuation">.</span>IsBeginRound <span class="token operator">==</span> <span class="token keyword">false</span> <span class="token keyword">or</span> data<span class="token punctuation">.</span>IsWin <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>
            BattleGame<span class="token punctuation">.</span><span class="token function">BlockPlacedBy</span><span class="token punctuation">(</span>param<span class="token punctuation">.</span>x<span class="token punctuation">,</span>param<span class="token punctuation">.</span>y<span class="token punctuation">,</span>param<span class="token punctuation">.</span>z<span class="token punctuation">,</span>param<span class="token punctuation">.</span>blockid<span class="token punctuation">,</span>param<span class="token punctuation">.</span>eventobjid<span class="token punctuation">)</span>
        <span class="token keyword">end</span>

    <span class="token keyword">end</span><span class="token punctuation">,</span>


    ChangeCurPlaceChessType <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>param<span class="token punctuation">)</span>
        <span class="token keyword">if</span> GobangData<span class="token punctuation">[</span>param<span class="token punctuation">.</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>IsAI <span class="token keyword">and</span> GobangData<span class="token punctuation">[</span>param<span class="token punctuation">.</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>CurChessType <span class="token operator">==</span> GobangData<span class="token punctuation">[</span>param<span class="token punctuation">.</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>AIChess <span class="token keyword">then</span>
            <span class="token keyword">if</span> GobangData<span class="token punctuation">[</span>param<span class="token punctuation">.</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>IsBeginRound <span class="token operator">==</span> <span class="token keyword">false</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>
            TimerManager<span class="token punctuation">.</span><span class="token function">CreateTimer</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                AIGame<span class="token punctuation">.</span><span class="token function">ComputerAI</span><span class="token punctuation">(</span>param<span class="token punctuation">.</span>roomId<span class="token punctuation">)</span>
            <span class="token keyword">end</span><span class="token punctuation">)</span>
        <span class="token keyword">end</span>
    <span class="token keyword">end</span><span class="token punctuation">,</span>


    AIModeWin <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>param<span class="token punctuation">)</span>
        <span class="token keyword">local</span> data <span class="token operator">=</span> GobangData<span class="token punctuation">[</span>param<span class="token punctuation">.</span>roomId<span class="token punctuation">]</span>


        <span class="token keyword">if</span> data<span class="token punctuation">.</span>BlackChess<span class="token punctuation">.</span>uin <span class="token operator">~=</span> <span class="token keyword">nil</span> <span class="token keyword">then</span>
            <span class="token comment">--Api.Player:teleportHome(data.BlackChess.uin)</span>
           <span class="token comment">--Api.Backpack:clearAllPack(data.BlackChess.uin)</span>
            Api<span class="token punctuation">.</span>Player<span class="token punctuation">:</span><span class="token function">notifyGameInfo2Self</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>BlackChess<span class="token punctuation">.</span>uin<span class="token punctuation">,</span><span class="token string">&quot;Winner has appeared.Game ends. &quot;</span><span class="token punctuation">)</span>
            SettingRule<span class="token punctuation">.</span><span class="token function">SetTipLightState</span><span class="token punctuation">(</span>param<span class="token punctuation">.</span>roomId<span class="token punctuation">,</span>Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>BlackChess<span class="token punctuation">,</span><span class="token keyword">false</span><span class="token punctuation">)</span>
            Api<span class="token punctuation">.</span>Backpack<span class="token punctuation">:</span><span class="token function">removeGridItemByItemID</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>BlackChess<span class="token punctuation">.</span>uin<span class="token punctuation">,</span> Config<span class="token punctuation">.</span>BlockIdEnum<span class="token punctuation">[</span>Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>BlackChess<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">end</span>

        <span class="token keyword">if</span> data<span class="token punctuation">.</span>WhiteChess<span class="token punctuation">.</span>uin <span class="token operator">~=</span> <span class="token keyword">nil</span> <span class="token keyword">then</span>
            <span class="token comment">--Api.Player:teleportHome(data.WhiteChess.uin)</span>
            <span class="token comment">--Api.Backpack:clearAllPack(data.WhiteChess.uin)</span>
            Api<span class="token punctuation">.</span>Player<span class="token punctuation">:</span><span class="token function">notifyGameInfo2Self</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>WhiteChess<span class="token punctuation">.</span>uin<span class="token punctuation">,</span><span class="token string">&quot;Winner has appeared.Game ends. &quot;</span><span class="token punctuation">)</span>
            SettingRule<span class="token punctuation">.</span><span class="token function">SetTipLightState</span><span class="token punctuation">(</span>param<span class="token punctuation">.</span>roomId<span class="token punctuation">,</span>Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>WhiteChess<span class="token punctuation">,</span><span class="token keyword">false</span><span class="token punctuation">)</span>
            Api<span class="token punctuation">.</span>Backpack<span class="token punctuation">:</span><span class="token function">removeGridItemByItemID</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>WhiteChess<span class="token punctuation">.</span>uin<span class="token punctuation">,</span> Config<span class="token punctuation">.</span>BlockIdEnum<span class="token punctuation">[</span>Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>WhiteChess<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">end</span>


        SettingRule<span class="token punctuation">.</span><span class="token function">ClearAreaPlayerBuff</span><span class="token punctuation">(</span>param<span class="token punctuation">.</span>roomId<span class="token punctuation">)</span>
        GobangData<span class="token punctuation">.</span><span class="token function">ResetRoomState</span><span class="token punctuation">(</span>param<span class="token punctuation">.</span>roomId<span class="token punctuation">)</span>
        TimerManager<span class="token punctuation">.</span><span class="token function">ClearRoundTimer</span><span class="token punctuation">(</span>param<span class="token punctuation">.</span>roomId<span class="token punctuation">)</span>
        
    <span class="token keyword">end</span><span class="token punctuation">,</span>


    BattleModeWin <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>param<span class="token punctuation">)</span>
        <span class="token keyword">local</span> data <span class="token operator">=</span> GobangData<span class="token punctuation">[</span>param<span class="token punctuation">.</span>roomId<span class="token punctuation">]</span>


        <span class="token keyword">if</span> data<span class="token punctuation">.</span>BlackChess<span class="token punctuation">.</span>uin <span class="token operator">~=</span> <span class="token keyword">nil</span> <span class="token keyword">then</span>
            <span class="token comment">--Api.Player:teleportHome(data.BlackChess.uin)</span>
            <span class="token comment">--Api.Backpack:clearAllPack(data.BlackChess.uin)</span>
            Api<span class="token punctuation">.</span>Player<span class="token punctuation">:</span><span class="token function">notifyGameInfo2Self</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>BlackChess<span class="token punctuation">.</span>uin<span class="token punctuation">,</span><span class="token string">&quot;Winner has appeared.Game ends. &quot;</span><span class="token punctuation">)</span>
            SettingRule<span class="token punctuation">.</span><span class="token function">SetTipLightState</span><span class="token punctuation">(</span>param<span class="token punctuation">.</span>roomId<span class="token punctuation">,</span>Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>BlackChess<span class="token punctuation">,</span><span class="token keyword">false</span><span class="token punctuation">)</span>
            Api<span class="token punctuation">.</span>Backpack<span class="token punctuation">:</span><span class="token function">removeGridItemByItemID</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>BlackChess<span class="token punctuation">.</span>uin<span class="token punctuation">,</span> Config<span class="token punctuation">.</span>BlockIdEnum<span class="token punctuation">[</span>Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>BlackChess<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">end</span>

        <span class="token keyword">if</span> data<span class="token punctuation">.</span>WhiteChess<span class="token punctuation">.</span>uin <span class="token operator">~=</span> <span class="token keyword">nil</span> <span class="token keyword">then</span>
            Api<span class="token punctuation">.</span>Player<span class="token punctuation">:</span><span class="token function">notifyGameInfo2Self</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>WhiteChess<span class="token punctuation">.</span>uin<span class="token punctuation">,</span><span class="token string">&quot;Winner has appeared.Game ends. &quot;</span><span class="token punctuation">)</span>
            SettingRule<span class="token punctuation">.</span><span class="token function">SetTipLightState</span><span class="token punctuation">(</span>param<span class="token punctuation">.</span>roomId<span class="token punctuation">,</span>Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>WhiteChess<span class="token punctuation">,</span><span class="token keyword">false</span><span class="token punctuation">)</span>
            Api<span class="token punctuation">.</span>Backpack<span class="token punctuation">:</span><span class="token function">removeGridItemByItemID</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>WhiteChess<span class="token punctuation">.</span>uin<span class="token punctuation">,</span> Config<span class="token punctuation">.</span>BlockIdEnum<span class="token punctuation">[</span>Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>WhiteChess<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">end</span>

        SettingRule<span class="token punctuation">.</span><span class="token function">ClearAreaPlayerBuff</span><span class="token punctuation">(</span>param<span class="token punctuation">.</span>roomId<span class="token punctuation">)</span>
        GobangData<span class="token punctuation">.</span><span class="token function">ResetRoomState</span><span class="token punctuation">(</span>param<span class="token punctuation">.</span>roomId<span class="token punctuation">)</span>
        TimerManager<span class="token punctuation">.</span><span class="token function">ClearRoundTimer</span><span class="token punctuation">(</span>param<span class="token punctuation">.</span>roomId<span class="token punctuation">)</span>
       

    <span class="token keyword">end</span><span class="token punctuation">,</span>


    AbstainCurRound <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>param<span class="token punctuation">)</span>
        <span class="token keyword">if</span> param <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>

    <span class="token keyword">end</span><span class="token punctuation">,</span>


    GetRoomidByPos <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>z<span class="token punctuation">)</span>
        <span class="token keyword">if</span> x <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">or</span> y <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">or</span> z <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>

        <span class="token keyword">local</span> data <span class="token operator">=</span> Config<span class="token punctuation">.</span>Checkerboard<span class="token punctuation">;</span>
        <span class="token keyword">if</span> data <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">nil</span> <span class="token keyword">end</span>

        <span class="token keyword">for</span> k<span class="token punctuation">,</span>v <span class="token keyword">in</span> <span class="token function">pairs</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token keyword">do</span>
            <span class="token keyword">local</span> maxX <span class="token operator">=</span> math<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span>beginPos<span class="token punctuation">.</span>x<span class="token punctuation">,</span>v<span class="token punctuation">.</span>endPos<span class="token punctuation">.</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">local</span> minX <span class="token operator">=</span> math<span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span>beginPos<span class="token punctuation">.</span>x<span class="token punctuation">,</span>v<span class="token punctuation">.</span>endPos<span class="token punctuation">.</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">local</span> maxZ <span class="token operator">=</span> math<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span>beginPos<span class="token punctuation">.</span>z<span class="token punctuation">,</span>v<span class="token punctuation">.</span>endPos<span class="token punctuation">.</span>z<span class="token punctuation">)</span>
            <span class="token keyword">local</span> minZ <span class="token operator">=</span> math<span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span>beginPos<span class="token punctuation">.</span>z<span class="token punctuation">,</span>v<span class="token punctuation">.</span>endPos<span class="token punctuation">.</span>z<span class="token punctuation">)</span>

            <span class="token keyword">if</span> x<span class="token operator">&lt;=</span>maxX <span class="token keyword">and</span> x <span class="token operator">&gt;=</span> minX <span class="token keyword">and</span> z <span class="token operator">&lt;=</span>maxZ <span class="token keyword">and</span> z <span class="token operator">&gt;=</span> minZ <span class="token keyword">then</span>

                <span class="token keyword">return</span> k
            <span class="token keyword">end</span>
        <span class="token keyword">end</span>

        <span class="token keyword">return</span> <span class="token keyword">nil</span>

    <span class="token keyword">end</span><span class="token punctuation">,</span>


    GetRoomIdByUin <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>uin<span class="token punctuation">)</span>
        <span class="token keyword">if</span> uin <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>

        <span class="token keyword">local</span> roomId <span class="token operator">=</span> <span class="token keyword">nil</span>

        <span class="token keyword">for</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">4</span> <span class="token keyword">do</span>
            <span class="token function">print</span><span class="token punctuation">(</span>GobangData<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
            <span class="token function">print</span><span class="token punctuation">(</span>uin<span class="token punctuation">)</span>
            <span class="token keyword">if</span> GobangData<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>IsBegin <span class="token keyword">then</span>
                <span class="token keyword">if</span> GobangData<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>BlackChess<span class="token punctuation">.</span>uin <span class="token operator">~=</span> <span class="token keyword">nil</span> <span class="token keyword">and</span> uin <span class="token operator">==</span> GobangData<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>BlackChess<span class="token punctuation">.</span>uin <span class="token keyword">then</span>
                    <span class="token keyword">return</span> i
                <span class="token keyword">end</span>

                <span class="token keyword">if</span> GobangData<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>WhiteChess<span class="token punctuation">.</span>uin <span class="token operator">~=</span> <span class="token keyword">nil</span> <span class="token keyword">and</span> uin <span class="token operator">==</span> GobangData<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>WhiteChess<span class="token punctuation">.</span>uin <span class="token keyword">then</span>
                    <span class="token keyword">return</span>  i
                <span class="token keyword">end</span>
            <span class="token keyword">end</span>
        <span class="token keyword">end</span>

        <span class="token keyword">return</span> roomId

    <span class="token keyword">end</span><span class="token punctuation">,</span>


    PlayerLeaveGame <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>eventobjid<span class="token punctuation">)</span>
        <span class="token keyword">if</span> eventobjid <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>


        <span class="token keyword">local</span> roomId <span class="token operator">=</span> SettingRule<span class="token punctuation">.</span><span class="token function">GetRoomIdByUin</span><span class="token punctuation">(</span>eventobjid<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> roomId <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>

        <span class="token keyword">local</span> data <span class="token operator">=</span> GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">local</span> winChessType<span class="token punctuation">;</span>
        <span class="token keyword">if</span> data<span class="token punctuation">.</span>BlackChess<span class="token punctuation">.</span>uin <span class="token operator">==</span> eventobjid <span class="token keyword">then</span>
            winChessType <span class="token operator">=</span> Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>WhiteChess
        <span class="token keyword">elseif</span> data<span class="token punctuation">.</span>WhiteChess<span class="token punctuation">.</span>uin <span class="token operator">==</span> eventobjid <span class="token keyword">then</span>
            winChessType <span class="token operator">=</span> Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>BlackChess
        <span class="token keyword">end</span>

        Api<span class="token punctuation">.</span>Chat<span class="token punctuation">:</span><span class="token function">sendSystemMsg</span><span class="token punctuation">(</span><span class="token string">&quot;Room &quot;</span><span class="token operator">..</span>roomId<span class="token operator">..</span><span class="token string">&quot;:Player leaves the room and give up the game. &quot;</span><span class="token punctuation">)</span>
        GobangData<span class="token punctuation">.</span><span class="token function">SetWin</span><span class="token punctuation">(</span>roomId<span class="token punctuation">,</span><span class="token keyword">true</span><span class="token punctuation">,</span>winChessType<span class="token punctuation">)</span>

    <span class="token keyword">end</span><span class="token punctuation">,</span>


    InitRoomArea <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span>


        <span class="token keyword">for</span> k<span class="token punctuation">,</span>v <span class="token keyword">in</span> <span class="token function">pairs</span><span class="token punctuation">(</span>Config<span class="token punctuation">.</span>CheckerboardCenterPos<span class="token punctuation">)</span> <span class="token keyword">do</span>
            <span class="token keyword">local</span> ret<span class="token punctuation">,</span>areaid <span class="token operator">=</span> Api<span class="token punctuation">.</span>Area<span class="token punctuation">:</span><span class="token function">createAreaRect</span><span class="token punctuation">(</span>v<span class="token punctuation">,</span> <span class="token punctuation">{</span>x<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span>y<span class="token operator">=</span><span class="token number">6</span><span class="token punctuation">,</span>z<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span> ret <span class="token operator">==</span> ErrorCode<span class="token punctuation">.</span>OK <span class="token keyword">then</span>
                GobangData<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">.</span>AreaId <span class="token operator">=</span> areaid
            <span class="token keyword">end</span>

        <span class="token keyword">end</span>
    <span class="token keyword">end</span><span class="token punctuation">,</span>

<span class="token punctuation">}</span>


GobangEvent <span class="token operator">=</span> <span class="token punctuation">{</span>


    playerAreaIn <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>param<span class="token punctuation">)</span>

        GobangMgr<span class="token punctuation">.</span><span class="token function">HandleEvent</span><span class="token punctuation">(</span>LogicEvent<span class="token punctuation">.</span>PlayerAreaInEvent<span class="token punctuation">,</span>param<span class="token punctuation">)</span>
    <span class="token keyword">end</span><span class="token punctuation">,</span>


    playerAreaOut <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>param<span class="token punctuation">)</span>

        GobangMgr<span class="token punctuation">.</span><span class="token function">HandleEvent</span><span class="token punctuation">(</span>LogicEvent<span class="token punctuation">.</span>PlayerAreaOutEvent<span class="token punctuation">,</span>param<span class="token punctuation">)</span>
    <span class="token keyword">end</span><span class="token punctuation">,</span>


    block_placedby <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>param<span class="token punctuation">)</span>

        GobangMgr<span class="token punctuation">.</span><span class="token function">HandleEvent</span><span class="token punctuation">(</span>LogicEvent<span class="token punctuation">.</span>PlaceChessBlockEvent<span class="token punctuation">,</span>param<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">end</span><span class="token punctuation">,</span>


    block_trigger <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>param<span class="token punctuation">)</span>

        GobangMgr<span class="token punctuation">.</span><span class="token function">HandleEvent</span><span class="token punctuation">(</span>LogicEvent<span class="token punctuation">.</span>SwitchTriggerEvent<span class="token punctuation">,</span>param<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">end</span><span class="token punctuation">,</span>


    gamestart <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

        Api<span class="token punctuation">.</span>Chat<span class="token punctuation">:</span><span class="token function">sendSystemMsg</span><span class="token punctuation">(</span><span class="token string">&quot;Game starts. &quot;</span><span class="token punctuation">)</span>
        GobangMgr<span class="token punctuation">.</span><span class="token function">HandleEvent</span><span class="token punctuation">(</span>LogicEvent<span class="token punctuation">.</span>GameStartEvent<span class="token punctuation">)</span>
    <span class="token keyword">end</span><span class="token punctuation">,</span>

    gamerun <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        TimerManager<span class="token punctuation">.</span><span class="token function">Update</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">end</span><span class="token punctuation">,</span>


    playerLeaveGame <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>param<span class="token punctuation">)</span>

        GobangMgr<span class="token punctuation">.</span><span class="token function">HandleEvent</span><span class="token punctuation">(</span>LogicEvent<span class="token punctuation">.</span>PlayerLeaveGame<span class="token punctuation">,</span>param<span class="token punctuation">)</span>
    <span class="token keyword">end</span><span class="token punctuation">,</span>



<span class="token punctuation">}</span>


Config <span class="token operator">=</span> <span class="token punctuation">{</span>

    SwitchType <span class="token operator">=</span> <span class="token punctuation">{</span>
        RandomSelect    <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>
        StartGame       <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span>
        BlackChess      <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span>
        WhiteChess      <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">,</span>

        ChangeThreeMode <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">,</span>
        BlackStartRound <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">,</span>
        WhiteStartRound <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">,</span>
        Abstain         <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">,</span>
        ChangeChessType <span class="token operator">=</span> <span class="token number">9</span><span class="token punctuation">,</span>
        DesignatedStartType <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">,</span>
        AdmitDefeatType <span class="token operator">=</span> <span class="token number">11</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>


    SwitchMapping <span class="token operator">=</span> <span class="token punctuation">{</span>

        <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">275</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">97</span><span class="token punctuation">,</span> roomId<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">271</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">97</span><span class="token punctuation">,</span> roomId<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">273</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">99</span><span class="token punctuation">,</span> roomId<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">269</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">97</span><span class="token punctuation">,</span> roomId<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">3</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">277</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">97</span><span class="token punctuation">,</span> roomId<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">4</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>

        <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">271</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">75</span><span class="token punctuation">,</span> roomId<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">275</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">75</span><span class="token punctuation">,</span> roomId<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">273</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">73</span><span class="token punctuation">,</span> roomId<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">277</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">75</span><span class="token punctuation">,</span> roomId<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">3</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">269</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">75</span><span class="token punctuation">,</span> roomId<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">4</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>

        <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">314</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">75</span><span class="token punctuation">,</span> roomId<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">318</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">75</span><span class="token punctuation">,</span> roomId<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">316</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">73</span><span class="token punctuation">,</span> roomId<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">320</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">75</span><span class="token punctuation">,</span> roomId<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">3</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">312</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">75</span><span class="token punctuation">,</span> roomId<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">4</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>

        <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">318</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">97</span><span class="token punctuation">,</span> roomId<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">314</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">97</span><span class="token punctuation">,</span> roomId<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">316</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">99</span><span class="token punctuation">,</span> roomId<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">312</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">97</span><span class="token punctuation">,</span> roomId<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">3</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">320</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">97</span><span class="token punctuation">,</span> roomId<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">4</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>


        <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">325</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">9</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">67</span><span class="token punctuation">,</span> roomId<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">5</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">327</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">9</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">67</span><span class="token punctuation">,</span> roomId<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">6</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">326</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">9</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">63</span><span class="token punctuation">,</span> roomId<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">8</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">307</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">9</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">63</span><span class="token punctuation">,</span> roomId<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">9</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">305</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">9</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">63</span><span class="token punctuation">,</span> roomId<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">7</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">306</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">9</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">67</span><span class="token punctuation">,</span> roomId<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">8</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>

        <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">306</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">9</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">109</span><span class="token punctuation">,</span> roomId<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">8</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">307</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">9</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">105</span><span class="token punctuation">,</span> roomId<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">5</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">305</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">9</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">105</span><span class="token punctuation">,</span> roomId<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">6</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">325</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">9</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">109</span><span class="token punctuation">,</span> roomId<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">9</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">327</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">9</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">109</span><span class="token punctuation">,</span> roomId<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">7</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">326</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">9</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">105</span><span class="token punctuation">,</span> roomId<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">8</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>

        <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">283</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">9</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">63</span><span class="token punctuation">,</span> roomId<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">8</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">282</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">9</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">67</span><span class="token punctuation">,</span> roomId<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">5</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">284</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">9</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">67</span><span class="token punctuation">,</span> roomId<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">6</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">264</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">9</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">63</span><span class="token punctuation">,</span> roomId<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">9</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">262</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">9</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">63</span><span class="token punctuation">,</span> roomId<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">7</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">263</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">9</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">67</span><span class="token punctuation">,</span> roomId<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">8</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>

        <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">263</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">9</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">109</span><span class="token punctuation">,</span> roomId<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">8</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">264</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">9</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">105</span><span class="token punctuation">,</span> roomId<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">5</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">262</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">9</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">105</span><span class="token punctuation">,</span> roomId<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">6</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">282</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">9</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">109</span><span class="token punctuation">,</span> roomId<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">9</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">284</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">9</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">109</span><span class="token punctuation">,</span> roomId<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">7</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">283</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">9</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">105</span><span class="token punctuation">,</span> roomId<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">8</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>


        <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">294</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">9</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">84</span><span class="token punctuation">,</span> roomId<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">10</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>

        <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">326</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">7</span> <span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">60</span> <span class="token punctuation">,</span> roomId<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">11</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">306</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">7</span> <span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">60</span> <span class="token punctuation">,</span> roomId<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">11</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">306</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">7</span> <span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">112</span><span class="token punctuation">,</span> roomId<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">11</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">326</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">7</span> <span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">112</span><span class="token punctuation">,</span> roomId<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">11</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">283</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">7</span> <span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">60</span> <span class="token punctuation">,</span> roomId<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">11</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">263</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">7</span> <span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">60</span> <span class="token punctuation">,</span> roomId<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">11</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">263</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">7</span> <span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">112</span><span class="token punctuation">,</span> roomId<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">11</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">283</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">7</span> <span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">112</span><span class="token punctuation">,</span> roomId<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">11</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token punctuation">}</span><span class="token punctuation">,</span>


    ChessType <span class="token operator">=</span> <span class="token punctuation">{</span>
        None        <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>
        BlackChess  <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>
        WhiteChess  <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>


    RoomType <span class="token operator">=</span> <span class="token punctuation">{</span>
        None        <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>
        RoomOne     <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>
        RoomTwo     <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span>
        RoomThree   <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span>
        RoomFour    <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>


    ChoseMode <span class="token operator">=</span> <span class="token punctuation">{</span>
        None <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>
        Random <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>
        Default <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>


    ThreeChessRelativePos <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token punctuation">{</span>   <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>   y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>   z <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span>  type <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>   <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>   y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>   z <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span>  type <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>   <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span>   y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>   z <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span>  type <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>   <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>   y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>   z <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>  type <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>   <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span>   y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>   z <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>  type <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>   <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>   y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>   z <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>  type <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>   <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span>   y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>   z <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>  type <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>   <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>   y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>   z <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>   <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>   y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>   z <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>   <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span>   y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>   z <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>   <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>   y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>   z <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>   <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>   y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>   z <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>   <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span>   y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>   z <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>   <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span>   y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>   z <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span>  type <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>   <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span>   y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>   z <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>  type <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>   <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span>   y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>   z <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>  type <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>   <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span>   y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>   z <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>   <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span>   y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>   z <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>   <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>   y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>   z <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>  type <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>   <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>  y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>   z <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>   <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>  y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>   z <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>   <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>   y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>   z <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>   <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>   y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>   z <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>   <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>  y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>   z <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>   <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>  y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>   z <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>   <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span>  y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>   z <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>


    CheckerboardCenterPos <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">316</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">65</span><span class="token punctuation">,</span>   roomId<span class="token operator">=</span><span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">316</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">107</span><span class="token punctuation">,</span>  roomId<span class="token operator">=</span><span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">273</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">65</span><span class="token punctuation">,</span>   roomId<span class="token operator">=</span><span class="token number">3</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">273</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">107</span><span class="token punctuation">,</span>  roomId<span class="token operator">=</span><span class="token number">4</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>


    BlockIdEnum <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">3994</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">3997</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>


    InitPlayerPos <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> x<span class="token operator">=</span><span class="token number">326</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">9</span> <span class="token punctuation">,</span> z<span class="token operator">=</span><span class="token number">65</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> x<span class="token operator">=</span><span class="token number">306</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">9</span><span class="token punctuation">,</span> z<span class="token operator">=</span><span class="token number">65</span> <span class="token punctuation">}</span>   <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> x<span class="token operator">=</span><span class="token number">306</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">9</span> <span class="token punctuation">,</span> z<span class="token operator">=</span><span class="token number">107</span>   <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> x<span class="token operator">=</span><span class="token number">326</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">9</span><span class="token punctuation">,</span> z<span class="token operator">=</span><span class="token number">107</span> <span class="token punctuation">}</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> x<span class="token operator">=</span><span class="token number">283</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">9</span> <span class="token punctuation">,</span> z<span class="token operator">=</span><span class="token number">65</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> x<span class="token operator">=</span><span class="token number">263</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">9</span><span class="token punctuation">,</span> z<span class="token operator">=</span><span class="token number">65</span> <span class="token punctuation">}</span>   <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> x<span class="token operator">=</span><span class="token number">263</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">9</span> <span class="token punctuation">,</span> z<span class="token operator">=</span><span class="token number">107</span>   <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> x<span class="token operator">=</span><span class="token number">283</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">9</span><span class="token punctuation">,</span> z<span class="token operator">=</span><span class="token number">107</span> <span class="token punctuation">}</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>


    Checkerboard <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token punctuation">{</span> beginPos <span class="token operator">=</span> <span class="token punctuation">{</span>x <span class="token operator">=</span> <span class="token number">309</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">72</span><span class="token punctuation">}</span> <span class="token punctuation">,</span> endPos <span class="token operator">=</span> <span class="token punctuation">{</span>x <span class="token operator">=</span> <span class="token number">323</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">58</span><span class="token punctuation">}</span>   <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span> beginPos <span class="token operator">=</span> <span class="token punctuation">{</span>x <span class="token operator">=</span> <span class="token number">323</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">}</span> <span class="token punctuation">,</span> endPos <span class="token operator">=</span> <span class="token punctuation">{</span>x <span class="token operator">=</span> <span class="token number">309</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">114</span><span class="token punctuation">}</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span> beginPos <span class="token operator">=</span> <span class="token punctuation">{</span>x <span class="token operator">=</span> <span class="token number">280</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">72</span><span class="token punctuation">}</span> <span class="token punctuation">,</span> endPos <span class="token operator">=</span> <span class="token punctuation">{</span>x <span class="token operator">=</span> <span class="token number">266</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">58</span><span class="token punctuation">}</span>   <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span> beginPos <span class="token operator">=</span> <span class="token punctuation">{</span>x <span class="token operator">=</span> <span class="token number">266</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">}</span><span class="token punctuation">,</span> endPos <span class="token operator">=</span> <span class="token punctuation">{</span>x <span class="token operator">=</span> <span class="token number">280</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">,</span> z <span class="token operator">=</span> <span class="token number">114</span><span class="token punctuation">}</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>



    TipLightPos <span class="token operator">=</span> <span class="token punctuation">{</span>

        <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> x<span class="token operator">=</span><span class="token number">323</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">9</span> <span class="token punctuation">,</span> z<span class="token operator">=</span><span class="token number">76</span>   <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> x<span class="token operator">=</span><span class="token number">309</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">9</span><span class="token punctuation">,</span> z<span class="token operator">=</span><span class="token number">76</span> <span class="token punctuation">}</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> x<span class="token operator">=</span><span class="token number">309</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">9</span> <span class="token punctuation">,</span> z<span class="token operator">=</span><span class="token number">96</span>   <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> x<span class="token operator">=</span><span class="token number">323</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">9</span><span class="token punctuation">,</span> z<span class="token operator">=</span><span class="token number">96</span> <span class="token punctuation">}</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> x<span class="token operator">=</span><span class="token number">280</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">9</span> <span class="token punctuation">,</span> z<span class="token operator">=</span><span class="token number">76</span>   <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> x<span class="token operator">=</span><span class="token number">266</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">9</span><span class="token punctuation">,</span> z<span class="token operator">=</span><span class="token number">76</span> <span class="token punctuation">}</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> x<span class="token operator">=</span><span class="token number">266</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">9</span> <span class="token punctuation">,</span> z<span class="token operator">=</span><span class="token number">96</span>   <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> x<span class="token operator">=</span><span class="token number">280</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">9</span><span class="token punctuation">,</span> z<span class="token operator">=</span><span class="token number">96</span> <span class="token punctuation">}</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>


    RuleTipLightPos <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token punctuation">{</span> x<span class="token operator">=</span><span class="token number">294</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">7</span> <span class="token punctuation">,</span> z<span class="token operator">=</span><span class="token number">83</span> <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>


    TipLightBlockIdEnum <span class="token operator">=</span> <span class="token punctuation">{</span>
        Registered <span class="token operator">=</span> <span class="token number">949</span><span class="token punctuation">,</span>
        Unregistered <span class="token operator">=</span> <span class="token number">707</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>


<span class="token punctuation">}</span>


GobangData <span class="token operator">=</span> <span class="token punctuation">{</span>


    <span class="token punctuation">[</span>Config<span class="token punctuation">.</span>RoomType<span class="token punctuation">.</span>RoomOne<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
        IsBegin <span class="token operator">=</span> <span class="token keyword">false</span><span class="token punctuation">,</span>
        IsAI    <span class="token operator">=</span> <span class="token keyword">false</span><span class="token punctuation">,</span>
        AIChess <span class="token operator">=</span> Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>None<span class="token punctuation">,</span>
        CurChessType <span class="token operator">=</span> Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>None<span class="token punctuation">,</span>
        CanStartGame <span class="token operator">=</span> <span class="token keyword">false</span><span class="token punctuation">;</span>
        ChoseMode <span class="token operator">=</span> Config<span class="token punctuation">.</span>ChoseMode<span class="token punctuation">.</span>None<span class="token punctuation">,</span>
        MyChessType <span class="token operator">=</span> Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>None<span class="token punctuation">,</span>
        BlackChess <span class="token operator">=</span> <span class="token punctuation">{</span> uin <span class="token operator">=</span> <span class="token keyword">nil</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        WhiteChess <span class="token operator">=</span> <span class="token punctuation">{</span> uin <span class="token operator">=</span> <span class="token keyword">nil</span><span class="token punctuation">}</span><span class="token punctuation">,</span>

        CurStartModeIndex <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>
        IsStartModeFinish <span class="token operator">=</span> <span class="token keyword">false</span><span class="token punctuation">,</span>
        IsBeginRound <span class="token operator">=</span> <span class="token keyword">false</span><span class="token punctuation">,</span>

        IsWin <span class="token operator">=</span> <span class="token keyword">false</span><span class="token punctuation">,</span>
        WinUin <span class="token operator">=</span> <span class="token keyword">nil</span><span class="token punctuation">,</span>
        AreaId <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>

    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token punctuation">[</span>Config<span class="token punctuation">.</span>RoomType<span class="token punctuation">.</span>RoomTwo<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
        IsBegin <span class="token operator">=</span> <span class="token keyword">false</span><span class="token punctuation">,</span>
        IsAI    <span class="token operator">=</span> <span class="token keyword">false</span><span class="token punctuation">,</span>
        AIChess <span class="token operator">=</span> Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>None<span class="token punctuation">,</span>
        CurChessType <span class="token operator">=</span> Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>None<span class="token punctuation">,</span>
        CanStartGame <span class="token operator">=</span> <span class="token keyword">false</span><span class="token punctuation">;</span>
        ChoseMode <span class="token operator">=</span> Config<span class="token punctuation">.</span>ChoseMode<span class="token punctuation">.</span>None<span class="token punctuation">,</span>
        MyChessType <span class="token operator">=</span> Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>None<span class="token punctuation">,</span>
        BlackChess <span class="token operator">=</span> <span class="token punctuation">{</span> uin <span class="token operator">=</span> <span class="token keyword">nil</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        WhiteChess <span class="token operator">=</span> <span class="token punctuation">{</span> uin <span class="token operator">=</span> <span class="token keyword">nil</span><span class="token punctuation">}</span><span class="token punctuation">,</span>

        CurStartModeIndex <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>
        IsStartModeFinish <span class="token operator">=</span> <span class="token keyword">false</span><span class="token punctuation">,</span>
        IsBeginRound <span class="token operator">=</span> <span class="token keyword">false</span><span class="token punctuation">,</span>

        IsWin <span class="token operator">=</span> <span class="token keyword">false</span><span class="token punctuation">,</span>
        WinUin <span class="token operator">=</span> <span class="token keyword">nil</span><span class="token punctuation">,</span>
        AreaId <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token punctuation">[</span>Config<span class="token punctuation">.</span>RoomType<span class="token punctuation">.</span>RoomThree<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
        IsBegin <span class="token operator">=</span> <span class="token keyword">false</span><span class="token punctuation">,</span>
        IsAI    <span class="token operator">=</span> <span class="token keyword">false</span><span class="token punctuation">,</span>
        AIChess <span class="token operator">=</span> Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>None<span class="token punctuation">,</span>
        CurChessType <span class="token operator">=</span> Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>None<span class="token punctuation">,</span>
        CanStartGame <span class="token operator">=</span> <span class="token keyword">false</span><span class="token punctuation">;</span>
        ChoseMode <span class="token operator">=</span> Config<span class="token punctuation">.</span>ChoseMode<span class="token punctuation">.</span>None<span class="token punctuation">,</span>
        MyChessType <span class="token operator">=</span> Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>None<span class="token punctuation">,</span>
        BlackChess <span class="token operator">=</span> <span class="token punctuation">{</span> uin <span class="token operator">=</span> <span class="token keyword">nil</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        WhiteChess <span class="token operator">=</span> <span class="token punctuation">{</span> uin <span class="token operator">=</span> <span class="token keyword">nil</span><span class="token punctuation">}</span><span class="token punctuation">,</span>

        CurStartModeIndex <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>
        IsStartModeFinish <span class="token operator">=</span> <span class="token keyword">false</span><span class="token punctuation">,</span>
        IsBeginRound <span class="token operator">=</span> <span class="token keyword">false</span><span class="token punctuation">,</span>

        IsWin <span class="token operator">=</span> <span class="token keyword">false</span><span class="token punctuation">,</span>
        WinUin <span class="token operator">=</span> <span class="token keyword">nil</span><span class="token punctuation">,</span>
        AreaId <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token punctuation">[</span>Config<span class="token punctuation">.</span>RoomType<span class="token punctuation">.</span>RoomFour<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
        IsBegin <span class="token operator">=</span> <span class="token keyword">false</span><span class="token punctuation">,</span>
        IsAI    <span class="token operator">=</span> <span class="token keyword">false</span><span class="token punctuation">,</span>
        AIChess <span class="token operator">=</span> Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>None<span class="token punctuation">,</span>
        CurChessType <span class="token operator">=</span> Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>None<span class="token punctuation">,</span>
        CanStartGame <span class="token operator">=</span> <span class="token keyword">false</span><span class="token punctuation">;</span>
        ChoseMode <span class="token operator">=</span> Config<span class="token punctuation">.</span>ChoseMode<span class="token punctuation">.</span>None<span class="token punctuation">,</span>
        MyChessType <span class="token operator">=</span> Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>None<span class="token punctuation">,</span>
        BlackChess <span class="token operator">=</span> <span class="token punctuation">{</span> uin <span class="token operator">=</span> <span class="token keyword">nil</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        WhiteChess <span class="token operator">=</span> <span class="token punctuation">{</span> uin <span class="token operator">=</span> <span class="token keyword">nil</span><span class="token punctuation">}</span><span class="token punctuation">,</span>

        CurStartModeIndex <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>
        IsStartModeFinish <span class="token operator">=</span> <span class="token keyword">false</span><span class="token punctuation">,</span>
        IsBeginRound <span class="token operator">=</span> <span class="token keyword">false</span><span class="token punctuation">,</span>

        IsWin <span class="token operator">=</span> <span class="token keyword">false</span><span class="token punctuation">,</span>
        WinUin <span class="token operator">=</span> <span class="token keyword">nil</span><span class="token punctuation">,</span>
        AreaId <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    IsDesignatedStart <span class="token operator">=</span> <span class="token keyword">false</span><span class="token punctuation">,</span>


    SetWin <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>roomId<span class="token punctuation">,</span>isWin<span class="token punctuation">,</span>chessType<span class="token punctuation">)</span>
        <span class="token keyword">if</span> isWin <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">or</span> roomId <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>
        <span class="token keyword">local</span> this <span class="token operator">=</span> GobangData<span class="token punctuation">;</span>

        this<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>IsWin <span class="token operator">=</span> isWin<span class="token punctuation">;</span>
        <span class="token keyword">if</span> chessType <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span>
            this<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>WinUin <span class="token operator">=</span> this<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>CurChessType
        <span class="token keyword">else</span>
            this<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>WinUin <span class="token operator">=</span> chessType
        <span class="token keyword">end</span>

        TimerManager<span class="token punctuation">.</span><span class="token function">CreateTimer</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

            <span class="token keyword">if</span> this<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>IsAI <span class="token keyword">then</span>
                GobangMgr<span class="token punctuation">.</span><span class="token function">HandleEvent</span><span class="token punctuation">(</span>LogicEvent<span class="token punctuation">.</span>AIModeWinEvent<span class="token punctuation">,</span><span class="token punctuation">{</span>roomId <span class="token operator">=</span> roomId<span class="token punctuation">}</span><span class="token punctuation">)</span>
            <span class="token keyword">else</span>
                GobangMgr<span class="token punctuation">.</span><span class="token function">HandleEvent</span><span class="token punctuation">(</span>LogicEvent<span class="token punctuation">.</span>BattleModeWinEvent<span class="token punctuation">,</span><span class="token punctuation">{</span>roomId <span class="token operator">=</span> roomId<span class="token punctuation">}</span><span class="token punctuation">)</span>
            <span class="token keyword">end</span>
        <span class="token keyword">end</span><span class="token punctuation">)</span>

    <span class="token keyword">end</span><span class="token punctuation">,</span>


    SetMyChessType <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>roomId<span class="token punctuation">,</span>type<span class="token punctuation">)</span>
        <span class="token keyword">if</span> type <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">or</span> roomId <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>
        <span class="token keyword">local</span> this <span class="token operator">=</span> GobangData<span class="token punctuation">;</span>

        this<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>MyChessType <span class="token operator">=</span> type<span class="token punctuation">;</span>
    <span class="token keyword">end</span><span class="token punctuation">,</span>


    SetGameBegin <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>roomId<span class="token punctuation">,</span>uin<span class="token punctuation">,</span>isBegin<span class="token punctuation">)</span>
        <span class="token keyword">if</span> isBegin <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">or</span> roomId <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>
        <span class="token keyword">local</span> this <span class="token operator">=</span> GobangData<span class="token punctuation">;</span>



        this<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>IsBegin <span class="token operator">=</span> isBegin<span class="token punctuation">;</span>
        GobangMgr<span class="token punctuation">.</span><span class="token function">HandleEvent</span><span class="token punctuation">(</span>LogicEvent<span class="token punctuation">.</span>StartBeginGameEvent<span class="token punctuation">,</span><span class="token punctuation">{</span>roomId <span class="token operator">=</span> roomId<span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token keyword">end</span><span class="token punctuation">,</span>


    SetAIState <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>roomId<span class="token punctuation">,</span>isAI<span class="token punctuation">,</span>aiChess<span class="token punctuation">)</span>
        <span class="token keyword">if</span> isAI <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">or</span> roomId <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>
        <span class="token keyword">if</span> isAI <span class="token keyword">and</span> aiChess <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>
        <span class="token keyword">local</span> this <span class="token operator">=</span> GobangData<span class="token punctuation">;</span>


        this<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>IsAI <span class="token operator">=</span> isAI<span class="token punctuation">;</span>
        <span class="token function">print</span><span class="token punctuation">(</span>this<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>IsAI<span class="token punctuation">)</span>
        this<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>AIChess <span class="token operator">=</span> aiChess<span class="token punctuation">;</span>
    <span class="token keyword">end</span><span class="token punctuation">,</span>


    SetCurChess <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>roomId<span class="token punctuation">,</span>chessType<span class="token punctuation">)</span>
        <span class="token keyword">if</span> chessType <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">or</span> roomId <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>
        <span class="token keyword">local</span> this <span class="token operator">=</span> GobangData<span class="token punctuation">;</span>

        this<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>CurChessType <span class="token operator">=</span> chessType<span class="token punctuation">;</span>
        GobangMgr<span class="token punctuation">.</span><span class="token function">HandleEvent</span><span class="token punctuation">(</span>LogicEvent<span class="token punctuation">.</span>ChangeCurPlaceChessTypeEvent<span class="token punctuation">,</span><span class="token punctuation">{</span>roomId <span class="token operator">=</span> roomId<span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">end</span><span class="token punctuation">,</span>


    SetUinToChess <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>roomId<span class="token punctuation">,</span>chessType<span class="token punctuation">,</span>uin<span class="token punctuation">)</span>

        <span class="token keyword">if</span> roomId <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">or</span> chessType <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">or</span> uin <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>
        <span class="token keyword">local</span> this <span class="token operator">=</span> GobangData



        <span class="token keyword">if</span> chessType <span class="token operator">==</span> Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>WhiteChess <span class="token keyword">then</span>
            <span class="token keyword">if</span> this<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>WhiteChess<span class="token punctuation">.</span>uin <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span>
                this<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>WhiteChess<span class="token punctuation">.</span>uin <span class="token operator">=</span> uin
                this<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>CanStartGame <span class="token operator">=</span> <span class="token keyword">true</span>
            <span class="token keyword">end</span>
        <span class="token keyword">elseif</span>  chessType <span class="token operator">==</span> Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>BlackChess <span class="token keyword">then</span>
            <span class="token keyword">if</span> this<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>BlackChess<span class="token punctuation">.</span>uin <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span>
                this<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>BlackChess<span class="token punctuation">.</span>uin <span class="token operator">=</span> uin
                this<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>CanStartGame <span class="token operator">=</span> <span class="token keyword">true</span>
            <span class="token keyword">end</span>
        <span class="token keyword">end</span>
    <span class="token keyword">end</span><span class="token punctuation">,</span>


    SetChoseMode <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>roomId<span class="token punctuation">,</span>mode<span class="token punctuation">)</span>
        <span class="token keyword">if</span> roomId <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">or</span> mode <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>
        <span class="token keyword">local</span> this <span class="token operator">=</span> GobangData

        this<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>ChoseMode <span class="token operator">=</span> mode<span class="token punctuation">;</span>

    <span class="token keyword">end</span><span class="token punctuation">,</span>


    SetBeginRound <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>roomId<span class="token punctuation">,</span>mode<span class="token punctuation">)</span>
        <span class="token keyword">if</span> roomId <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">or</span> mode <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>
        <span class="token keyword">local</span> this <span class="token operator">=</span> GobangData

        Api<span class="token punctuation">.</span>Chat<span class="token punctuation">:</span><span class="token function">sendSystemMsg</span><span class="token punctuation">(</span><span class="token string">&quot;room &quot;</span><span class="token operator">..</span>roomId<span class="token operator">..</span><span class="token string">&quot;Set start round &quot;</span><span class="token punctuation">)</span>


        this<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>CurChessType<span class="token operator">=</span>Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>WhiteChess <span class="token punctuation">;</span>
        <span class="token keyword">if</span> this<span class="token punctuation">.</span>IsDesignatedStart <span class="token operator">==</span> <span class="token keyword">false</span> <span class="token keyword">and</span> this<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>IsAI <span class="token keyword">then</span>
            this<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>CurChessType<span class="token operator">=</span>Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>BlackChess

        <span class="token keyword">end</span>
        this<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>IsBeginRound <span class="token operator">=</span> mode<span class="token punctuation">;</span>
        GobangMgr<span class="token punctuation">.</span><span class="token function">HandleEvent</span><span class="token punctuation">(</span>LogicEvent<span class="token punctuation">.</span>StartRoundEvent<span class="token punctuation">,</span><span class="token punctuation">{</span>roomId <span class="token operator">=</span> roomId<span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token keyword">end</span><span class="token punctuation">,</span>

    SetStartMode <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>roomId<span class="token punctuation">,</span>mode<span class="token punctuation">)</span>
        <span class="token keyword">if</span> roomId <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">or</span> mode <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>
        <span class="token keyword">local</span> this <span class="token operator">=</span> GobangData

        this<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>IsStartModeFinish <span class="token operator">=</span> mode<span class="token punctuation">;</span>

        <span class="token keyword">if</span> this<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>IsAI <span class="token keyword">then</span>
            GobangMgr<span class="token punctuation">.</span><span class="token function">HandleEvent</span><span class="token punctuation">(</span>LogicEvent<span class="token punctuation">.</span>AIStartThreeModeEvent<span class="token punctuation">,</span><span class="token punctuation">{</span>roomId<span class="token operator">=</span>roomId<span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token keyword">else</span>
            GobangMgr<span class="token punctuation">.</span><span class="token function">HandleEvent</span><span class="token punctuation">(</span>LogicEvent<span class="token punctuation">.</span>SelectedStartThreeModeEvent<span class="token punctuation">,</span><span class="token punctuation">{</span>roomId<span class="token operator">=</span>roomId<span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token keyword">end</span>

    <span class="token keyword">end</span><span class="token punctuation">,</span>


    SetCurStartModeIndex <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>roomId<span class="token punctuation">,</span>index<span class="token punctuation">)</span>
        <span class="token keyword">if</span> roomId <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">or</span> index <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>
        <span class="token keyword">local</span> this <span class="token operator">=</span> GobangData<span class="token punctuation">;</span>

        this<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>CurStartModeIndex <span class="token operator">=</span> index<span class="token punctuation">;</span>

        GobangMgr<span class="token punctuation">.</span><span class="token function">HandleEvent</span><span class="token punctuation">(</span>LogicEvent<span class="token punctuation">.</span>ChangeThreeModeEvent<span class="token punctuation">,</span><span class="token punctuation">{</span>roomId <span class="token operator">=</span> roomId<span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">end</span><span class="token punctuation">,</span>


    ChangeCamp <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>roomId<span class="token punctuation">)</span>
        <span class="token keyword">if</span> roomId <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>

        <span class="token keyword">local</span> this <span class="token operator">=</span> GobangData<span class="token punctuation">;</span>
        <span class="token keyword">if</span> this<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>

        <span class="token keyword">if</span> this<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>IsAI <span class="token keyword">then</span>
            <span class="token keyword">if</span> this<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>AIChess <span class="token operator">~=</span> Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>WhiteChess <span class="token keyword">then</span>
                this<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>AIChess <span class="token operator">=</span> Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>WhiteChess
                this<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>MyChessType <span class="token operator">=</span> Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>BlackChess
                this<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>BlackChess<span class="token punctuation">.</span>uin <span class="token operator">=</span> this<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>WhiteChess<span class="token punctuation">.</span>uin
                this<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>WhiteChess<span class="token punctuation">.</span>uin <span class="token operator">=</span> <span class="token keyword">nil</span>

                Api<span class="token punctuation">.</span>Chat<span class="token punctuation">:</span><span class="token function">sendSystemMsg</span><span class="token punctuation">(</span><span class="token string">&quot;Man-machine alternate &quot;</span><span class="token punctuation">)</span>
                GobangMgr<span class="token punctuation">.</span><span class="token function">HandleEvent</span><span class="token punctuation">(</span>LogicEvent<span class="token punctuation">.</span>ChangeCampEvent<span class="token punctuation">,</span><span class="token punctuation">{</span>roomId <span class="token operator">=</span> roomId<span class="token punctuation">}</span><span class="token punctuation">)</span>
            <span class="token keyword">end</span>
        <span class="token keyword">else</span>
            <span class="token keyword">if</span> this<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>BlackChess<span class="token punctuation">.</span>uin <span class="token keyword">and</span> this<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>WhiteChess<span class="token punctuation">.</span>uin <span class="token keyword">then</span>
                <span class="token keyword">local</span> uin <span class="token operator">=</span> this<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>BlackChess<span class="token punctuation">.</span>uin
                this<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>BlackChess<span class="token punctuation">.</span>uin <span class="token operator">=</span> this<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>WhiteChess<span class="token punctuation">.</span>uin
                this<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>WhiteChess<span class="token punctuation">.</span>uin <span class="token operator">=</span> uin<span class="token punctuation">;</span>

                Api<span class="token punctuation">.</span>Chat<span class="token punctuation">:</span><span class="token function">sendSystemMsg</span><span class="token punctuation">(</span><span class="token string">&quot;alternate &quot;</span><span class="token punctuation">)</span>
                GobangMgr<span class="token punctuation">.</span><span class="token function">HandleEvent</span><span class="token punctuation">(</span>LogicEvent<span class="token punctuation">.</span>ChangeCampEvent<span class="token punctuation">,</span><span class="token punctuation">{</span>roomId <span class="token operator">=</span> roomId<span class="token punctuation">}</span><span class="token punctuation">)</span>
            <span class="token keyword">else</span>

            <span class="token keyword">end</span>
        <span class="token keyword">end</span>

    <span class="token keyword">end</span><span class="token punctuation">,</span>


    SetAbstain <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>roomId<span class="token punctuation">,</span>uin<span class="token punctuation">)</span>
        <span class="token keyword">if</span> roomId <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>
        <span class="token keyword">local</span> this <span class="token operator">=</span> GobangData

        <span class="token keyword">if</span> this<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>CurChessType <span class="token operator">==</span> Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>WhiteChess <span class="token keyword">then</span>
            this<span class="token punctuation">.</span><span class="token function">SetCurChess</span><span class="token punctuation">(</span>roomId<span class="token punctuation">,</span>Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>BlackChess<span class="token punctuation">)</span>
        <span class="token keyword">elseif</span> this<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>CurChessType <span class="token operator">==</span> Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>BlackChess <span class="token keyword">then</span>
            this<span class="token punctuation">.</span><span class="token function">SetCurChess</span><span class="token punctuation">(</span>roomId<span class="token punctuation">,</span>Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>WhiteChess<span class="token punctuation">)</span>
        <span class="token keyword">end</span>

        Api<span class="token punctuation">.</span>Chat<span class="token punctuation">:</span><span class="token function">sendSystemMsg</span><span class="token punctuation">(</span><span class="token string">&quot;Set a waiver &quot;</span><span class="token punctuation">)</span>
        GobangMgr<span class="token punctuation">.</span><span class="token function">HandleEvent</span><span class="token punctuation">(</span>LogicEvent<span class="token punctuation">.</span>AbstainEvent<span class="token punctuation">,</span><span class="token punctuation">{</span>roomId <span class="token operator">=</span> roomId<span class="token punctuation">,</span>uin<span class="token operator">=</span>uin<span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">end</span><span class="token punctuation">,</span>


    CancelSelectChess <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>roomId<span class="token punctuation">,</span>chessType<span class="token punctuation">,</span>uin<span class="token punctuation">)</span>
        <span class="token keyword">if</span> roomId <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">or</span> chessType <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">or</span> uin <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>
        <span class="token keyword">local</span> this <span class="token operator">=</span> GobangData

        <span class="token keyword">if</span> chessType <span class="token operator">==</span> Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>BlackChess <span class="token keyword">and</span> this<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>BlackChess<span class="token punctuation">.</span>uin <span class="token operator">==</span> uin <span class="token keyword">then</span>
            this<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>BlackChess<span class="token punctuation">.</span>uin <span class="token operator">=</span> <span class="token keyword">nil</span>
            this<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>MyChessType <span class="token operator">=</span> Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>None

        <span class="token keyword">elseif</span> chessType <span class="token operator">==</span> Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>WhiteChess <span class="token keyword">then</span>
            this<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>WhiteChess<span class="token punctuation">.</span>uin <span class="token operator">=</span> <span class="token keyword">nil</span>
            this<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>MyChessType <span class="token operator">=</span> Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>None
        <span class="token keyword">end</span>

        <span class="token keyword">if</span>  this<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>BlackChess<span class="token punctuation">.</span>uin <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">and</span>  this<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>WhiteChess<span class="token punctuation">.</span>uin <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span>
            this<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>ChoseMode <span class="token operator">=</span> Config<span class="token punctuation">.</span>ChoseMode<span class="token punctuation">.</span>None
            this<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>AIChess <span class="token operator">=</span> Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>None
        <span class="token keyword">end</span>

    <span class="token keyword">end</span><span class="token punctuation">,</span>


    SetDesignatedStart <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">local</span> this <span class="token operator">=</span> GobangData

        <span class="token keyword">if</span> this<span class="token punctuation">.</span>IsDesignatedStart <span class="token keyword">then</span>
            this<span class="token punctuation">.</span>IsDesignatedStart <span class="token operator">=</span> <span class="token keyword">false</span>

        <span class="token keyword">else</span>
            this<span class="token punctuation">.</span>IsDesignatedStart <span class="token operator">=</span> <span class="token keyword">true</span>

        <span class="token keyword">end</span>

    <span class="token keyword">end</span><span class="token punctuation">,</span>

    ResetRoomState <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>roomId<span class="token punctuation">)</span>
        <span class="token keyword">if</span> roomId <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>


        GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
            IsBegin <span class="token operator">=</span> <span class="token keyword">false</span><span class="token punctuation">,</span>
            IsAI    <span class="token operator">=</span> <span class="token keyword">false</span><span class="token punctuation">,</span>
            AIChess <span class="token operator">=</span> Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>None<span class="token punctuation">,</span>
            CurChessType <span class="token operator">=</span> Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>None<span class="token punctuation">,</span>
            CanStartGame <span class="token operator">=</span> <span class="token keyword">false</span><span class="token punctuation">;</span>
            ChoseMode <span class="token operator">=</span> Config<span class="token punctuation">.</span>ChoseMode<span class="token punctuation">.</span>None<span class="token punctuation">,</span>
            MyChessType <span class="token operator">=</span> Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>None<span class="token punctuation">,</span>
            BlackChess <span class="token operator">=</span> <span class="token punctuation">{</span> uin <span class="token operator">=</span> <span class="token keyword">nil</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
            WhiteChess <span class="token operator">=</span> <span class="token punctuation">{</span> uin <span class="token operator">=</span> <span class="token keyword">nil</span><span class="token punctuation">}</span><span class="token punctuation">,</span>

            CurStartModeIndex <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>
            IsStartModeFinish <span class="token operator">=</span> <span class="token keyword">false</span><span class="token punctuation">,</span>
            IsBeginRound <span class="token operator">=</span> <span class="token keyword">false</span><span class="token punctuation">,</span>

            IsWin <span class="token operator">=</span> <span class="token keyword">false</span><span class="token punctuation">,</span>
            WinUin <span class="token operator">=</span> <span class="token keyword">nil</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span>



    <span class="token keyword">end</span><span class="token punctuation">,</span>

<span class="token punctuation">}</span>

SwitchCtrl<span class="token operator">=</span> <span class="token punctuation">{</span>


    SwitchTrigger <span class="token operator">=</span><span class="token keyword">function</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>z<span class="token punctuation">,</span>uin<span class="token punctuation">,</span>blockid<span class="token punctuation">)</span>
        <span class="token keyword">if</span> Config <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">or</span> Config<span class="token punctuation">.</span>SwitchMapping <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>
        <span class="token keyword">if</span> x <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">or</span> y <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">or</span> z <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>

        <span class="token keyword">local</span> this <span class="token operator">=</span> SwitchCtrl
        <span class="token keyword">local</span> ret<span class="token punctuation">,</span>data <span class="token operator">=</span> Api<span class="token punctuation">.</span>Block<span class="token punctuation">:</span><span class="token function">getBlockData</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z<span class="token punctuation">)</span>
        Api<span class="token punctuation">.</span>Block<span class="token punctuation">:</span><span class="token function">setBlockAll</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z<span class="token punctuation">,</span> blockid<span class="token punctuation">,</span>data<span class="token operator">-</span><span class="token number">8</span><span class="token punctuation">)</span>

        <span class="token keyword">for</span> k<span class="token punctuation">,</span>v <span class="token keyword">in</span> <span class="token function">pairs</span><span class="token punctuation">(</span>Config<span class="token punctuation">.</span>SwitchMapping<span class="token punctuation">)</span> <span class="token keyword">do</span>
            <span class="token keyword">if</span> v<span class="token punctuation">.</span>x <span class="token operator">==</span>x <span class="token keyword">and</span> v<span class="token punctuation">.</span>y <span class="token operator">==</span> y <span class="token keyword">and</span> v<span class="token punctuation">.</span>z <span class="token operator">==</span> z <span class="token keyword">then</span>
                <span class="token keyword">if</span> v<span class="token punctuation">.</span>type <span class="token operator">==</span> Config<span class="token punctuation">.</span>SwitchType<span class="token punctuation">.</span>RandomSelect <span class="token keyword">then</span>
                    this<span class="token punctuation">.</span><span class="token function">RandomSelectChess</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span>roomId<span class="token punctuation">,</span>uin<span class="token punctuation">)</span>
                <span class="token keyword">elseif</span> v<span class="token punctuation">.</span>type <span class="token operator">==</span> Config<span class="token punctuation">.</span>SwitchType<span class="token punctuation">.</span>StartGame <span class="token keyword">then</span>
                    this<span class="token punctuation">.</span><span class="token function">GameStart</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span>roomId<span class="token punctuation">,</span>uin<span class="token punctuation">)</span>
                <span class="token keyword">elseif</span> v<span class="token punctuation">.</span>type <span class="token operator">==</span> Config<span class="token punctuation">.</span>SwitchType<span class="token punctuation">.</span>BlackChess <span class="token keyword">then</span>
                    this<span class="token punctuation">.</span><span class="token function">SelectBlackChess</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span>roomId<span class="token punctuation">,</span>uin<span class="token punctuation">)</span>
                <span class="token keyword">elseif</span> v<span class="token punctuation">.</span>type <span class="token operator">==</span> Config<span class="token punctuation">.</span>SwitchType<span class="token punctuation">.</span>WhiteChess <span class="token keyword">then</span>
                    this<span class="token punctuation">.</span><span class="token function">SelectWhiteChess</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span>roomId<span class="token punctuation">,</span>uin<span class="token punctuation">)</span>
                <span class="token keyword">elseif</span> v<span class="token punctuation">.</span>type <span class="token operator">==</span> Config<span class="token punctuation">.</span>SwitchType<span class="token punctuation">.</span>ChangeThreeMode <span class="token keyword">then</span>
                    this<span class="token punctuation">.</span><span class="token function">ChangeThreeChessMode</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span>roomId<span class="token punctuation">,</span>uin<span class="token punctuation">)</span>
                <span class="token keyword">elseif</span> v<span class="token punctuation">.</span>type <span class="token operator">==</span> Config<span class="token punctuation">.</span>SwitchType<span class="token punctuation">.</span>BlackStartRound <span class="token keyword">then</span>
                    this<span class="token punctuation">.</span><span class="token function">StartGameMode</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span>roomId<span class="token punctuation">,</span>uin<span class="token punctuation">)</span>
                <span class="token keyword">elseif</span> v<span class="token punctuation">.</span>type <span class="token operator">==</span> Config<span class="token punctuation">.</span>SwitchType<span class="token punctuation">.</span>WhiteStartRound <span class="token keyword">then</span>
                    this<span class="token punctuation">.</span><span class="token function">StartRound</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span>roomId<span class="token punctuation">,</span>uin<span class="token punctuation">)</span>
                <span class="token keyword">elseif</span> v<span class="token punctuation">.</span>type <span class="token operator">==</span> Config<span class="token punctuation">.</span>SwitchType<span class="token punctuation">.</span>Abstain <span class="token keyword">then</span>
                    this<span class="token punctuation">.</span><span class="token function">Abstain</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span>roomId<span class="token punctuation">,</span>uin<span class="token punctuation">)</span>
                <span class="token keyword">elseif</span> v<span class="token punctuation">.</span>type <span class="token operator">==</span> Config<span class="token punctuation">.</span>SwitchType<span class="token punctuation">.</span>ChangeChessType <span class="token keyword">then</span>
                    this<span class="token punctuation">.</span><span class="token function">ChangeChessCamp</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span>roomId<span class="token punctuation">,</span>uin<span class="token punctuation">)</span>
                <span class="token keyword">elseif</span> v<span class="token punctuation">.</span>type <span class="token operator">==</span> Config<span class="token punctuation">.</span>SwitchType<span class="token punctuation">.</span>DesignatedStartType <span class="token keyword">then</span>
                    this<span class="token punctuation">.</span><span class="token function">DesignatedStart</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span>roomId<span class="token punctuation">,</span>uin<span class="token punctuation">)</span>
                <span class="token keyword">elseif</span> v<span class="token punctuation">.</span>type <span class="token operator">==</span> Config<span class="token punctuation">.</span>SwitchType<span class="token punctuation">.</span>AdmitDefeatType <span class="token keyword">then</span>
                    this<span class="token punctuation">.</span><span class="token function">AdmitDefeat</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span>roomId<span class="token punctuation">,</span>uin<span class="token punctuation">)</span>
                <span class="token keyword">end</span>
            <span class="token keyword">end</span>
        <span class="token keyword">end</span>

    <span class="token keyword">end</span><span class="token punctuation">,</span>


    RandomSelectChess <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>roomId<span class="token punctuation">,</span>uin<span class="token punctuation">)</span>
        <span class="token keyword">if</span> roomId <span class="token operator">==</span>  <span class="token keyword">nil</span> <span class="token keyword">or</span>  uin <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>

        <span class="token keyword">local</span> data <span class="token operator">=</span> GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> data<span class="token punctuation">.</span>IsBegin <span class="token keyword">or</span> data<span class="token punctuation">.</span>ChoseMode <span class="token operator">==</span> Config<span class="token punctuation">.</span>ChoseMode<span class="token punctuation">.</span>Default <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>

        <span class="token keyword">if</span> data<span class="token punctuation">.</span>BlackChess<span class="token punctuation">.</span>uin <span class="token operator">~=</span> <span class="token keyword">nil</span> <span class="token keyword">and</span> data<span class="token punctuation">.</span>WhiteChess<span class="token punctuation">.</span>uin <span class="token operator">~=</span> <span class="token keyword">nil</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>
        <span class="token keyword">if</span> data<span class="token punctuation">.</span>BlackChess<span class="token punctuation">.</span>uin <span class="token operator">==</span> uin <span class="token keyword">or</span> data<span class="token punctuation">.</span>WhiteChess<span class="token punctuation">.</span>uin <span class="token operator">==</span> uin <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>

        <span class="token keyword">local</span> selectType<span class="token punctuation">;</span>


        <span class="token keyword">if</span> data<span class="token punctuation">.</span>BlackChess<span class="token punctuation">.</span>uin <span class="token operator">~=</span> <span class="token keyword">nil</span> <span class="token keyword">then</span>
            selectType <span class="token operator">=</span> Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>WhiteChess
            Api<span class="token punctuation">.</span>Player<span class="token punctuation">:</span><span class="token function">notifyGameInfo2Self</span><span class="token punctuation">(</span>uin<span class="token punctuation">,</span><span class="token string">&quot;Randomly assigned as white &quot;</span><span class="token punctuation">)</span>
        <span class="token keyword">elseif</span> data<span class="token punctuation">.</span>WhiteChess<span class="token punctuation">.</span>uin <span class="token operator">~=</span><span class="token keyword">nil</span> <span class="token keyword">then</span>
            selectType <span class="token operator">=</span> Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>BlackChess
            Api<span class="token punctuation">.</span>Player<span class="token punctuation">:</span><span class="token function">notifyGameInfo2Self</span><span class="token punctuation">(</span>uin<span class="token punctuation">,</span><span class="token string">&quot;Randomly assigned as black &quot;</span><span class="token punctuation">)</span>
        <span class="token keyword">end</span>


        <span class="token keyword">if</span> data<span class="token punctuation">.</span>BlackChess<span class="token punctuation">.</span>uin <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">and</span> data<span class="token punctuation">.</span>WhiteChess<span class="token punctuation">.</span>uin <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span>
            <span class="token keyword">local</span> randomNum <span class="token operator">=</span> math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">)</span>
            <span class="token keyword">local</span> generateChess <span class="token operator">=</span> randomNum<span class="token operator">%</span><span class="token number">2</span> <span class="token operator">+</span><span class="token number">1</span>

            <span class="token keyword">if</span> Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>WhiteChess <span class="token operator">==</span> generateChess <span class="token keyword">then</span>
                selectType<span class="token operator">=</span>Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>WhiteChess
                Api<span class="token punctuation">.</span>Player<span class="token punctuation">:</span><span class="token function">notifyGameInfo2Self</span><span class="token punctuation">(</span>uin<span class="token punctuation">,</span><span class="token string">&quot;Randomly assigned as white &quot;</span><span class="token punctuation">)</span>
            <span class="token keyword">elseif</span> Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>BlackChess <span class="token operator">==</span> generateChess <span class="token keyword">then</span>
                selectType<span class="token operator">=</span>Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>BlackChess
                Api<span class="token punctuation">.</span>Player<span class="token punctuation">:</span><span class="token function">notifyGameInfo2Self</span><span class="token punctuation">(</span>uin<span class="token punctuation">,</span><span class="token string">&quot;Randomly assigned as black &quot;</span><span class="token punctuation">)</span>
            <span class="token keyword">end</span>
        <span class="token keyword">end</span>

        GobangData<span class="token punctuation">.</span><span class="token function">SetUinToChess</span><span class="token punctuation">(</span>roomId<span class="token punctuation">,</span>selectType<span class="token punctuation">,</span>uin<span class="token punctuation">)</span>
        SettingRule<span class="token punctuation">.</span><span class="token function">SetTipLightState</span><span class="token punctuation">(</span>roomId<span class="token punctuation">,</span>selectType<span class="token punctuation">,</span><span class="token keyword">true</span><span class="token punctuation">)</span>
        GobangData<span class="token punctuation">.</span><span class="token function">SetChoseMode</span><span class="token punctuation">(</span>roomId<span class="token punctuation">,</span>Config<span class="token punctuation">.</span>ChoseMode<span class="token punctuation">.</span>Random<span class="token punctuation">)</span>


        GobangData<span class="token punctuation">.</span><span class="token function">SetMyChessType</span><span class="token punctuation">(</span>roomId<span class="token punctuation">,</span>selectType<span class="token punctuation">)</span>


    <span class="token keyword">end</span><span class="token punctuation">,</span>

    DesignatedStart<span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>roomId<span class="token punctuation">,</span>uin<span class="token punctuation">)</span>

        <span class="token keyword">local</span> hasGameStart <span class="token operator">=</span> <span class="token keyword">false</span>

        <span class="token keyword">local</span> ret<span class="token punctuation">,</span> hostUin <span class="token operator">=</span> Api<span class="token punctuation">.</span>Player<span class="token punctuation">:</span><span class="token function">getHostUin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> hostUin <span class="token operator">~=</span> uin <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>

        <span class="token keyword">for</span> k<span class="token punctuation">,</span>v <span class="token keyword">in</span> <span class="token function">pairs</span><span class="token punctuation">(</span>Config<span class="token punctuation">.</span>RoomType<span class="token punctuation">)</span> <span class="token keyword">do</span>
            <span class="token keyword">local</span> data <span class="token operator">=</span> GobangData<span class="token punctuation">[</span>v<span class="token punctuation">]</span>
            <span class="token keyword">if</span> data <span class="token operator">~=</span> <span class="token keyword">nil</span> <span class="token keyword">and</span> data<span class="token punctuation">.</span>IsBegin <span class="token keyword">then</span>
                hasGameStart <span class="token operator">=</span> <span class="token keyword">true</span>
            <span class="token keyword">end</span>
        <span class="token keyword">end</span>

        <span class="token keyword">if</span> hasGameStart <span class="token operator">==</span> <span class="token keyword">false</span> <span class="token keyword">then</span>
            GobangData<span class="token punctuation">.</span><span class="token function">SetDesignatedStart</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            SettingRule<span class="token punctuation">.</span><span class="token function">SetRuleTipLightSate</span><span class="token punctuation">(</span>GobangData<span class="token punctuation">.</span>IsDesignatedStart<span class="token punctuation">)</span>
            <span class="token keyword">if</span> GobangData<span class="token punctuation">.</span>IsDesignatedStart <span class="token keyword">then</span>
                Api<span class="token punctuation">.</span>Chat<span class="token punctuation">:</span><span class="token function">sendSystemMsg</span><span class="token punctuation">(</span><span class="token string">&quot;The host adds advanced rules &quot;</span><span class="token punctuation">)</span>
            <span class="token keyword">else</span>
                Api<span class="token punctuation">.</span>Chat<span class="token punctuation">:</span><span class="token function">sendSystemMsg</span><span class="token punctuation">(</span><span class="token string">&quot;The host removes advanced rules &quot;</span><span class="token punctuation">)</span>
            <span class="token keyword">end</span>


        <span class="token keyword">else</span>
            Api<span class="token punctuation">.</span>Player<span class="token punctuation">:</span><span class="token function">notifyGameInfo2Self</span><span class="token punctuation">(</span>uin<span class="token punctuation">,</span><span class="token string">&quot;There is an ongoing game in the room and the rule modification failed. &quot;</span><span class="token punctuation">)</span>
        <span class="token keyword">end</span>

    <span class="token keyword">end</span><span class="token punctuation">,</span>

    GameStart <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>roomId<span class="token punctuation">,</span>uin<span class="token punctuation">)</span>
        <span class="token keyword">if</span> roomId <span class="token operator">==</span>  <span class="token keyword">nil</span> <span class="token keyword">or</span>  uin <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>
        <span class="token keyword">local</span> data <span class="token operator">=</span> GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> data<span class="token punctuation">.</span>IsBegin <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>

        <span class="token keyword">if</span> data<span class="token punctuation">.</span>IsBegin <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>
        <span class="token keyword">if</span> data<span class="token punctuation">.</span>CanStartGame <span class="token operator">==</span> <span class="token keyword">false</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>


        <span class="token keyword">if</span> data<span class="token punctuation">.</span>BlackChess<span class="token punctuation">.</span>uin <span class="token operator">~=</span> uin <span class="token keyword">and</span> data<span class="token punctuation">.</span>WhiteChess<span class="token punctuation">.</span>uin <span class="token operator">~=</span> uin <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>


        <span class="token keyword">if</span> <span class="token punctuation">(</span>data<span class="token punctuation">.</span>BlackChess<span class="token punctuation">.</span>uin <span class="token operator">==</span> uin <span class="token keyword">and</span> data<span class="token punctuation">.</span>WhiteChess<span class="token punctuation">.</span>uin <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token punctuation">)</span> <span class="token keyword">then</span>
            GobangData<span class="token punctuation">.</span><span class="token function">SetAIState</span><span class="token punctuation">(</span>roomId<span class="token punctuation">,</span><span class="token keyword">true</span><span class="token punctuation">,</span>Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>WhiteChess<span class="token punctuation">)</span>
            Api<span class="token punctuation">.</span>Player<span class="token punctuation">:</span><span class="token function">notifyGameInfo2Self</span><span class="token punctuation">(</span>uin<span class="token punctuation">,</span><span class="token string">&quot;Game starts in 3 seconds &quot;</span><span class="token punctuation">)</span>
        <span class="token keyword">elseif</span>  <span class="token punctuation">(</span>data<span class="token punctuation">.</span>WhiteChess<span class="token punctuation">.</span>uin <span class="token operator">==</span> uin <span class="token keyword">and</span> data<span class="token punctuation">.</span>BlackChess<span class="token punctuation">.</span>uin <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token punctuation">)</span> <span class="token keyword">then</span>
            GobangData<span class="token punctuation">.</span><span class="token function">SetAIState</span><span class="token punctuation">(</span>roomId<span class="token punctuation">,</span><span class="token keyword">true</span><span class="token punctuation">,</span>Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>BlackChess<span class="token punctuation">)</span>
            Api<span class="token punctuation">.</span>Player<span class="token punctuation">:</span><span class="token function">notifyGameInfo2Self</span><span class="token punctuation">(</span>uin<span class="token punctuation">,</span><span class="token string">&quot;Game starts in 3 seconds &quot;</span><span class="token punctuation">)</span>
        <span class="token keyword">else</span>
            GobangData<span class="token punctuation">.</span><span class="token function">SetAIState</span><span class="token punctuation">(</span>roomId<span class="token punctuation">,</span><span class="token keyword">false</span><span class="token punctuation">)</span>
            Api<span class="token punctuation">.</span>Player<span class="token punctuation">:</span><span class="token function">notifyGameInfo2Self</span><span class="token punctuation">(</span>uin<span class="token punctuation">,</span><span class="token string">&quot;Game starts in 3 seconds &quot;</span><span class="token punctuation">)</span>
        <span class="token keyword">end</span>

        TimerManager<span class="token punctuation">.</span><span class="token function">CreateCountdownTimer</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span>uin<span class="token punctuation">,</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span>
            GobangData<span class="token punctuation">.</span><span class="token function">SetGameBegin</span><span class="token punctuation">(</span>roomId<span class="token punctuation">,</span>uin<span class="token punctuation">,</span><span class="token keyword">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            SettingRule<span class="token punctuation">.</span><span class="token function">PlayerInSelfChess</span><span class="token punctuation">(</span>roomId<span class="token punctuation">)</span>
        <span class="token keyword">end</span><span class="token punctuation">)</span>

    <span class="token keyword">end</span><span class="token punctuation">,</span>


    SelectBlackChess <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>roomId<span class="token punctuation">,</span>uin<span class="token punctuation">)</span>
        <span class="token keyword">if</span> roomId <span class="token operator">==</span>  <span class="token keyword">nil</span> <span class="token keyword">or</span>  uin <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>

        <span class="token keyword">local</span> data <span class="token operator">=</span> GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> data<span class="token punctuation">.</span>IsBegin  <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>

        <span class="token keyword">if</span> data<span class="token punctuation">.</span>WhiteChess<span class="token punctuation">.</span>uin <span class="token operator">==</span> uin <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>
        <span class="token function">print</span><span class="token punctuation">(</span>GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">)</span>

        <span class="token keyword">if</span> data<span class="token punctuation">.</span>BlackChess<span class="token punctuation">.</span>uin <span class="token operator">==</span> uin <span class="token keyword">then</span>
            Api<span class="token punctuation">.</span>Player<span class="token punctuation">:</span><span class="token function">notifyGameInfo2Self</span><span class="token punctuation">(</span>uin<span class="token punctuation">,</span><span class="token string">&quot;Cancel application &quot;</span><span class="token punctuation">)</span>
            GobangData<span class="token punctuation">.</span><span class="token function">CancelSelectChess</span><span class="token punctuation">(</span>roomId<span class="token punctuation">,</span>Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>BlackChess<span class="token punctuation">,</span>uin<span class="token punctuation">)</span>
            SettingRule<span class="token punctuation">.</span><span class="token function">SetTipLightState</span><span class="token punctuation">(</span>roomId<span class="token punctuation">,</span>Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>BlackChess<span class="token punctuation">,</span><span class="token keyword">false</span><span class="token punctuation">)</span>
        <span class="token keyword">elseif</span> data<span class="token punctuation">.</span>BlackChess<span class="token punctuation">.</span>uin <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span>
            <span class="token keyword">if</span> data<span class="token punctuation">.</span>ChoseMode <span class="token operator">==</span> Config<span class="token punctuation">.</span>ChoseMode<span class="token punctuation">.</span>Random <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>

            GobangData<span class="token punctuation">.</span><span class="token function">SetUinToChess</span><span class="token punctuation">(</span>roomId<span class="token punctuation">,</span>Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>BlackChess<span class="token punctuation">,</span>uin<span class="token punctuation">)</span>
            SettingRule<span class="token punctuation">.</span><span class="token function">SetTipLightState</span><span class="token punctuation">(</span>roomId<span class="token punctuation">,</span>Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>BlackChess<span class="token punctuation">,</span><span class="token keyword">true</span><span class="token punctuation">)</span>
            Api<span class="token punctuation">.</span>Player<span class="token punctuation">:</span><span class="token function">notifyGameInfo2Self</span><span class="token punctuation">(</span>uin<span class="token punctuation">,</span><span class="token string">&quot;Apply for black &quot;</span><span class="token punctuation">)</span>

            GobangData<span class="token punctuation">.</span><span class="token function">SetChoseMode</span><span class="token punctuation">(</span>roomId<span class="token punctuation">,</span>Config<span class="token punctuation">.</span>ChoseMode<span class="token punctuation">.</span>Default<span class="token punctuation">)</span>

            GobangData<span class="token punctuation">.</span><span class="token function">SetMyChessType</span><span class="token punctuation">(</span>roomId<span class="token punctuation">,</span>Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>BlackChess<span class="token punctuation">)</span>

        <span class="token keyword">end</span>

    <span class="token keyword">end</span><span class="token punctuation">,</span>


    SelectWhiteChess <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>roomId<span class="token punctuation">,</span>uin<span class="token punctuation">)</span>
        <span class="token keyword">if</span> roomId <span class="token operator">==</span>  <span class="token keyword">nil</span> <span class="token keyword">or</span>  uin <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>

        <span class="token keyword">local</span> data <span class="token operator">=</span> GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> data<span class="token punctuation">.</span>IsBegin  <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>

        <span class="token keyword">if</span> data<span class="token punctuation">.</span>BlackChess<span class="token punctuation">.</span>uin <span class="token operator">==</span> uin <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>

        <span class="token keyword">if</span> data<span class="token punctuation">.</span>WhiteChess<span class="token punctuation">.</span>uin <span class="token operator">==</span> uin <span class="token keyword">then</span>
            Api<span class="token punctuation">.</span>Player<span class="token punctuation">:</span><span class="token function">notifyGameInfo2Self</span><span class="token punctuation">(</span>uin<span class="token punctuation">,</span><span class="token string">&quot;Cancel application &quot;</span><span class="token punctuation">)</span>
            GobangData<span class="token punctuation">.</span><span class="token function">CancelSelectChess</span><span class="token punctuation">(</span>roomId<span class="token punctuation">,</span>Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>WhiteChess<span class="token punctuation">,</span>uin<span class="token punctuation">)</span>
            SettingRule<span class="token punctuation">.</span><span class="token function">SetTipLightState</span><span class="token punctuation">(</span>roomId<span class="token punctuation">,</span>Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>WhiteChess<span class="token punctuation">,</span><span class="token keyword">false</span><span class="token punctuation">)</span>
        <span class="token keyword">elseif</span> data<span class="token punctuation">.</span>WhiteChess<span class="token punctuation">.</span>uin <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span>
            GobangData<span class="token punctuation">.</span><span class="token function">SetUinToChess</span><span class="token punctuation">(</span>roomId<span class="token punctuation">,</span>Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>WhiteChess<span class="token punctuation">,</span>uin<span class="token punctuation">)</span>
            SettingRule<span class="token punctuation">.</span><span class="token function">SetTipLightState</span><span class="token punctuation">(</span>roomId<span class="token punctuation">,</span>Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>WhiteChess<span class="token punctuation">,</span><span class="token keyword">true</span><span class="token punctuation">)</span>
            Api<span class="token punctuation">.</span>Player<span class="token punctuation">:</span><span class="token function">notifyGameInfo2Self</span><span class="token punctuation">(</span>uin<span class="token punctuation">,</span><span class="token string">&quot;Apply for white &quot;</span><span class="token punctuation">)</span>

            GobangData<span class="token punctuation">.</span><span class="token function">SetChoseMode</span><span class="token punctuation">(</span>roomId<span class="token punctuation">,</span>Config<span class="token punctuation">.</span>ChoseMode<span class="token punctuation">.</span>Default<span class="token punctuation">)</span>
            GobangData<span class="token punctuation">.</span><span class="token function">SetMyChessType</span><span class="token punctuation">(</span>roomId<span class="token punctuation">,</span>Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>WhiteChess<span class="token punctuation">)</span>


        <span class="token keyword">end</span>

    <span class="token keyword">end</span><span class="token punctuation">,</span>


    ChangeThreeChessMode <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>roomId<span class="token punctuation">,</span>uin<span class="token punctuation">)</span>
        <span class="token keyword">if</span> roomId <span class="token operator">==</span>  <span class="token keyword">nil</span> <span class="token keyword">or</span>  uin <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>
        <span class="token keyword">if</span> GobangData<span class="token punctuation">.</span>IsDesignatedStart <span class="token operator">==</span> <span class="token keyword">false</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>
        <span class="token keyword">local</span> data <span class="token operator">=</span> GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> data<span class="token punctuation">.</span>IsStartModeFinish <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>
        <span class="token keyword">if</span> data<span class="token punctuation">.</span>BlackChess<span class="token punctuation">.</span>uin <span class="token operator">~=</span> uin <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>

        <span class="token keyword">local</span> maxNum <span class="token operator">=</span> <span class="token number">26</span><span class="token punctuation">;</span>
        <span class="token keyword">local</span> index <span class="token operator">=</span> data<span class="token punctuation">.</span>CurStartModeIndex<span class="token punctuation">;</span>

        index <span class="token operator">=</span> index <span class="token operator">+</span><span class="token number">1</span>
        <span class="token keyword">if</span> index <span class="token operator">&gt;</span> maxNum <span class="token keyword">then</span> index <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">end</span>

        GobangData<span class="token punctuation">.</span><span class="token function">SetCurStartModeIndex</span><span class="token punctuation">(</span>roomId<span class="token punctuation">,</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">--Api.Player:notifyGameInfo2Self(uin,&quot;&quot;)</span>
        Api<span class="token punctuation">.</span>Chat<span class="token punctuation">.</span><span class="token function">sendSystemMsg</span><span class="token punctuation">(</span><span class="token string">&quot;Room &quot;</span><span class="token operator">..</span>roomId<span class="token operator">..</span><span class="token string">&quot;：Game starts, Black start &quot;</span><span class="token punctuation">)</span>

    <span class="token keyword">end</span><span class="token punctuation">,</span>


    StartGameMode <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>roomId<span class="token punctuation">,</span>uin<span class="token punctuation">)</span>
        <span class="token keyword">if</span> roomId <span class="token operator">==</span>  <span class="token keyword">nil</span> <span class="token keyword">or</span>  uin <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>
        <span class="token keyword">if</span> GobangData<span class="token punctuation">.</span>IsDesignatedStart <span class="token operator">==</span> <span class="token keyword">false</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>
        <span class="token keyword">local</span> data <span class="token operator">=</span> GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">;</span>


        <span class="token keyword">if</span> data<span class="token punctuation">.</span>IsStartModeFinish <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>
        <span class="token keyword">if</span> data<span class="token punctuation">.</span>BlackChess<span class="token punctuation">.</span>uin <span class="token operator">~=</span> uin <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>

        GobangData<span class="token punctuation">.</span><span class="token function">SetStartMode</span><span class="token punctuation">(</span>roomId<span class="token punctuation">,</span><span class="token keyword">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        Api<span class="token punctuation">.</span>Player<span class="token punctuation">:</span><span class="token function">notifyGameInfo2Self</span><span class="token punctuation">(</span>uin<span class="token punctuation">,</span><span class="token string">&quot;Black selecte the opening mode &quot;</span><span class="token punctuation">)</span>


    <span class="token keyword">end</span><span class="token punctuation">,</span>


    Abstain <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>roomId<span class="token punctuation">,</span>uin<span class="token punctuation">)</span>
        <span class="token keyword">if</span> roomId <span class="token operator">==</span>  <span class="token keyword">nil</span> <span class="token keyword">or</span>  uin <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>
        <span class="token keyword">local</span> data <span class="token operator">=</span> GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> data<span class="token punctuation">.</span>IsBeginRound <span class="token operator">==</span> <span class="token keyword">false</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>data<span class="token punctuation">.</span>CurChessType <span class="token operator">==</span> Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>BlackChess <span class="token keyword">and</span> data<span class="token punctuation">.</span>BlackChess<span class="token punctuation">.</span>uin <span class="token operator">~=</span> uin<span class="token punctuation">)</span> <span class="token keyword">or</span>
                <span class="token punctuation">(</span> data<span class="token punctuation">.</span>CurChessType <span class="token operator">==</span> Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>WhiteChess <span class="token keyword">and</span> data<span class="token punctuation">.</span>WhiteChess<span class="token punctuation">.</span>uin <span class="token operator">~=</span> uin<span class="token punctuation">)</span> <span class="token keyword">then</span>
            <span class="token keyword">return</span>
        <span class="token keyword">else</span>
            GobangData<span class="token punctuation">.</span><span class="token function">SetAbstain</span><span class="token punctuation">(</span>roomId<span class="token punctuation">,</span>uin<span class="token punctuation">)</span><span class="token punctuation">;</span>
            Api<span class="token punctuation">.</span>Player<span class="token punctuation">:</span><span class="token function">notifyGameInfo2Self</span><span class="token punctuation">(</span>uin<span class="token punctuation">,</span><span class="token string">&quot;Retire. Player alternates.  &quot;</span><span class="token punctuation">)</span>
            Api<span class="token punctuation">.</span>Chat<span class="token punctuation">.</span><span class="token function">sendSystemMsg</span><span class="token punctuation">(</span><span class="token string">&quot;Retire. Player alternates.&quot;</span><span class="token punctuation">)</span>
        <span class="token keyword">end</span>

    <span class="token keyword">end</span><span class="token punctuation">,</span>


    ChangeChessCamp <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>roomId<span class="token punctuation">,</span>uin<span class="token punctuation">)</span>
        <span class="token keyword">if</span> roomId <span class="token operator">==</span>  <span class="token keyword">nil</span> <span class="token keyword">or</span>  uin <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>
        <span class="token keyword">if</span> GobangData<span class="token punctuation">.</span>IsDesignatedStart <span class="token operator">==</span> <span class="token keyword">false</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>
        <span class="token keyword">local</span> data <span class="token operator">=</span> GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> data<span class="token punctuation">.</span>IsBeginRound <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>
        <span class="token keyword">if</span> data<span class="token punctuation">.</span>WhiteChess<span class="token punctuation">.</span>uin <span class="token operator">~=</span> uin <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>

        Api<span class="token punctuation">.</span>Chat<span class="token punctuation">:</span><span class="token function">sendSystemMsg</span><span class="token punctuation">(</span><span class="token string">&quot;Alternate &quot;</span><span class="token punctuation">,</span>roomId<span class="token punctuation">,</span><span class="token string">&quot;: You are white&quot;</span><span class="token punctuation">)</span>
        TimerManager<span class="token punctuation">.</span><span class="token function">CreateCountdownTimer</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span>uin<span class="token punctuation">,</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span>
            GobangData<span class="token punctuation">.</span><span class="token function">ChangeCamp</span><span class="token punctuation">(</span>roomId<span class="token punctuation">)</span>
        <span class="token keyword">end</span><span class="token punctuation">)</span>

    <span class="token keyword">end</span><span class="token punctuation">,</span>


    StartRound <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>roomId<span class="token punctuation">,</span>uin<span class="token punctuation">)</span>
        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;White starts the round switch trigger &quot;</span><span class="token punctuation">)</span>

        <span class="token keyword">if</span> roomId <span class="token operator">==</span>  <span class="token keyword">nil</span> <span class="token keyword">or</span>  uin <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>
        <span class="token keyword">local</span> data <span class="token operator">=</span> GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> data<span class="token punctuation">.</span>IsBeginRound <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>
        <span class="token keyword">if</span> data<span class="token punctuation">.</span>WhiteChess<span class="token punctuation">.</span>uin <span class="token operator">~=</span> uin <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>

        GobangData<span class="token punctuation">.</span><span class="token function">SetBeginRound</span><span class="token punctuation">(</span>roomId<span class="token punctuation">,</span><span class="token keyword">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        Api<span class="token punctuation">.</span>Player<span class="token punctuation">:</span><span class="token function">notifyGameInfo2Self</span><span class="token punctuation">(</span>uin<span class="token punctuation">,</span><span class="token string">&quot;First start game round &quot;</span><span class="token punctuation">)</span>

    <span class="token keyword">end</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>


SettingRule <span class="token operator">=</span> <span class="token punctuation">{</span>


    ChangePlayerPos <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>roomId<span class="token punctuation">)</span>

        <span class="token keyword">if</span> roomId <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>

        <span class="token function">print</span><span class="token punctuation">(</span>GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>IsStartModeFinish<span class="token punctuation">)</span>
        <span class="token keyword">if</span> GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>IsBegin <span class="token operator">==</span> <span class="token keyword">false</span> <span class="token keyword">or</span> GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>IsStartModeFinish <span class="token operator">==</span> <span class="token keyword">false</span> <span class="token keyword">or</span>
                GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>IsBeginRound <span class="token operator">==</span> <span class="token keyword">true</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>

        <span class="token keyword">local</span> initPos <span class="token operator">=</span> Config<span class="token punctuation">.</span>InitPlayerPos<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token function">print</span><span class="token punctuation">(</span>initPos<span class="token punctuation">)</span>

        <span class="token keyword">if</span> GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>BlackChess<span class="token punctuation">.</span>uin <span class="token operator">~=</span> <span class="token keyword">nil</span> <span class="token keyword">then</span>
            Api<span class="token punctuation">.</span>Player<span class="token punctuation">:</span><span class="token function">setPosition</span><span class="token punctuation">(</span>GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>BlackChess<span class="token punctuation">.</span>uin<span class="token punctuation">,</span>initPos<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>x<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>initPos<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>y<span class="token punctuation">,</span>initPos<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>z<span class="token punctuation">)</span>
            Api<span class="token punctuation">.</span>Player<span class="token punctuation">:</span><span class="token function">notifyGameInfo2Self</span><span class="token punctuation">(</span>GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>BlackChess<span class="token punctuation">.</span>uin<span class="token punctuation">,</span><span class="token string">&quot;Alternate: You are black &quot;</span><span class="token punctuation">)</span>
        <span class="token keyword">end</span>

        <span class="token keyword">if</span> GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>WhiteChess<span class="token punctuation">.</span>uin <span class="token operator">~=</span> <span class="token keyword">nil</span> <span class="token keyword">then</span>
           Api<span class="token punctuation">.</span>Player<span class="token punctuation">:</span><span class="token function">setPosition</span><span class="token punctuation">(</span>GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>WhiteChess<span class="token punctuation">.</span>uin<span class="token punctuation">,</span>initPos<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>x<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>initPos<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>y<span class="token punctuation">,</span>initPos<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>z<span class="token punctuation">)</span>
            Api<span class="token punctuation">.</span>Player<span class="token punctuation">:</span><span class="token function">notifyGameInfo2Self</span><span class="token punctuation">(</span>GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>WhiteChess<span class="token punctuation">.</span>uin<span class="token punctuation">,</span><span class="token string">&quot;Alternate: You are white &quot;</span><span class="token punctuation">)</span>
        <span class="token keyword">end</span>

        GobangData<span class="token punctuation">.</span><span class="token function">SetBeginRound</span><span class="token punctuation">(</span>roomId<span class="token punctuation">,</span><span class="token keyword">true</span><span class="token punctuation">)</span>



    <span class="token keyword">end</span><span class="token punctuation">,</span>


    SetPlayerPos <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>roomId<span class="token punctuation">)</span>
        <span class="token keyword">if</span> roomId <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>

        <span class="token keyword">local</span> initPos <span class="token operator">=</span> Config<span class="token punctuation">.</span>InitPlayerPos<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>BlackChess<span class="token punctuation">.</span>uin <span class="token operator">~=</span> <span class="token keyword">nil</span>  <span class="token keyword">then</span>
            <span class="token comment">--Api.Player:setPosition(GobangData[roomId].BlackChess.uin,initPos[1].x,initPos[1].y,initPos[1].z)</span>
        <span class="token keyword">end</span>

        <span class="token keyword">if</span> GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>WhiteChess<span class="token punctuation">.</span>uin <span class="token operator">~=</span> <span class="token keyword">nil</span> <span class="token keyword">then</span>
            <span class="token comment">--Api.Player:setPosition(GobangData[roomId].WhiteChess.uin,initPos[2].x,initPos[2].y,initPos[2].z)</span>
        <span class="token keyword">end</span>

        <span class="token keyword">if</span> GobangData<span class="token punctuation">.</span>IsDesignatedStart <span class="token keyword">then</span>
            Api<span class="token punctuation">.</span>Chat<span class="token punctuation">:</span><span class="token function">sendSystemMsg</span><span class="token punctuation">(</span><span class="token string">&quot;Game starts, Black start &quot;</span><span class="token punctuation">)</span>
        <span class="token keyword">else</span>
            Api<span class="token punctuation">.</span>Chat<span class="token punctuation">:</span><span class="token function">sendSystemMsg</span><span class="token punctuation">(</span><span class="token string">&quot;Game starts. Black goes first &quot;</span><span class="token punctuation">)</span>
        <span class="token keyword">end</span>

    <span class="token keyword">end</span><span class="token punctuation">,</span>


    ChangeStartThreeChessPos <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>roomId<span class="token punctuation">)</span>
        <span class="token keyword">if</span> roomId <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">or</span> GobangData <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">or</span> GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>
        <span class="token keyword">if</span> GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>IsBegin <span class="token operator">==</span> <span class="token keyword">false</span> <span class="token keyword">or</span> GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>IsStartModeFinish <span class="token operator">==</span> <span class="token keyword">true</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>

        <span class="token keyword">local</span> data <span class="token operator">=</span> GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span>
        <span class="token keyword">local</span> checkerboardCenterPos<span class="token punctuation">;</span>
        <span class="token keyword">local</span> lastRelativePos
        <span class="token keyword">local</span> curRelativePos
        <span class="token keyword">local</span> lastIndex

        checkerboardCenterPos <span class="token operator">=</span> Config<span class="token punctuation">.</span>CheckerboardCenterPos<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span>
        curRelativePos <span class="token operator">=</span> Config<span class="token punctuation">.</span>ThreeChessRelativePos<span class="token punctuation">[</span>data<span class="token punctuation">.</span>CurStartModeIndex<span class="token punctuation">]</span>
        lastIndex <span class="token operator">=</span> data<span class="token punctuation">.</span>CurStartModeIndex <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> lastIndex <span class="token operator">&lt;</span><span class="token number">1</span> <span class="token keyword">then</span> lastIndex <span class="token operator">=</span> <span class="token number">26</span> <span class="token keyword">end</span>
        lastRelativePos <span class="token operator">=</span> Config<span class="token punctuation">.</span>ThreeChessRelativePos<span class="token punctuation">[</span>lastIndex<span class="token punctuation">]</span><span class="token punctuation">;</span>


        <span class="token keyword">for</span> k<span class="token punctuation">,</span>v <span class="token keyword">in</span> <span class="token function">pairs</span><span class="token punctuation">(</span>lastRelativePos<span class="token punctuation">)</span> <span class="token keyword">do</span>
            <span class="token keyword">local</span> x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>z
            x <span class="token operator">=</span> v<span class="token punctuation">.</span>x <span class="token operator">+</span>checkerboardCenterPos<span class="token punctuation">.</span>x
            y <span class="token operator">=</span> v<span class="token punctuation">.</span>y <span class="token operator">+</span>checkerboardCenterPos<span class="token punctuation">.</span>y
            z <span class="token operator">=</span> v<span class="token punctuation">.</span>z <span class="token operator">+</span>checkerboardCenterPos<span class="token punctuation">.</span>z
            Api<span class="token punctuation">.</span>Block<span class="token punctuation">:</span><span class="token function">destroyBlock</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>z<span class="token punctuation">,</span><span class="token keyword">false</span><span class="token punctuation">)</span>
        <span class="token keyword">end</span>


        <span class="token keyword">for</span> k<span class="token punctuation">,</span>v <span class="token keyword">in</span> <span class="token function">pairs</span><span class="token punctuation">(</span>curRelativePos<span class="token punctuation">)</span> <span class="token keyword">do</span>
            <span class="token keyword">local</span> x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>z
            <span class="token keyword">local</span> blockid

            x <span class="token operator">=</span> v<span class="token punctuation">.</span>x <span class="token operator">+</span>checkerboardCenterPos<span class="token punctuation">.</span>x
            y <span class="token operator">=</span> v<span class="token punctuation">.</span>y <span class="token operator">+</span>checkerboardCenterPos<span class="token punctuation">.</span>y
            z <span class="token operator">=</span> v<span class="token punctuation">.</span>z <span class="token operator">+</span>checkerboardCenterPos<span class="token punctuation">.</span>z
            blockid <span class="token operator">=</span> Config<span class="token punctuation">.</span>BlockIdEnum<span class="token punctuation">[</span>v<span class="token punctuation">.</span>type<span class="token punctuation">]</span>

            Api<span class="token punctuation">.</span>Block<span class="token punctuation">:</span><span class="token function">placeBlock</span><span class="token punctuation">(</span>blockid<span class="token punctuation">,</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>z<span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span>
        <span class="token keyword">end</span>

    <span class="token keyword">end</span><span class="token punctuation">,</span>


    SetDefaultThreeChess <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>roomId<span class="token punctuation">)</span>
        <span class="token keyword">if</span> roomId <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">or</span> GobangData <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">or</span> GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>
        <span class="token keyword">if</span> GobangData<span class="token punctuation">.</span>IsDesignatedStart <span class="token operator">==</span> <span class="token keyword">false</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>
        <span class="token keyword">if</span> GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>IsBegin <span class="token operator">==</span> <span class="token keyword">false</span> <span class="token keyword">or</span> GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>IsStartModeFinish <span class="token operator">==</span> <span class="token keyword">true</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>

        <span class="token keyword">local</span> data <span class="token operator">=</span> GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span>
        <span class="token keyword">local</span> checkerboardCenterPos<span class="token punctuation">;</span>
        <span class="token keyword">local</span> curRelativePos

        checkerboardCenterPos <span class="token operator">=</span> Config<span class="token punctuation">.</span>CheckerboardCenterPos<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span>
        curRelativePos <span class="token operator">=</span> Config<span class="token punctuation">.</span>ThreeChessRelativePos<span class="token punctuation">[</span>data<span class="token punctuation">.</span>CurStartModeIndex<span class="token punctuation">]</span>


        <span class="token keyword">for</span> k<span class="token punctuation">,</span>v <span class="token keyword">in</span> <span class="token function">pairs</span><span class="token punctuation">(</span>curRelativePos<span class="token punctuation">)</span> <span class="token keyword">do</span>
        <span class="token keyword">local</span> x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>z
        <span class="token keyword">local</span> blockid

        x <span class="token operator">=</span> v<span class="token punctuation">.</span>x <span class="token operator">+</span>checkerboardCenterPos<span class="token punctuation">.</span>x
        y <span class="token operator">=</span> v<span class="token punctuation">.</span>y <span class="token operator">+</span>checkerboardCenterPos<span class="token punctuation">.</span>y
        z <span class="token operator">=</span> v<span class="token punctuation">.</span>z <span class="token operator">+</span>checkerboardCenterPos<span class="token punctuation">.</span>z
        blockid <span class="token operator">=</span> Config<span class="token punctuation">.</span>BlockIdEnum<span class="token punctuation">[</span>v<span class="token punctuation">.</span>type<span class="token punctuation">]</span>

        Api<span class="token punctuation">.</span>Block<span class="token punctuation">:</span><span class="token function">placeBlock</span><span class="token punctuation">(</span>blockid<span class="token punctuation">,</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>z<span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span>
        <span class="token keyword">end</span>

    <span class="token keyword">end</span><span class="token punctuation">,</span>


    GainItemChessToPlayer <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>roomId<span class="token punctuation">)</span>
        <span class="token keyword">if</span> roomId <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>

        <span class="token keyword">local</span> data <span class="token operator">=</span> GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span>

        <span class="token keyword">if</span> data<span class="token punctuation">.</span>BlackChess<span class="token punctuation">.</span>uin <span class="token operator">~=</span> <span class="token keyword">nil</span> <span class="token keyword">then</span>
            Api<span class="token punctuation">.</span>Player<span class="token punctuation">:</span><span class="token function">gainItems</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>BlackChess<span class="token punctuation">.</span>uin<span class="token punctuation">,</span>Config<span class="token punctuation">.</span>BlockIdEnum<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">300</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
        <span class="token keyword">end</span>

        <span class="token keyword">if</span> data<span class="token punctuation">.</span>WhiteChess<span class="token punctuation">.</span>uin <span class="token operator">~=</span> <span class="token keyword">nil</span> <span class="token keyword">then</span>
            Api<span class="token punctuation">.</span>Player<span class="token punctuation">:</span><span class="token function">gainItems</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>WhiteChess<span class="token punctuation">.</span>uin<span class="token punctuation">,</span>Config<span class="token punctuation">.</span>BlockIdEnum<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">300</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
        <span class="token keyword">end</span>

    <span class="token keyword">end</span><span class="token punctuation">,</span>


    GetChessPlaceIsRight <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>roomId<span class="token punctuation">,</span>uin<span class="token punctuation">,</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>z<span class="token punctuation">,</span>blockid<span class="token punctuation">)</span>
        <span class="token keyword">if</span> uin <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">or</span> x <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">or</span> y <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">or</span> blockid <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">false</span> <span class="token keyword">end</span>


        <span class="token function">print</span><span class="token punctuation">(</span>GobangMgr<span class="token punctuation">.</span><span class="token function">JudgeChessInChessboard</span><span class="token punctuation">(</span>roomId<span class="token punctuation">,</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>z<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> GobangMgr<span class="token punctuation">.</span><span class="token function">JudgeChessInChessboard</span><span class="token punctuation">(</span>roomId<span class="token punctuation">,</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>z<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">false</span> <span class="token keyword">then</span>
            Api<span class="token punctuation">.</span>Block<span class="token punctuation">:</span><span class="token function">destroyBlock</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>z<span class="token punctuation">,</span><span class="token keyword">false</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> <span class="token keyword">false</span>
        <span class="token keyword">end</span>


        <span class="token keyword">if</span> Config<span class="token punctuation">.</span>BlockIdEnum<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">~=</span> blockid <span class="token keyword">and</span> Config<span class="token punctuation">.</span>BlockIdEnum<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">~=</span> blockid <span class="token keyword">then</span>
            Api<span class="token punctuation">.</span>Block<span class="token punctuation">:</span><span class="token function">destroyBlock</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>z<span class="token punctuation">,</span><span class="token keyword">false</span><span class="token punctuation">)</span>
        <span class="token keyword">end</span>



        <span class="token keyword">if</span> <span class="token punctuation">(</span>GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>IsWin <span class="token keyword">and</span> GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>CurChessType <span class="token operator">~=</span> GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>AIChess <span class="token punctuation">)</span>
                <span class="token keyword">or</span> GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>IsBegin <span class="token operator">==</span> <span class="token keyword">false</span> <span class="token keyword">then</span>
            Api<span class="token punctuation">.</span>Block<span class="token punctuation">:</span><span class="token function">destroyBlock</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>z<span class="token punctuation">,</span><span class="token keyword">false</span><span class="token punctuation">)</span>
        <span class="token keyword">end</span>


        <span class="token keyword">if</span> GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>CurChessType <span class="token operator">==</span> Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>None <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>
        <span class="token keyword">if</span> GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>IsAI <span class="token keyword">then</span>

        <span class="token keyword">else</span>
            <span class="token keyword">if</span> GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>BlackChess<span class="token punctuation">.</span>uin <span class="token operator">~=</span> uin <span class="token keyword">and</span>
                    GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>WhiteChess<span class="token punctuation">.</span>uin <span class="token operator">~=</span> uin <span class="token keyword">then</span>

                Api<span class="token punctuation">.</span>Block<span class="token punctuation">:</span><span class="token function">destroyBlock</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>z<span class="token punctuation">,</span><span class="token keyword">false</span><span class="token punctuation">)</span>
                <span class="token keyword">return</span>
            <span class="token keyword">end</span>
        <span class="token keyword">end</span>




        <span class="token keyword">local</span> data <span class="token operator">=</span> GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span>
        <span class="token keyword">if</span> data <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">false</span> <span class="token keyword">end</span>
        <span class="token function">print</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>

        <span class="token keyword">if</span> data<span class="token punctuation">.</span>CurChessType <span class="token operator">==</span> Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>BlackChess <span class="token keyword">and</span> Config<span class="token punctuation">.</span>BlockIdEnum<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">~=</span> blockid <span class="token keyword">then</span>

            Api<span class="token punctuation">.</span>Block<span class="token punctuation">:</span><span class="token function">destroyBlock</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>z<span class="token punctuation">,</span><span class="token keyword">false</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> <span class="token keyword">false</span>
        <span class="token keyword">elseif</span> data<span class="token punctuation">.</span>CurChessType <span class="token operator">==</span> Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>WhiteChess <span class="token keyword">and</span> Config<span class="token punctuation">.</span>BlockIdEnum<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">~=</span> blockid <span class="token keyword">then</span>

            Api<span class="token punctuation">.</span>Block<span class="token punctuation">:</span><span class="token function">destroyBlock</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>z<span class="token punctuation">,</span><span class="token keyword">false</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> <span class="token keyword">false</span>
        <span class="token keyword">elseif</span> data<span class="token punctuation">.</span>CurChessType <span class="token operator">==</span> Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>None <span class="token keyword">then</span>

            Api<span class="token punctuation">.</span>Block<span class="token punctuation">:</span><span class="token function">destroyBlock</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>z<span class="token punctuation">,</span><span class="token keyword">false</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> <span class="token keyword">false</span>
        <span class="token keyword">end</span>

        <span class="token keyword">return</span> <span class="token keyword">true</span>

    <span class="token keyword">end</span><span class="token punctuation">,</span>


    GetRoomIdByUin <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>uin<span class="token punctuation">)</span>
        <span class="token keyword">if</span> uin <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>

        <span class="token keyword">local</span> roomNum  <span class="token operator">=</span> <span class="token number">4</span>

        <span class="token keyword">for</span> i <span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> roomNum <span class="token keyword">do</span>
            <span class="token keyword">local</span> data <span class="token operator">=</span> GobangData<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
            <span class="token keyword">if</span> data <span class="token operator">~=</span> <span class="token keyword">nil</span> <span class="token keyword">then</span>
                <span class="token keyword">if</span> data<span class="token punctuation">.</span>BlackChess<span class="token punctuation">.</span>uin <span class="token operator">==</span> uin <span class="token keyword">then</span>
                    <span class="token keyword">return</span> i
                <span class="token keyword">end</span>

                <span class="token keyword">if</span> data<span class="token punctuation">.</span>WhiteChess<span class="token punctuation">.</span>uin <span class="token operator">==</span> uin <span class="token keyword">then</span>
                    <span class="token keyword">return</span> i
                <span class="token keyword">end</span>
            <span class="token keyword">end</span>

        <span class="token keyword">end</span>

        <span class="token keyword">return</span> <span class="token keyword">nil</span>

    <span class="token keyword">end</span><span class="token punctuation">,</span>


    SetTipLightState <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>roomId<span class="token punctuation">,</span>chessType<span class="token punctuation">,</span>state<span class="token punctuation">)</span>
        <span class="token keyword">if</span> roomId <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">or</span> chessType <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">or</span> state <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>


        <span class="token keyword">local</span> blockid
        <span class="token keyword">local</span> posTable <span class="token operator">=</span> Config<span class="token punctuation">.</span>TipLightPos<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span>
        <span class="token keyword">local</span> pos <span class="token operator">=</span> posTable<span class="token punctuation">[</span>chessType<span class="token punctuation">]</span>

        <span class="token keyword">if</span> state  <span class="token keyword">then</span>
            blockid <span class="token operator">=</span> Config<span class="token punctuation">.</span>TipLightBlockIdEnum<span class="token punctuation">.</span>Registered
        <span class="token keyword">else</span>
            blockid <span class="token operator">=</span> Config<span class="token punctuation">.</span>TipLightBlockIdEnum<span class="token punctuation">.</span>Unregistered
        <span class="token keyword">end</span>


        <span class="token keyword">if</span> blockid  <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">or</span> pos <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>
        Api<span class="token punctuation">.</span>Block<span class="token punctuation">:</span><span class="token function">setBlockAll</span><span class="token punctuation">(</span>pos<span class="token punctuation">.</span>x<span class="token punctuation">,</span> pos<span class="token punctuation">.</span>y<span class="token punctuation">,</span> pos<span class="token punctuation">.</span>z<span class="token punctuation">,</span> blockid<span class="token punctuation">)</span>

    <span class="token keyword">end</span><span class="token punctuation">,</span>


    SetRuleTipLightSate <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span>
        <span class="token keyword">if</span> state <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>

        <span class="token keyword">local</span> blockid
        <span class="token keyword">local</span> pos <span class="token operator">=</span> Config<span class="token punctuation">.</span>RuleTipLightPos<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>

        <span class="token keyword">if</span> state  <span class="token keyword">then</span>
            blockid <span class="token operator">=</span> Config<span class="token punctuation">.</span>TipLightBlockIdEnum<span class="token punctuation">.</span>Registered
        <span class="token keyword">else</span>
            blockid <span class="token operator">=</span> Config<span class="token punctuation">.</span>TipLightBlockIdEnum<span class="token punctuation">.</span>Unregistered
        <span class="token keyword">end</span>

        <span class="token keyword">if</span> blockid  <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">or</span> pos <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>
        Api<span class="token punctuation">.</span>Block<span class="token punctuation">:</span><span class="token function">setBlockAll</span><span class="token punctuation">(</span>pos<span class="token punctuation">.</span>x<span class="token punctuation">,</span> pos<span class="token punctuation">.</span>y<span class="token punctuation">,</span> pos<span class="token punctuation">.</span>z<span class="token punctuation">,</span> blockid<span class="token punctuation">)</span>

    <span class="token keyword">end</span><span class="token punctuation">,</span>


    ChangeCurPlaceChessType <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>roomId<span class="token punctuation">)</span>
        <span class="token keyword">if</span> roomId <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>
        <span class="token keyword">local</span> curChessType <span class="token operator">=</span> GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>CurChessType

        <span class="token keyword">if</span> curChessType <span class="token operator">==</span> Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>BlackChess <span class="token keyword">then</span>
            GobangData<span class="token punctuation">.</span><span class="token function">SetCurChess</span><span class="token punctuation">(</span>roomId<span class="token punctuation">,</span>Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>WhiteChess<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">elseif</span> curChessType <span class="token operator">==</span> Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>WhiteChess <span class="token keyword">then</span>
            GobangData<span class="token punctuation">.</span><span class="token function">SetCurChess</span><span class="token punctuation">(</span>roomId<span class="token punctuation">,</span>Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>BlackChess<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">end</span>
        SettingRule<span class="token punctuation">.</span><span class="token function">RoundTimeLimited</span><span class="token punctuation">(</span>roomId<span class="token punctuation">)</span>
        Api<span class="token punctuation">.</span>Chat<span class="token punctuation">.</span><span class="token function">sendSystemMsg</span><span class="token punctuation">(</span><span class="token string">&quot;Countdown ends. Player alternates. &quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">end</span><span class="token punctuation">,</span>


    RoundTimeLimited <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>roomId<span class="token punctuation">)</span>

        <span class="token keyword">if</span> GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>IsAI <span class="token keyword">and</span> GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>AIChess <span class="token operator">==</span> GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>CurChessType <span class="token keyword">then</span>
            <span class="token keyword">return</span>
        <span class="token keyword">elseif</span> GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>CurChessType <span class="token operator">~=</span> Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>None <span class="token keyword">then</span>
            <span class="token keyword">local</span> uins <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
            <span class="token keyword">if</span> GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>BlackChess<span class="token punctuation">.</span>uin <span class="token operator">~=</span> <span class="token keyword">nil</span> <span class="token keyword">then</span>
                table<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>uins<span class="token punctuation">,</span>GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>BlackChess<span class="token punctuation">.</span>uin<span class="token punctuation">)</span>
            <span class="token keyword">end</span>
            <span class="token keyword">if</span> GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>WhiteChess<span class="token punctuation">.</span>uin <span class="token operator">~=</span> <span class="token keyword">nil</span> <span class="token keyword">then</span>
                table<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>uins<span class="token punctuation">,</span>GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>WhiteChess<span class="token punctuation">.</span>uin<span class="token punctuation">)</span>
            <span class="token keyword">end</span>

            TimerManager<span class="token punctuation">.</span><span class="token function">StartRoundTimer</span><span class="token punctuation">(</span>roomId<span class="token punctuation">,</span>uins<span class="token punctuation">,</span><span class="token number">60</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token keyword">if</span> GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>IsBeginRound <span class="token operator">==</span> <span class="token keyword">false</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>
                <span class="token keyword">for</span> k1<span class="token punctuation">,</span>v1 <span class="token keyword">in</span> <span class="token function">pairs</span><span class="token punctuation">(</span>uins<span class="token punctuation">)</span> <span class="token keyword">do</span>
                    Api<span class="token punctuation">.</span>Player<span class="token punctuation">:</span><span class="token function">notifyGameInfo2Self</span><span class="token punctuation">(</span>v1<span class="token punctuation">,</span><span class="token string">&quot;Countdown ends. Player alternates. &quot;</span><span class="token punctuation">)</span>
                <span class="token keyword">end</span>
                SettingRule<span class="token punctuation">.</span><span class="token function">ChangeCurPlaceChessType</span><span class="token punctuation">(</span>roomId<span class="token punctuation">)</span>
            <span class="token keyword">end</span><span class="token punctuation">)</span>
        <span class="token keyword">end</span>
    <span class="token keyword">end</span><span class="token punctuation">,</span>

    PlayerAreaIn <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>areaid<span class="token punctuation">,</span>uin<span class="token punctuation">)</span>
        <span class="token keyword">if</span> areaid <span class="token operator">==</span><span class="token keyword">nil</span> <span class="token keyword">or</span> uin <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>

        <span class="token keyword">for</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">4</span> <span class="token keyword">do</span>
            <span class="token keyword">if</span> GobangData<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>AreaId <span class="token operator">==</span> areaid <span class="token keyword">then</span>
                <span class="token keyword">if</span> GobangData<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>IsBegin <span class="token operator">==</span> <span class="token keyword">false</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>
                <span class="token keyword">local</span> isCurChess <span class="token operator">=</span> <span class="token keyword">false</span>
                <span class="token keyword">if</span> GobangData<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>BlackChess<span class="token punctuation">.</span>uin <span class="token operator">~=</span> <span class="token keyword">nil</span> <span class="token keyword">and</span> GobangData<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>BlackChess<span class="token punctuation">.</span>uin <span class="token operator">==</span> uin <span class="token keyword">then</span>
                    isCurChess <span class="token operator">=</span> <span class="token keyword">true</span>
                <span class="token keyword">end</span>

                <span class="token keyword">if</span> GobangData<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>BlackChess<span class="token punctuation">.</span>uin <span class="token operator">~=</span> <span class="token keyword">nil</span> <span class="token keyword">and</span> GobangData<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>BlackChess<span class="token punctuation">.</span>uin <span class="token operator">==</span> uin <span class="token keyword">then</span>
                    isCurChess <span class="token operator">=</span> <span class="token keyword">true</span>
                <span class="token keyword">end</span>

                <span class="token keyword">if</span> isCurChess <span class="token operator">==</span> <span class="token keyword">false</span> <span class="token keyword">then</span>
                    Api<span class="token punctuation">.</span>Actor<span class="token punctuation">:</span><span class="token function">addBuff</span><span class="token punctuation">(</span>uin<span class="token punctuation">,</span><span class="token number">1008</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">50000000</span><span class="token punctuation">)</span>
                    <span class="token keyword">return</span>
                <span class="token keyword">end</span>
            <span class="token keyword">end</span>
        <span class="token keyword">end</span>

    <span class="token keyword">end</span><span class="token punctuation">,</span>

    PlayerAreaOut <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>areaid<span class="token punctuation">,</span>uin<span class="token punctuation">)</span>
        <span class="token keyword">if</span> areaid <span class="token operator">==</span><span class="token keyword">nil</span> <span class="token keyword">or</span> uin <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>
        Api<span class="token punctuation">.</span>Actor<span class="token punctuation">:</span><span class="token function">removeBuff</span><span class="token punctuation">(</span>uin<span class="token punctuation">,</span><span class="token number">1008</span><span class="token punctuation">)</span>
    <span class="token keyword">end</span><span class="token punctuation">,</span>


    PlayerInSelfChess <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>roomId<span class="token punctuation">)</span>
        <span class="token keyword">if</span> roomId <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>

        <span class="token keyword">local</span> data  <span class="token operator">=</span> GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span>
        <span class="token keyword">if</span> data <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">or</span> data<span class="token punctuation">.</span>IsBegin <span class="token operator">==</span> <span class="token keyword">false</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>


        <span class="token keyword">local</span> ret<span class="token punctuation">,</span>playerList <span class="token operator">=</span> Api<span class="token punctuation">.</span>Area<span class="token punctuation">:</span><span class="token function">getAreaPlayers</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>AreaId<span class="token punctuation">)</span>
        <span class="token keyword">if</span> ret <span class="token operator">==</span> ErrorCode<span class="token punctuation">.</span>OK <span class="token keyword">then</span>
            <span class="token keyword">for</span> k<span class="token punctuation">,</span>v <span class="token keyword">in</span> <span class="token function">pairs</span><span class="token punctuation">(</span>playerList<span class="token punctuation">)</span> <span class="token keyword">do</span>
                <span class="token keyword">local</span> isCurChessPlayer <span class="token operator">=</span> <span class="token keyword">false</span>
                <span class="token keyword">if</span> data<span class="token punctuation">.</span>BlackChess<span class="token punctuation">.</span>uin <span class="token operator">~=</span> <span class="token keyword">nil</span> <span class="token keyword">and</span> data<span class="token punctuation">.</span>BlackChess<span class="token punctuation">.</span>uin <span class="token operator">==</span> v <span class="token keyword">then</span>
                    isCurChessPlayer <span class="token operator">=</span> <span class="token keyword">true</span>
                <span class="token keyword">end</span>

                <span class="token keyword">if</span> data<span class="token punctuation">.</span>WhiteChess<span class="token punctuation">.</span>uin <span class="token operator">~=</span> <span class="token keyword">nil</span> <span class="token keyword">and</span> data<span class="token punctuation">.</span>WhiteChess<span class="token punctuation">.</span>uin <span class="token operator">==</span> v <span class="token keyword">then</span>
                    isCurChessPlayer <span class="token operator">=</span> <span class="token keyword">true</span>
                <span class="token keyword">end</span>

                <span class="token keyword">if</span> isCurChessPlayer <span class="token operator">==</span> <span class="token keyword">false</span> <span class="token keyword">then</span>
                    Api<span class="token punctuation">.</span>Actor<span class="token punctuation">:</span><span class="token function">addBuff</span><span class="token punctuation">(</span>v<span class="token punctuation">,</span><span class="token number">1008</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">50000000</span><span class="token punctuation">)</span>
                <span class="token keyword">end</span>
            <span class="token keyword">end</span>
        <span class="token keyword">end</span>
    <span class="token keyword">end</span><span class="token punctuation">,</span>

    ClearAreaPlayerBuff <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>roomId<span class="token punctuation">)</span>
        <span class="token keyword">if</span> roomId <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>
        <span class="token keyword">local</span> data  <span class="token operator">=</span> GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span>
        <span class="token keyword">if</span> data <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">or</span> data<span class="token punctuation">.</span>IsWin <span class="token operator">==</span> <span class="token keyword">false</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>

        <span class="token keyword">local</span> ret<span class="token punctuation">,</span>playerList <span class="token operator">=</span> Api<span class="token punctuation">.</span>Area<span class="token punctuation">:</span><span class="token function">getAreaPlayers</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>AreaId<span class="token punctuation">)</span>

        <span class="token keyword">if</span> ret <span class="token operator">==</span> ErrorCode<span class="token punctuation">.</span>OK <span class="token keyword">then</span>
            <span class="token keyword">for</span> k<span class="token punctuation">,</span>v <span class="token keyword">in</span> <span class="token function">pairs</span><span class="token punctuation">(</span>playerList<span class="token punctuation">)</span> <span class="token keyword">do</span>
                Api<span class="token punctuation">.</span>Actor<span class="token punctuation">:</span><span class="token function">removeBuff</span><span class="token punctuation">(</span>v<span class="token punctuation">,</span><span class="token number">1008</span><span class="token punctuation">)</span>
            <span class="token keyword">end</span>
        <span class="token keyword">end</span>
    <span class="token keyword">end</span><span class="token punctuation">,</span>

    AdmitDefeat <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>roomId<span class="token punctuation">,</span>uin<span class="token punctuation">)</span>
        <span class="token keyword">if</span> roomId <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">or</span> uin <span class="token operator">==</span>  <span class="token keyword">nil</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>
        <span class="token keyword">local</span> data <span class="token operator">=</span> GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span>
        <span class="token keyword">if</span> data <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>

        <span class="token keyword">local</span> isPlayerOp <span class="token operator">=</span> <span class="token keyword">false</span>
        <span class="token keyword">local</span> winChessType <span class="token operator">=</span> <span class="token keyword">nil</span>
        <span class="token keyword">local</span> text <span class="token operator">=</span> <span class="token string">&quot; &quot;</span>

        <span class="token keyword">if</span> data<span class="token punctuation">.</span>IsBegin <span class="token operator">==</span> <span class="token keyword">false</span> <span class="token keyword">or</span> data<span class="token punctuation">.</span>IsWin <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>

        <span class="token keyword">if</span> data<span class="token punctuation">.</span>BlackChess<span class="token punctuation">.</span>uin <span class="token operator">~=</span> <span class="token keyword">nil</span> <span class="token keyword">and</span> data<span class="token punctuation">.</span>BlackChess<span class="token punctuation">.</span>uin <span class="token operator">==</span> uin <span class="token keyword">then</span>
            isPlayerOp <span class="token operator">=</span> <span class="token keyword">true</span>
            winChessType <span class="token operator">=</span> Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>BlackChess
            text <span class="token operator">=</span> <span class="token string">&quot;Room &quot;</span><span class="token operator">..</span>roomId<span class="token operator">..</span><span class="token string">&quot;：Game ends. White wins. &quot;</span>
        <span class="token keyword">end</span>

        <span class="token keyword">if</span> data<span class="token punctuation">.</span>WhiteChess<span class="token punctuation">.</span>uin <span class="token operator">~=</span> <span class="token keyword">nil</span> <span class="token keyword">and</span> data<span class="token punctuation">.</span>WhiteChess<span class="token punctuation">.</span>uin <span class="token operator">==</span> uin <span class="token keyword">then</span>
            isPlayerOp <span class="token operator">=</span><span class="token keyword">true</span>
            winChessType <span class="token operator">=</span> Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>WhiteChess
            text <span class="token operator">=</span> <span class="token string">&quot;Room &quot;</span><span class="token operator">..</span>roomId<span class="token operator">..</span><span class="token string">&quot;：Game ends. Black wins. &quot;</span>
        <span class="token keyword">end</span>

        <span class="token keyword">if</span> isPlayerOp <span class="token operator">==</span> <span class="token keyword">false</span> <span class="token keyword">or</span> winChessType <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>

        GobangData<span class="token punctuation">.</span><span class="token function">SetWin</span><span class="token punctuation">(</span>roomId<span class="token punctuation">,</span><span class="token keyword">true</span><span class="token punctuation">,</span>winChessType<span class="token punctuation">)</span>
        Api<span class="token punctuation">.</span>Chat<span class="token punctuation">:</span><span class="token function">sendSystemMsg</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span>
        Api<span class="token punctuation">.</span>Player<span class="token punctuation">:</span><span class="token function">notifyGameInfo2Self</span><span class="token punctuation">(</span>uin<span class="token punctuation">,</span><span class="token string">&quot;You have retired from this competition and the game is over. &quot;</span><span class="token punctuation">)</span>


    <span class="token keyword">end</span><span class="token punctuation">,</span>

<span class="token punctuation">}</span>


AIGame <span class="token operator">=</span> <span class="token punctuation">{</span>
    AIData <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token punctuation">[</span>Config<span class="token punctuation">.</span>RoomType<span class="token punctuation">.</span>RoomOne<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
            successTypeCount <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>
            wins <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
            myWin <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
            computerWin <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
            chessBoard <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
            placedBlockPos <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
            isAIPlace <span class="token operator">=</span> <span class="token keyword">false</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span>Config<span class="token punctuation">.</span>RoomType<span class="token punctuation">.</span>RoomTwo<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
            successTypeCount <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>
            wins <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
            myWin <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
            computerWin <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
            chessBoard <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
            placedBlockPos <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
            isAIPlace <span class="token operator">=</span> <span class="token keyword">false</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span>Config<span class="token punctuation">.</span>RoomType<span class="token punctuation">.</span>RoomThree<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
            successTypeCount <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>
            wins <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
            myWin <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
            computerWin <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
            chessBoard <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
            placedBlockPos <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
            isAIPlace <span class="token operator">=</span> <span class="token keyword">false</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span>Config<span class="token punctuation">.</span>RoomType<span class="token punctuation">.</span>RoomFour<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
            successTypeCount <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>
            wins <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
            myWin <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
            computerWin <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
            chessBoard <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
            placedBlockPos <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
            isAIPlace <span class="token operator">=</span> <span class="token keyword">false</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    GetNormalizedCoord <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>roomId<span class="token punctuation">,</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>z<span class="token punctuation">)</span>
        <span class="token keyword">if</span> roomId <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>
        <span class="token keyword">if</span> x <span class="token operator">==</span><span class="token keyword">nil</span> <span class="token keyword">or</span> y <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">or</span> z <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>
        <span class="token keyword">if</span> <span class="token function">type</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">~=</span> <span class="token string">&quot;number&quot;</span> <span class="token keyword">or</span> <span class="token function">type</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span> <span class="token operator">~=</span> <span class="token string">&quot;number&quot;</span> <span class="token keyword">or</span> <span class="token function">type</span><span class="token punctuation">(</span>z<span class="token punctuation">)</span> <span class="token operator">~=</span> <span class="token string">&quot;number&quot;</span> <span class="token keyword">then</span>

            <span class="token keyword">return</span>
        <span class="token keyword">end</span>

        <span class="token keyword">local</span> normalizedX <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">local</span> normalizedZ <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

        <span class="token keyword">local</span> CheckerboardPos <span class="token operator">=</span> Config<span class="token punctuation">.</span>Checkerboard<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span>
        <span class="token keyword">if</span> CheckerboardPos <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>

        <span class="token keyword">if</span> CheckerboardPos<span class="token punctuation">.</span>beginPos <span class="token operator">==</span><span class="token keyword">nil</span> <span class="token keyword">or</span> CheckerboardPos<span class="token punctuation">.</span>endPos <span class="token operator">==</span> <span class="token keyword">nil</span>  <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>

        <span class="token keyword">if</span> GobangMgr<span class="token punctuation">.</span><span class="token function">JudgeChessInChessboard</span><span class="token punctuation">(</span>roomId<span class="token punctuation">,</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>z<span class="token punctuation">)</span> <span class="token operator">==</span><span class="token keyword">false</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>

        <span class="token keyword">if</span> CheckerboardPos<span class="token punctuation">.</span>beginPos<span class="token punctuation">.</span>x <span class="token operator">&lt;</span> CheckerboardPos<span class="token punctuation">.</span>endPos<span class="token punctuation">.</span>x <span class="token keyword">then</span>
            normalizedX <span class="token operator">=</span> x <span class="token operator">-</span> CheckerboardPos<span class="token punctuation">.</span>beginPos<span class="token punctuation">.</span>x <span class="token punctuation">;</span>
        <span class="token keyword">else</span>
            normalizedX <span class="token operator">=</span> x <span class="token operator">-</span> CheckerboardPos<span class="token punctuation">.</span>endPos<span class="token punctuation">.</span>x <span class="token punctuation">;</span>
        <span class="token keyword">end</span>

        <span class="token keyword">if</span> CheckerboardPos<span class="token punctuation">.</span>beginPos<span class="token punctuation">.</span>z <span class="token operator">&lt;</span> CheckerboardPos<span class="token punctuation">.</span>endPos<span class="token punctuation">.</span>z <span class="token keyword">then</span>
            normalizedZ <span class="token operator">=</span> z <span class="token operator">-</span> CheckerboardPos<span class="token punctuation">.</span>beginPos<span class="token punctuation">.</span>z<span class="token punctuation">;</span>
        <span class="token keyword">else</span>
            normalizedZ <span class="token operator">=</span> z <span class="token operator">-</span> CheckerboardPos<span class="token punctuation">.</span>endPos<span class="token punctuation">.</span>z<span class="token punctuation">;</span>
        <span class="token keyword">end</span>

        <span class="token keyword">local</span> text <span class="token operator">=</span>  normalizedX<span class="token operator">..</span><span class="token string">&quot;,&quot;</span><span class="token operator">..</span>normalizedZ<span class="token punctuation">;</span>
        <span class="token comment">--Api.Chat:sendSystemMsg(text);</span>
        <span class="token keyword">return</span> normalizedX<span class="token punctuation">,</span>normalizedZ<span class="token punctuation">;</span>

    <span class="token keyword">end</span><span class="token punctuation">,</span>

    GetRealCoord <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>roomId<span class="token punctuation">,</span>u<span class="token punctuation">,</span>v<span class="token punctuation">)</span>
        <span class="token keyword">if</span> u <span class="token operator">==</span><span class="token keyword">nil</span> <span class="token keyword">or</span> v <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>
        <span class="token keyword">if</span> <span class="token function">type</span><span class="token punctuation">(</span>u<span class="token punctuation">)</span> <span class="token operator">~=</span> <span class="token string">&quot;number&quot;</span> <span class="token keyword">or</span> <span class="token function">type</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token operator">~=</span> <span class="token string">&quot;number&quot;</span> <span class="token keyword">then</span>

            <span class="token keyword">return</span>
        <span class="token keyword">end</span>

        <span class="token keyword">local</span> realX <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">local</span> realZ <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

        <span class="token keyword">local</span> CheckerboardPos <span class="token operator">=</span> Config<span class="token punctuation">.</span>Checkerboard<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span>
        <span class="token keyword">if</span> CheckerboardPos <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>

        <span class="token keyword">if</span> CheckerboardPos<span class="token punctuation">.</span>beginPos <span class="token operator">==</span><span class="token keyword">nil</span> <span class="token keyword">or</span> CheckerboardPos<span class="token punctuation">.</span>endPos <span class="token operator">==</span> <span class="token keyword">nil</span>  <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>

        <span class="token keyword">if</span> CheckerboardPos<span class="token punctuation">.</span>beginPos<span class="token punctuation">.</span>x <span class="token operator">&lt;</span> CheckerboardPos<span class="token punctuation">.</span>endPos<span class="token punctuation">.</span>x <span class="token keyword">then</span>
            realX <span class="token operator">=</span> u <span class="token operator">+</span> CheckerboardPos<span class="token punctuation">.</span>beginPos<span class="token punctuation">.</span>x <span class="token punctuation">;</span>
        <span class="token keyword">else</span>
            realX <span class="token operator">=</span> u <span class="token operator">+</span> CheckerboardPos<span class="token punctuation">.</span>endPos<span class="token punctuation">.</span>x <span class="token punctuation">;</span>
        <span class="token keyword">end</span>

        <span class="token keyword">if</span> CheckerboardPos<span class="token punctuation">.</span>beginPos<span class="token punctuation">.</span>z <span class="token operator">&lt;</span> CheckerboardPos<span class="token punctuation">.</span>endPos<span class="token punctuation">.</span>z <span class="token keyword">then</span>
            realZ <span class="token operator">=</span> v <span class="token operator">+</span> CheckerboardPos<span class="token punctuation">.</span>beginPos<span class="token punctuation">.</span>z<span class="token punctuation">;</span>
        <span class="token keyword">else</span>
            realZ <span class="token operator">=</span> v <span class="token operator">+</span> CheckerboardPos<span class="token punctuation">.</span>endPos<span class="token punctuation">.</span>z<span class="token punctuation">;</span>
        <span class="token keyword">end</span>

        <span class="token keyword">if</span> GobangMgr<span class="token punctuation">.</span><span class="token function">JudgeChessInChessboard</span><span class="token punctuation">(</span>roomId<span class="token punctuation">,</span>realX<span class="token punctuation">,</span>CheckerboardPos<span class="token punctuation">.</span>beginPos<span class="token punctuation">.</span>y<span class="token punctuation">,</span>realZ<span class="token punctuation">)</span> <span class="token operator">==</span><span class="token keyword">false</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>
        <span class="token keyword">return</span> realX<span class="token punctuation">,</span>CheckerboardPos<span class="token punctuation">.</span>beginPos<span class="token punctuation">.</span>y<span class="token punctuation">,</span>realZ<span class="token punctuation">;</span>

    <span class="token keyword">end</span><span class="token punctuation">,</span>


    InitWinsList <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>roomId<span class="token punctuation">)</span>
        <span class="token keyword">if</span> GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>IsAI <span class="token operator">==</span> <span class="token keyword">false</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>
        <span class="token keyword">local</span> this <span class="token operator">=</span> AIGame<span class="token punctuation">;</span>
        <span class="token keyword">local</span> data <span class="token operator">=</span> AIGame<span class="token punctuation">.</span>AIData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span>
        <span class="token keyword">for</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">14</span> <span class="token keyword">do</span>
            <span class="token keyword">for</span> j <span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">10</span> <span class="token keyword">do</span>
                <span class="token keyword">for</span> k <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">4</span> <span class="token keyword">do</span>
                    <span class="token keyword">if</span> data<span class="token punctuation">.</span>wins<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span>  data<span class="token punctuation">.</span>wins<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token keyword">end</span>
                    <span class="token keyword">if</span> data<span class="token punctuation">.</span>wins<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token operator">+</span>k<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span> data<span class="token punctuation">.</span>wins<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token operator">+</span>k<span class="token punctuation">]</span><span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token keyword">end</span>
                    data<span class="token punctuation">.</span>wins<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token operator">+</span>k<span class="token punctuation">]</span><span class="token punctuation">[</span>data<span class="token punctuation">.</span>successTypeCount<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">true</span><span class="token punctuation">;</span>
                <span class="token keyword">end</span>
                data<span class="token punctuation">.</span>successTypeCount <span class="token operator">=</span> data<span class="token punctuation">.</span>successTypeCount <span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token keyword">end</span>

            <span class="token keyword">for</span> j <span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">10</span> <span class="token keyword">do</span>
                <span class="token keyword">for</span> k <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">4</span> <span class="token keyword">do</span>
                    <span class="token keyword">if</span> data<span class="token punctuation">.</span>wins<span class="token punctuation">[</span>j<span class="token operator">+</span>k<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span> data<span class="token punctuation">.</span>wins<span class="token punctuation">[</span>j<span class="token operator">+</span>k<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token keyword">end</span>
                    <span class="token keyword">if</span> data<span class="token punctuation">.</span>wins<span class="token punctuation">[</span>j<span class="token operator">+</span>k<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span> data<span class="token punctuation">.</span>wins<span class="token punctuation">[</span>j<span class="token operator">+</span>k<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token keyword">end</span>
                    data<span class="token punctuation">.</span>wins<span class="token punctuation">[</span>j<span class="token operator">+</span>k<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>data<span class="token punctuation">.</span>successTypeCount<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">true</span><span class="token punctuation">;</span>
                <span class="token keyword">end</span>
                data<span class="token punctuation">.</span>successTypeCount <span class="token operator">=</span> data<span class="token punctuation">.</span>successTypeCount <span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token keyword">end</span>
        <span class="token keyword">end</span>

        <span class="token keyword">for</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10</span> <span class="token keyword">do</span>
            <span class="token keyword">for</span> j <span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">10</span> <span class="token keyword">do</span>
                <span class="token keyword">for</span> k <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">4</span> <span class="token keyword">do</span>
                    <span class="token keyword">if</span>  data<span class="token punctuation">.</span>wins<span class="token punctuation">[</span>j<span class="token operator">+</span>k<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span> data<span class="token punctuation">.</span>wins<span class="token punctuation">[</span>j<span class="token operator">+</span>k<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token keyword">end</span>
                    <span class="token keyword">if</span> data<span class="token punctuation">.</span>wins<span class="token punctuation">[</span>j<span class="token operator">+</span>k<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token operator">+</span>k<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span> data<span class="token punctuation">.</span>wins<span class="token punctuation">[</span>j<span class="token operator">+</span>k<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token operator">+</span>k<span class="token punctuation">]</span> <span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token keyword">end</span>
                    data<span class="token punctuation">.</span>wins<span class="token punctuation">[</span>j<span class="token operator">+</span>k<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token operator">+</span>k<span class="token punctuation">]</span><span class="token punctuation">[</span>data<span class="token punctuation">.</span>successTypeCount<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">true</span><span class="token punctuation">;</span>
                <span class="token keyword">end</span>
                data<span class="token punctuation">.</span>successTypeCount <span class="token operator">=</span> data<span class="token punctuation">.</span>successTypeCount <span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token keyword">end</span>

            <span class="token keyword">for</span> j <span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">14</span> <span class="token keyword">do</span>
                <span class="token keyword">for</span> k <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">4</span> <span class="token keyword">do</span>
                    <span class="token keyword">if</span> data<span class="token punctuation">.</span>wins<span class="token punctuation">[</span>i<span class="token operator">+</span>k<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span> data<span class="token punctuation">.</span>wins<span class="token punctuation">[</span>i<span class="token operator">+</span>k<span class="token punctuation">]</span> <span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token keyword">end</span>
                    <span class="token keyword">if</span>  data<span class="token punctuation">.</span>wins<span class="token punctuation">[</span>i<span class="token operator">+</span>k<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token operator">-</span>k<span class="token punctuation">]</span> <span class="token operator">==</span><span class="token keyword">nil</span> <span class="token keyword">then</span>  data<span class="token punctuation">.</span>wins<span class="token punctuation">[</span>i<span class="token operator">+</span>k<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token operator">-</span>k<span class="token punctuation">]</span><span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token keyword">end</span>
                    data<span class="token punctuation">.</span>wins<span class="token punctuation">[</span>i<span class="token operator">+</span>k<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token operator">-</span>k<span class="token punctuation">]</span><span class="token punctuation">[</span>data<span class="token punctuation">.</span>successTypeCount<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">true</span><span class="token punctuation">;</span>
                <span class="token keyword">end</span>
                data<span class="token punctuation">.</span>successTypeCount <span class="token operator">=</span> data<span class="token punctuation">.</span>successTypeCount <span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token keyword">end</span>
        <span class="token keyword">end</span>

        <span class="token keyword">for</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>data<span class="token punctuation">.</span>successTypeCount<span class="token operator">-</span><span class="token number">1</span> <span class="token keyword">do</span>
            data<span class="token punctuation">.</span>myWin<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            data<span class="token punctuation">.</span>computerWin<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">end</span>

        <span class="token keyword">for</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">14</span> <span class="token keyword">do</span>
            <span class="token keyword">for</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">14</span> <span class="token keyword">do</span>
                <span class="token keyword">if</span> data<span class="token punctuation">.</span>chessBoard<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span> data<span class="token punctuation">.</span>chessBoard<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token keyword">end</span>
                data<span class="token punctuation">.</span>chessBoard<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span>

            <span class="token keyword">end</span>
        <span class="token keyword">end</span>

    <span class="token keyword">end</span><span class="token punctuation">,</span>


    BlockPlacedBy <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>roomId<span class="token punctuation">,</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>z<span class="token punctuation">)</span>
        <span class="token keyword">local</span> this <span class="token operator">=</span> AIGame<span class="token punctuation">;</span>
        <span class="token keyword">local</span> data <span class="token operator">=</span> AIGame<span class="token punctuation">.</span>AIData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span>
        <span class="token keyword">local</span> normalx <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">local</span> normalz <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>IsAI <span class="token operator">==</span> <span class="token keyword">false</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>

        normalx<span class="token punctuation">,</span> normalz <span class="token operator">=</span> this<span class="token punctuation">.</span><span class="token function">GetNormalizedCoord</span><span class="token punctuation">(</span>roomId<span class="token punctuation">,</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>z<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>CurChessType <span class="token operator">==</span> GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>AIChess <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>

        <span class="token keyword">if</span> normalx <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token keyword">or</span> normalz <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>

        <span class="token keyword">if</span> data<span class="token punctuation">.</span>chessBoard<span class="token punctuation">[</span>normalx<span class="token punctuation">]</span><span class="token punctuation">[</span>normalz<span class="token punctuation">]</span> <span class="token operator">~=</span> <span class="token number">0</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>

        data<span class="token punctuation">.</span>chessBoard<span class="token punctuation">[</span>normalx<span class="token punctuation">]</span><span class="token punctuation">[</span>normalz<span class="token punctuation">]</span> <span class="token operator">=</span> GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>MyChessType<span class="token punctuation">;</span>


        <span class="token keyword">for</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> data<span class="token punctuation">.</span>successTypeCount<span class="token operator">-</span><span class="token number">1</span> <span class="token keyword">do</span>
            <span class="token keyword">if</span> data<span class="token punctuation">.</span>wins<span class="token punctuation">[</span>normalx<span class="token punctuation">]</span><span class="token punctuation">[</span>normalz<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token keyword">then</span>
                data<span class="token punctuation">.</span>myWin<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">.</span>myWin<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
                data<span class="token punctuation">.</span>computerWin<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> data<span class="token punctuation">.</span>myWin<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">5</span> <span class="token keyword">then</span>
                    <span class="token keyword">local</span> ret<span class="token punctuation">,</span>score<span class="token punctuation">;</span>
                    <span class="token keyword">if</span> GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>AIChess <span class="token operator">==</span>Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>BlackChess <span class="token keyword">then</span>
                        ret<span class="token punctuation">,</span>score <span class="token operator">=</span> Api<span class="token punctuation">.</span>Player<span class="token punctuation">:</span><span class="token function">getGameScore</span><span class="token punctuation">(</span>GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>WhiteChess<span class="token punctuation">.</span>uin<span class="token punctuation">)</span>
                        Api<span class="token punctuation">.</span>Player<span class="token punctuation">:</span><span class="token function">setGameScore</span><span class="token punctuation">(</span>GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>WhiteChess<span class="token punctuation">.</span>uin<span class="token punctuation">,</span>score<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>
                        Api<span class="token punctuation">.</span>Player<span class="token punctuation">:</span><span class="token function">notifyGameInfo2Self</span><span class="token punctuation">(</span>GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>WhiteChess<span class="token punctuation">.</span>uin<span class="token punctuation">,</span><span class="token string">&quot;Room &quot;</span><span class="token operator">..</span>roomId<span class="token operator">..</span><span class="token string">&quot;: Game ends. White wins. &quot;</span><span class="token punctuation">)</span>
                    <span class="token keyword">elseif</span> GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>AIChess <span class="token operator">==</span>Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>WhiteChess  <span class="token keyword">then</span>
                        ret<span class="token punctuation">,</span>score <span class="token operator">=</span> Api<span class="token punctuation">.</span>Player<span class="token punctuation">:</span><span class="token function">getGameScore</span><span class="token punctuation">(</span>GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>BlackChess<span class="token punctuation">.</span>uin<span class="token punctuation">)</span>
                        Api<span class="token punctuation">.</span>Player<span class="token punctuation">:</span><span class="token function">setGameScore</span><span class="token punctuation">(</span>GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>BlackChess<span class="token punctuation">.</span>uin<span class="token punctuation">,</span>score<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>
                        Api<span class="token punctuation">.</span>Player<span class="token punctuation">:</span><span class="token function">notifyGameInfo2Self</span><span class="token punctuation">(</span>GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>BlackChess<span class="token punctuation">.</span>uin<span class="token punctuation">,</span><span class="token string">&quot;Room &quot;</span><span class="token operator">..</span>roomId<span class="token operator">..</span><span class="token string">&quot;: Game ends. Black wins. &quot;</span><span class="token punctuation">)</span>
                    <span class="token keyword">end</span>

                    GobangData<span class="token punctuation">.</span><span class="token function">SetWin</span><span class="token punctuation">(</span>roomId<span class="token punctuation">,</span><span class="token keyword">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">break</span>
                <span class="token keyword">end</span>
            <span class="token keyword">end</span>
        <span class="token keyword">end</span>

        table<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>placedBlockPos<span class="token punctuation">,</span><span class="token punctuation">{</span>x <span class="token operator">=</span>x<span class="token punctuation">,</span>y<span class="token operator">=</span>y<span class="token punctuation">,</span>z<span class="token operator">=</span>z<span class="token punctuation">}</span><span class="token punctuation">)</span>


        GobangData<span class="token punctuation">.</span><span class="token function">SetCurChess</span><span class="token punctuation">(</span>roomId<span class="token punctuation">,</span>GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>AIChess<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">--SettingRule.RoundTimeLimited(roomId)</span>
        <span class="token keyword">if</span> GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>AIChess <span class="token operator">==</span> Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>BlackChess <span class="token keyword">then</span>
            Api<span class="token punctuation">.</span>Chat<span class="token punctuation">.</span><span class="token function">sendSystemMsg</span><span class="token punctuation">(</span><span class="token string">&quot;Black round, please place the stone &quot;</span><span class="token punctuation">)</span>
        <span class="token keyword">elseif</span> GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>AIChess <span class="token operator">==</span> Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>WhiteChess <span class="token keyword">then</span>
            Api<span class="token punctuation">.</span>Chat<span class="token punctuation">.</span><span class="token function">sendSystemMsg</span><span class="token punctuation">(</span><span class="token string">&quot;White round, please place the stone &quot;</span><span class="token punctuation">)</span>
        <span class="token keyword">end</span>


    <span class="token keyword">end</span><span class="token punctuation">,</span>


    StartRound <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>roomId<span class="token punctuation">)</span>
        <span class="token keyword">if</span> roomId <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>
        <span class="token keyword">if</span> GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>IsAI <span class="token operator">==</span> <span class="token keyword">false</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>

        SettingRule<span class="token punctuation">.</span><span class="token function">RoundTimeLimited</span><span class="token punctuation">(</span>roomId<span class="token punctuation">)</span>
        <span class="token keyword">if</span> GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>CurChessType <span class="token operator">==</span> Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>WhiteChess <span class="token keyword">then</span>
            Api<span class="token punctuation">.</span>Chat<span class="token punctuation">:</span><span class="token function">sendSystemMsg</span><span class="token punctuation">(</span><span class="token string">&quot;White round, please place the stone &quot;</span><span class="token punctuation">)</span>
        <span class="token keyword">elseif</span> GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>CurChessType <span class="token operator">==</span> Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>BlackChess <span class="token keyword">then</span>
            Api<span class="token punctuation">.</span>Chat<span class="token punctuation">:</span><span class="token function">sendSystemMsg</span><span class="token punctuation">(</span><span class="token string">&quot;Black round, please place the stone &quot;</span><span class="token punctuation">)</span>
        <span class="token keyword">end</span>
        AIGame<span class="token punctuation">.</span><span class="token function">ComputerAI</span><span class="token punctuation">(</span>roomId<span class="token punctuation">)</span>
    <span class="token keyword">end</span><span class="token punctuation">,</span>


    ComputerAI <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>roomId<span class="token punctuation">)</span>
        <span class="token keyword">if</span> roomId <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">or</span>  GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>
        <span class="token keyword">if</span> GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>IsAI <span class="token operator">==</span> <span class="token keyword">false</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>
        <span class="token keyword">if</span> GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>AIChess <span class="token operator">~=</span> GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>CurChessType <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>


        <span class="token keyword">local</span> this <span class="token operator">=</span> AIGame<span class="token punctuation">;</span>
        <span class="token keyword">local</span> data <span class="token operator">=</span> AIGame<span class="token punctuation">.</span>AIData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span>


        <span class="token keyword">if</span> data<span class="token punctuation">.</span>isAIPlace <span class="token keyword">then</span>
            data<span class="token punctuation">.</span>isAIPlace <span class="token operator">=</span> <span class="token keyword">false</span>

            GobangData<span class="token punctuation">.</span><span class="token function">SetCurChess</span><span class="token punctuation">(</span>roomId<span class="token punctuation">,</span>GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>MyChessType<span class="token punctuation">)</span><span class="token punctuation">;</span>
            SettingRule<span class="token punctuation">.</span><span class="token function">RoundTimeLimited</span><span class="token punctuation">(</span>roomId<span class="token punctuation">)</span>
            <span class="token keyword">if</span> GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>CurChessType <span class="token operator">==</span> Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>WhiteChess <span class="token keyword">then</span>
                Api<span class="token punctuation">.</span>Chat<span class="token punctuation">:</span><span class="token function">sendSystemMsg</span><span class="token punctuation">(</span><span class="token string">&quot;White round, please place the stone &quot;</span><span class="token punctuation">)</span>
            <span class="token keyword">elseif</span> GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>CurChessType <span class="token operator">==</span> Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>BlackChess <span class="token keyword">then</span>
                Api<span class="token punctuation">.</span>Chat<span class="token punctuation">:</span><span class="token function">sendSystemMsg</span><span class="token punctuation">(</span><span class="token string">&quot;Black round, please place the stone &quot;</span><span class="token punctuation">)</span>
            <span class="token keyword">end</span>
            <span class="token keyword">return</span>
        <span class="token keyword">end</span>

        Api<span class="token punctuation">.</span>Chat<span class="token punctuation">:</span><span class="token function">sendSystemMsg</span><span class="token punctuation">(</span><span class="token string">&quot;Room &quot;</span><span class="token operator">..</span>roomId<span class="token operator">..</span><span class="token string">&quot;Robot Starts &quot;</span><span class="token punctuation">)</span>
        <span class="token keyword">local</span> u<span class="token punctuation">,</span>v <span class="token operator">=</span> this<span class="token punctuation">.</span><span class="token function">GetAIBestPos</span><span class="token punctuation">(</span>roomId<span class="token punctuation">)</span>
        <span class="token keyword">local</span> blockid <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">local</span> x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>z <span class="token punctuation">;</span>
        x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>z <span class="token operator">=</span> this<span class="token punctuation">.</span><span class="token function">GetRealCoord</span><span class="token punctuation">(</span>roomId<span class="token punctuation">,</span>u<span class="token punctuation">,</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span>
        data<span class="token punctuation">.</span>chessBoard<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">[</span>v<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>

        blockid <span class="token operator">=</span> Config<span class="token punctuation">.</span>BlockIdEnum<span class="token punctuation">[</span>GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>AIChess<span class="token punctuation">]</span><span class="token punctuation">;</span>
        Api<span class="token punctuation">.</span>Block<span class="token punctuation">:</span><span class="token function">placeBlock</span><span class="token punctuation">(</span>blockid<span class="token punctuation">,</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>z<span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span>
        data<span class="token punctuation">.</span>isAIPlace <span class="token operator">=</span> <span class="token keyword">true</span>
        table<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>placedBlockPos<span class="token punctuation">,</span><span class="token punctuation">{</span>x <span class="token operator">=</span>x<span class="token punctuation">,</span>y<span class="token operator">=</span>y<span class="token punctuation">,</span>z<span class="token operator">=</span>z<span class="token punctuation">}</span><span class="token punctuation">)</span>


        <span class="token keyword">for</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> data<span class="token punctuation">.</span>successTypeCount<span class="token operator">-</span><span class="token number">1</span> <span class="token keyword">do</span>
            <span class="token keyword">if</span> data<span class="token punctuation">.</span>wins<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">[</span>v<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token keyword">then</span>
                data<span class="token punctuation">.</span>computerWin<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">.</span>computerWin<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
                data<span class="token punctuation">.</span>myWin<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> data<span class="token punctuation">.</span>computerWin<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">5</span> <span class="token keyword">then</span>
                    Api<span class="token punctuation">.</span>Chat<span class="token punctuation">:</span><span class="token function">sendSystemMsg</span><span class="token punctuation">(</span><span class="token string">&quot;Room &quot;</span><span class="token operator">..</span>roomId<span class="token operator">..</span><span class="token string">&quot;Robot wins &quot;</span><span class="token punctuation">)</span>
                    GobangData<span class="token punctuation">.</span><span class="token function">SetWin</span><span class="token punctuation">(</span>roomId<span class="token punctuation">,</span><span class="token keyword">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">return</span>
                <span class="token keyword">end</span>
            <span class="token keyword">end</span>
        <span class="token keyword">end</span>

    <span class="token keyword">end</span><span class="token punctuation">,</span>


    GetAIBestPos <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>roomId<span class="token punctuation">)</span>
        <span class="token keyword">local</span> this <span class="token operator">=</span> AIGame<span class="token punctuation">;</span>
        <span class="token keyword">local</span> data <span class="token operator">=</span> AIGame<span class="token punctuation">.</span>AIData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span>
        <span class="token keyword">local</span> myScore <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token keyword">local</span> computerScore <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

        <span class="token keyword">local</span> max <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">local</span> u <span class="token operator">=</span><span class="token number">7</span><span class="token punctuation">;</span>
        <span class="token keyword">local</span> v <span class="token operator">=</span><span class="token number">7</span><span class="token punctuation">;</span>

        <span class="token keyword">for</span> i <span class="token operator">=</span> <span class="token number">0</span> <span class="token punctuation">,</span><span class="token number">14</span> <span class="token keyword">do</span>
            myScore<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
            computerScore<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span> j <span class="token operator">=</span><span class="token number">0</span> <span class="token punctuation">,</span><span class="token number">14</span> <span class="token keyword">do</span>
                myScore<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                computerScore<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token keyword">end</span>
        <span class="token keyword">end</span>

        <span class="token keyword">for</span> i <span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">14</span> <span class="token keyword">do</span>
            <span class="token keyword">for</span> j <span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">14</span> <span class="token keyword">do</span>
                <span class="token keyword">if</span> data<span class="token punctuation">.</span>chessBoard<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token keyword">then</span>
                    <span class="token keyword">for</span> k <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>data<span class="token punctuation">.</span>successTypeCount<span class="token operator">-</span><span class="token number">1</span>  <span class="token keyword">do</span>
                        <span class="token keyword">if</span> data<span class="token punctuation">.</span>wins<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token keyword">then</span>
                            <span class="token keyword">if</span> data<span class="token punctuation">.</span>myWin<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">==</span><span class="token number">1</span> <span class="token keyword">then</span>
                                myScore<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span>  myScore<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">200</span>
                            <span class="token keyword">elseif</span> data<span class="token punctuation">.</span>myWin<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">==</span><span class="token number">2</span> <span class="token keyword">then</span>
                                myScore<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span>  myScore<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">400</span>
                            <span class="token keyword">elseif</span> data<span class="token punctuation">.</span>myWin<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">==</span><span class="token number">3</span> <span class="token keyword">then</span>
                                myScore<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span>  myScore<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">2000</span>
                            <span class="token keyword">elseif</span> data<span class="token punctuation">.</span>myWin<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">==</span><span class="token number">4</span> <span class="token keyword">then</span>
                                myScore<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span>  myScore<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">10000</span>
                            <span class="token keyword">end</span>

                            <span class="token keyword">if</span> data<span class="token punctuation">.</span>computerWin<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">==</span><span class="token number">1</span> <span class="token keyword">then</span>
                                computerScore<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span>  computerScore<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">220</span>
                            <span class="token keyword">elseif</span> data<span class="token punctuation">.</span>computerWin<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">==</span><span class="token number">2</span> <span class="token keyword">then</span>
                                computerScore<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span>  computerScore<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">420</span>
                            <span class="token keyword">elseif</span> data<span class="token punctuation">.</span>computerWin<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">==</span><span class="token number">3</span> <span class="token keyword">then</span>
                                computerScore<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span>  computerScore<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">2100</span>
                            <span class="token keyword">elseif</span> data<span class="token punctuation">.</span>computerWin<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">==</span><span class="token number">4</span> <span class="token keyword">then</span>
                                computerScore<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span>  computerScore<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">20000</span>
                            <span class="token keyword">end</span>
                            <span class="token keyword">if</span> myScore<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">&gt;</span> max <span class="token keyword">then</span>
                                max <span class="token operator">=</span> myScore<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
                                u<span class="token operator">=</span>i<span class="token punctuation">;</span>
                                v<span class="token operator">=</span>j<span class="token punctuation">;</span>
                            <span class="token keyword">elseif</span> myScore<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">==</span> max <span class="token keyword">then</span>
                                <span class="token keyword">if</span> computerScore<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">&gt;</span>computerScore<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">[</span>v<span class="token punctuation">]</span> <span class="token keyword">then</span>
                                    u<span class="token operator">=</span>i<span class="token punctuation">;</span>
                                    v<span class="token operator">=</span>j<span class="token punctuation">;</span>
                                <span class="token keyword">end</span>
                            <span class="token keyword">end</span>
                            <span class="token keyword">if</span> computerScore<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">&gt;</span> max <span class="token keyword">then</span>
                                max <span class="token operator">=</span> computerScore<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
                                u<span class="token operator">=</span>i<span class="token punctuation">;</span>
                                v<span class="token operator">=</span>j<span class="token punctuation">;</span>
                            <span class="token keyword">elseif</span> computerScore<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">==</span> max <span class="token keyword">then</span>
                                <span class="token keyword">if</span> myScore<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">&gt;</span>myScore<span class="token punctuation">[</span>u<span class="token punctuation">]</span><span class="token punctuation">[</span>v<span class="token punctuation">]</span> <span class="token keyword">then</span>
                                    u<span class="token operator">=</span>i<span class="token punctuation">;</span>
                                    v<span class="token operator">=</span>j<span class="token punctuation">;</span>
                                <span class="token keyword">end</span>
                            <span class="token keyword">end</span>
                        <span class="token keyword">end</span>
                    <span class="token keyword">end</span>
                <span class="token keyword">end</span>
            <span class="token keyword">end</span>
        <span class="token keyword">end</span>

        <span class="token keyword">return</span> u<span class="token punctuation">,</span>v
    <span class="token keyword">end</span><span class="token punctuation">,</span>


    SetPlaceThreeChess <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>roomId<span class="token punctuation">)</span>

        <span class="token keyword">local</span> this <span class="token operator">=</span> AIGame<span class="token punctuation">;</span>
        <span class="token keyword">local</span> data <span class="token operator">=</span> AIGame<span class="token punctuation">.</span>AIData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span>
        <span class="token keyword">if</span> roomId <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">or</span> GobangData <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">or</span> GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>
        <span class="token keyword">if</span> GobangData<span class="token punctuation">.</span>IsDesignatedStart <span class="token operator">==</span> <span class="token keyword">false</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>

        <span class="token keyword">if</span> GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>IsAI <span class="token operator">==</span> <span class="token keyword">false</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>
        <span class="token keyword">if</span> GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>IsStartModeFinish <span class="token operator">==</span> <span class="token keyword">false</span> <span class="token keyword">or</span> GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>IsBeginRound <span class="token operator">==</span><span class="token keyword">false</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>

        <span class="token keyword">local</span> chessData <span class="token operator">=</span> GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span>
        <span class="token keyword">local</span> checkerboardCenterPos<span class="token punctuation">;</span>
        <span class="token keyword">local</span> curRelativePos
        checkerboardCenterPos <span class="token operator">=</span> Config<span class="token punctuation">.</span>CheckerboardCenterPos<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span>
        curRelativePos <span class="token operator">=</span> Config<span class="token punctuation">.</span>ThreeChessRelativePos<span class="token punctuation">[</span>chessData<span class="token punctuation">.</span>CurStartModeIndex<span class="token punctuation">]</span>

        <span class="token keyword">for</span> k<span class="token punctuation">,</span>v <span class="token keyword">in</span> <span class="token function">pairs</span><span class="token punctuation">(</span>curRelativePos<span class="token punctuation">)</span> <span class="token keyword">do</span>
            <span class="token keyword">local</span> x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>z
            <span class="token keyword">local</span> chessType<span class="token punctuation">;</span>
            <span class="token keyword">local</span> normalx <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token keyword">local</span> normalz <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token keyword">local</span> mapTable <span class="token operator">=</span> <span class="token keyword">nil</span><span class="token punctuation">;</span>
            <span class="token keyword">local</span> otherMapTable <span class="token operator">=</span> <span class="token keyword">nil</span><span class="token punctuation">;</span>

            x <span class="token operator">=</span> v<span class="token punctuation">.</span>x <span class="token operator">+</span>checkerboardCenterPos<span class="token punctuation">.</span>x
            y <span class="token operator">=</span> v<span class="token punctuation">.</span>y <span class="token operator">+</span>checkerboardCenterPos<span class="token punctuation">.</span>y
            z <span class="token operator">=</span> v<span class="token punctuation">.</span>z <span class="token operator">+</span>checkerboardCenterPos<span class="token punctuation">.</span>z

            table<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>placedBlockPos<span class="token punctuation">,</span><span class="token punctuation">{</span>x <span class="token operator">=</span>x<span class="token punctuation">,</span>y<span class="token operator">=</span>y<span class="token punctuation">,</span>z<span class="token operator">=</span>z<span class="token punctuation">}</span><span class="token punctuation">)</span>

            <span class="token keyword">if</span> k <span class="token operator">==</span> <span class="token number">2</span> <span class="token keyword">then</span>
                chessType <span class="token operator">=</span> Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>WhiteChess
            <span class="token keyword">else</span>
                chessType <span class="token operator">=</span> Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>BlackChess
            <span class="token keyword">end</span>

            <span class="token keyword">if</span> chessType <span class="token operator">==</span> GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>AIChess <span class="token keyword">then</span>
                mapTable <span class="token operator">=</span> data<span class="token punctuation">.</span>computerWin
                otherMapTable <span class="token operator">=</span> data<span class="token punctuation">.</span>myWin
            <span class="token keyword">elseif</span> chessType <span class="token operator">==</span> GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>MyChessType <span class="token keyword">then</span>
                mapTable <span class="token operator">=</span> data<span class="token punctuation">.</span>myWin
                otherMapTable <span class="token operator">=</span> data<span class="token punctuation">.</span>computerWin
            <span class="token keyword">end</span>

            normalx<span class="token punctuation">,</span> normalz <span class="token operator">=</span> this<span class="token punctuation">.</span><span class="token function">GetNormalizedCoord</span><span class="token punctuation">(</span>roomId<span class="token punctuation">,</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>z<span class="token punctuation">)</span><span class="token punctuation">;</span>
            data<span class="token punctuation">.</span>chessBoard<span class="token punctuation">[</span>normalx<span class="token punctuation">]</span><span class="token punctuation">[</span>normalz<span class="token punctuation">]</span> <span class="token operator">=</span> chessType<span class="token punctuation">;</span>
            <span class="token keyword">for</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> data<span class="token punctuation">.</span>successTypeCount<span class="token operator">-</span><span class="token number">1</span> <span class="token keyword">do</span>
                <span class="token keyword">if</span> data<span class="token punctuation">.</span>wins<span class="token punctuation">[</span>normalx<span class="token punctuation">]</span><span class="token punctuation">[</span>normalz<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token keyword">then</span>
                    mapTable<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> mapTable<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
                    otherMapTable<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">;</span>
                <span class="token keyword">end</span>
            <span class="token keyword">end</span>
        <span class="token keyword">end</span>
    <span class="token keyword">end</span><span class="token punctuation">,</span>


    SetAIRoundBeforeData <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>roomId<span class="token punctuation">)</span>
        <span class="token keyword">if</span> roomId <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>
        <span class="token keyword">local</span> data <span class="token operator">=</span> GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> data<span class="token punctuation">.</span>IsAI <span class="token operator">==</span> <span class="token keyword">false</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>


        <span class="token keyword">if</span> GobangData<span class="token punctuation">.</span>IsDesignatedStart <span class="token keyword">then</span>
            <span class="token keyword">if</span> data<span class="token punctuation">.</span>AIChess <span class="token operator">==</span> Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>BlackChess <span class="token keyword">then</span>
                <span class="token keyword">if</span> data<span class="token punctuation">.</span>IsStartModeFinish  <span class="token operator">==</span> <span class="token keyword">true</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>
                GobangData<span class="token punctuation">.</span><span class="token function">SetStartMode</span><span class="token punctuation">(</span>roomId<span class="token punctuation">,</span><span class="token keyword">true</span><span class="token punctuation">)</span>
            <span class="token keyword">elseif</span> data<span class="token punctuation">.</span>AIChess <span class="token operator">==</span> Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>WhiteChess <span class="token keyword">then</span>
                <span class="token keyword">if</span> data<span class="token punctuation">.</span>IsStartModeFinish  <span class="token operator">==</span><span class="token keyword">false</span> <span class="token keyword">or</span> data<span class="token punctuation">.</span>IsBeginRound <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>
                GobangData<span class="token punctuation">.</span><span class="token function">SetBeginRound</span><span class="token punctuation">(</span>roomId<span class="token punctuation">,</span><span class="token keyword">true</span><span class="token punctuation">)</span>
            <span class="token keyword">end</span>
        <span class="token keyword">else</span>

            GobangData<span class="token punctuation">.</span><span class="token function">SetBeginRound</span><span class="token punctuation">(</span>roomId<span class="token punctuation">,</span><span class="token keyword">true</span><span class="token punctuation">)</span>
        <span class="token keyword">end</span>

    <span class="token keyword">end</span><span class="token punctuation">,</span>


    ChessBlockPlaceTrigger <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>param<span class="token punctuation">)</span>
        <span class="token keyword">local</span> curRoomId <span class="token operator">=</span> GobangMgr<span class="token punctuation">.</span><span class="token function">GetRoomidByPos</span><span class="token punctuation">(</span>param<span class="token punctuation">.</span>x<span class="token punctuation">,</span>param<span class="token punctuation">.</span>y<span class="token punctuation">,</span>param<span class="token punctuation">.</span>z<span class="token punctuation">)</span>
        <span class="token keyword">if</span> curRoomId <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span>  <span class="token keyword">return</span> <span class="token keyword">end</span>
        <span class="token keyword">local</span> data <span class="token operator">=</span> GobangData<span class="token punctuation">[</span>curRoomId<span class="token punctuation">]</span>




        <span class="token keyword">local</span> myChessType
        <span class="token keyword">if</span> data<span class="token punctuation">.</span>AIChess <span class="token operator">==</span> Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>BlackChess <span class="token keyword">then</span>
            myChessType <span class="token operator">=</span> Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>WhiteChess
        <span class="token keyword">elseif</span> data<span class="token punctuation">.</span>AIChess <span class="token operator">==</span> Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>WhiteChess <span class="token keyword">then</span>
            myChessType <span class="token operator">=</span> Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>BlackChess
        <span class="token keyword">end</span>

        <span class="token keyword">if</span> myChessType <span class="token operator">==</span> data<span class="token punctuation">.</span>CurChessType <span class="token keyword">then</span>

            AIGame<span class="token punctuation">.</span><span class="token function">BlockPlacedBy</span><span class="token punctuation">(</span>curRoomId<span class="token punctuation">,</span>param<span class="token punctuation">.</span>x<span class="token punctuation">,</span>param<span class="token punctuation">.</span>y<span class="token punctuation">,</span>param<span class="token punctuation">.</span>z<span class="token punctuation">)</span>
        <span class="token keyword">elseif</span> data<span class="token punctuation">.</span>AIChess <span class="token operator">==</span> data<span class="token punctuation">.</span>CurChessType <span class="token keyword">then</span>

            TimerManager<span class="token punctuation">.</span><span class="token function">CreateTimer</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

                AIGame<span class="token punctuation">.</span><span class="token function">ComputerAI</span><span class="token punctuation">(</span>curRoomId<span class="token punctuation">)</span>
            <span class="token keyword">end</span><span class="token punctuation">)</span>

        <span class="token keyword">end</span>
    <span class="token keyword">end</span><span class="token punctuation">,</span>


    ResetData <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>roomId<span class="token punctuation">)</span>
        <span class="token keyword">if</span> roomId <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span>

            <span class="token keyword">return</span>
        <span class="token keyword">end</span>

        <span class="token keyword">local</span> data <span class="token operator">=</span> AIGame<span class="token punctuation">.</span>AIData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span>

        <span class="token function">print</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>placedBlockPos<span class="token punctuation">)</span>
        <span class="token keyword">for</span> k<span class="token punctuation">,</span>v <span class="token keyword">in</span> <span class="token function">pairs</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>placedBlockPos<span class="token punctuation">)</span> <span class="token keyword">do</span>
            Api<span class="token punctuation">.</span>Block<span class="token punctuation">:</span><span class="token function">destroyBlock</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span>x<span class="token punctuation">,</span>v<span class="token punctuation">.</span>y<span class="token punctuation">,</span>v<span class="token punctuation">.</span>z<span class="token punctuation">,</span><span class="token keyword">false</span><span class="token punctuation">)</span>
        <span class="token keyword">end</span>

        AIGame<span class="token punctuation">.</span>AIData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>placedBlockPos <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
        AIGame<span class="token punctuation">.</span>AIData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>successTypeCount <span class="token operator">=</span> <span class="token number">0</span>
        AIGame<span class="token punctuation">.</span>AIData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>wins <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
        AIGame<span class="token punctuation">.</span>AIData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>myWin <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
        AIGame<span class="token punctuation">.</span>AIData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>computerWin <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
        AIGame<span class="token punctuation">.</span>AIData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>chessBoard <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
        AIGame<span class="token punctuation">.</span>AIData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>isAIPlace <span class="token operator">=</span> <span class="token keyword">false</span>

    <span class="token keyword">end</span><span class="token punctuation">,</span>


<span class="token punctuation">}</span>


BattleGame <span class="token operator">=</span> <span class="token punctuation">{</span>
    BattleData <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token punctuation">[</span>Config<span class="token punctuation">.</span>RoomType<span class="token punctuation">.</span>RoomOne<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
            whiteChessList <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
            blackChessList <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
            battleData <span class="token operator">=</span> <span class="token punctuation">{</span>
                beginTime<span class="token operator">=</span>os<span class="token punctuation">.</span><span class="token function">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                roundNum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>
                curNum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span>Config<span class="token punctuation">.</span>RoomType<span class="token punctuation">.</span>RoomTwo<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
            whiteChessList <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
            blackChessList <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
            battleData <span class="token operator">=</span> <span class="token punctuation">{</span>
                beginTime<span class="token operator">=</span>os<span class="token punctuation">.</span><span class="token function">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                roundNum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>
                curNum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span>Config<span class="token punctuation">.</span>RoomType<span class="token punctuation">.</span>RoomThree<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
            whiteChessList <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
            blackChessList <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
            battleData <span class="token operator">=</span> <span class="token punctuation">{</span>
                beginTime<span class="token operator">=</span>os<span class="token punctuation">.</span><span class="token function">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                roundNum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>
                curNum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span>Config<span class="token punctuation">.</span>RoomType<span class="token punctuation">.</span>RoomFour<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
            whiteChessList <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
            blackChessList <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
            battleData <span class="token operator">=</span> <span class="token punctuation">{</span>
                beginTime<span class="token operator">=</span>os<span class="token punctuation">.</span><span class="token function">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                roundNum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>
                curNum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>

        AllChessNum <span class="token operator">=</span> <span class="token number">225</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>


    JudgeVictory <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>roomId<span class="token punctuation">,</span>chessList<span class="token punctuation">,</span>byactor<span class="token punctuation">)</span>
        <span class="token keyword">if</span> chessList <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span><span class="token punctuation">;</span>
        <span class="token keyword">local</span> this <span class="token operator">=</span> BattleGame<span class="token punctuation">;</span>


        <span class="token keyword">if</span> this<span class="token punctuation">.</span><span class="token function">checkX</span><span class="token punctuation">(</span>chessList<span class="token punctuation">)</span> <span class="token keyword">or</span>  this<span class="token punctuation">.</span><span class="token function">checkZ</span><span class="token punctuation">(</span>chessList<span class="token punctuation">)</span> <span class="token keyword">or</span>  this<span class="token punctuation">.</span><span class="token function">checkLeft</span><span class="token punctuation">(</span>chessList<span class="token punctuation">)</span> <span class="token keyword">or</span> this<span class="token punctuation">.</span><span class="token function">checkRight</span><span class="token punctuation">(</span>chessList<span class="token punctuation">)</span> <span class="token keyword">then</span>
            Api<span class="token punctuation">.</span>Player<span class="token punctuation">:</span><span class="token function">notifyGameInfo2Self</span><span class="token punctuation">(</span>byactor<span class="token punctuation">,</span><span class="token string">&quot;You win &quot;</span><span class="token punctuation">)</span>
            GobangData<span class="token punctuation">.</span><span class="token function">SetWin</span><span class="token punctuation">(</span>roomId<span class="token punctuation">,</span><span class="token keyword">true</span><span class="token punctuation">)</span>
            <span class="token keyword">local</span> ret<span class="token punctuation">,</span>score <span class="token operator">=</span> Api<span class="token punctuation">.</span>Player<span class="token punctuation">:</span><span class="token function">getGameScore</span><span class="token punctuation">(</span>byactor<span class="token punctuation">)</span>
            Api<span class="token punctuation">.</span>Player<span class="token punctuation">:</span><span class="token function">setGameScore</span><span class="token punctuation">(</span>byactor<span class="token punctuation">,</span>score<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>

        <span class="token keyword">else</span>
        <span class="token keyword">end</span>
    <span class="token keyword">end</span><span class="token punctuation">,</span>


    checkX <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>chessInfoList<span class="token punctuation">)</span>
        <span class="token keyword">if</span> chessInfoList <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">false</span> <span class="token keyword">end</span><span class="token punctuation">;</span>

        table<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span>chessInfoList<span class="token punctuation">,</span><span class="token keyword">function</span> <span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span> <span class="token keyword">return</span> a<span class="token punctuation">.</span>z <span class="token operator">&gt;</span> b<span class="token punctuation">.</span>z  <span class="token keyword">end</span> <span class="token punctuation">)</span>

        <span class="token keyword">local</span> xIdenticalList <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token keyword">local</span> sameNum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">local</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">local</span> g <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

        <span class="token keyword">for</span> k<span class="token punctuation">,</span>v <span class="token keyword">in</span> <span class="token function">pairs</span><span class="token punctuation">(</span>chessInfoList<span class="token punctuation">)</span> <span class="token keyword">do</span>
            <span class="token keyword">if</span>  xIdenticalList<span class="token punctuation">[</span>v<span class="token punctuation">.</span>x<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span>
                xIdenticalList<span class="token punctuation">[</span>v<span class="token punctuation">.</span>x<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
            <span class="token keyword">end</span>
            table<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span> xIdenticalList<span class="token punctuation">[</span>v<span class="token punctuation">.</span>x<span class="token punctuation">]</span><span class="token punctuation">,</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">end</span>



        <span class="token keyword">for</span> k<span class="token punctuation">,</span> v <span class="token keyword">in</span>  <span class="token function">pairs</span><span class="token punctuation">(</span>xIdenticalList<span class="token punctuation">)</span> <span class="token keyword">do</span>
            sameNum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            g <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

            <span class="token keyword">for</span> k1<span class="token punctuation">,</span>v1 <span class="token keyword">in</span> <span class="token function">pairs</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token keyword">do</span>
                j <span class="token operator">=</span> v1<span class="token punctuation">.</span>z<span class="token punctuation">;</span>
                <span class="token function">print</span><span class="token punctuation">(</span>math<span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span>g<span class="token operator">-</span>j<span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token function">print</span><span class="token punctuation">(</span>g<span class="token punctuation">,</span><span class="token string">&quot;,&quot;</span><span class="token punctuation">,</span>j<span class="token punctuation">)</span>
                <span class="token keyword">if</span> math<span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span>g<span class="token operator">-</span>j<span class="token punctuation">)</span>  <span class="token operator">==</span> <span class="token number">1</span> <span class="token keyword">then</span>
                    sameNum <span class="token operator">=</span> sameNum<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
                    <span class="token keyword">if</span> sameNum<span class="token operator">&gt;=</span><span class="token number">4</span> <span class="token keyword">then</span>

                        <span class="token keyword">return</span> <span class="token keyword">true</span><span class="token punctuation">;</span>
                    <span class="token keyword">end</span>
                <span class="token keyword">else</span>
                    sameNum <span class="token operator">=</span> <span class="token number">0</span>
                <span class="token keyword">end</span>
                g<span class="token operator">=</span>j<span class="token punctuation">;</span>
            <span class="token keyword">end</span>
        <span class="token keyword">end</span>
        <span class="token keyword">return</span> <span class="token keyword">false</span>
    <span class="token keyword">end</span><span class="token punctuation">,</span>

    checkZ <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>chessInfoList<span class="token punctuation">)</span>
        <span class="token keyword">if</span> chessInfoList <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">false</span> <span class="token keyword">end</span><span class="token punctuation">;</span>

        table<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span>chessInfoList<span class="token punctuation">,</span><span class="token keyword">function</span> <span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span> <span class="token keyword">return</span> a<span class="token punctuation">.</span>x <span class="token operator">&gt;</span> b<span class="token punctuation">.</span>x  <span class="token keyword">end</span> <span class="token punctuation">)</span>

        <span class="token keyword">local</span> xIdenticalList <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token keyword">local</span> sameNum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">local</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">local</span> g <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

        <span class="token keyword">for</span> k<span class="token punctuation">,</span>v <span class="token keyword">in</span> <span class="token function">pairs</span><span class="token punctuation">(</span>chessInfoList<span class="token punctuation">)</span> <span class="token keyword">do</span>
            <span class="token keyword">if</span>  xIdenticalList<span class="token punctuation">[</span>v<span class="token punctuation">.</span>z<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span>
                xIdenticalList<span class="token punctuation">[</span>v<span class="token punctuation">.</span>z<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
            <span class="token keyword">end</span>
            table<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span> xIdenticalList<span class="token punctuation">[</span>v<span class="token punctuation">.</span>z<span class="token punctuation">]</span><span class="token punctuation">,</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">end</span>



        <span class="token keyword">for</span> k<span class="token punctuation">,</span> v <span class="token keyword">in</span>  <span class="token function">pairs</span><span class="token punctuation">(</span>xIdenticalList<span class="token punctuation">)</span> <span class="token keyword">do</span>
            sameNum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            g <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

            <span class="token keyword">for</span> k1<span class="token punctuation">,</span>v1 <span class="token keyword">in</span> <span class="token function">pairs</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token keyword">do</span>
                j <span class="token operator">=</span> v1<span class="token punctuation">.</span>x<span class="token punctuation">;</span>
                <span class="token function">print</span><span class="token punctuation">(</span>math<span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span>g<span class="token operator">-</span>j<span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token function">print</span><span class="token punctuation">(</span>g<span class="token punctuation">,</span><span class="token string">&quot;,&quot;</span><span class="token punctuation">,</span>j<span class="token punctuation">)</span>
                <span class="token keyword">if</span> math<span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span>g<span class="token operator">-</span>j<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span> <span class="token keyword">then</span>
                    sameNum <span class="token operator">=</span> sameNum<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
                    <span class="token keyword">if</span> sameNum<span class="token operator">&gt;=</span><span class="token number">4</span> <span class="token keyword">then</span>

                        <span class="token keyword">return</span> <span class="token keyword">true</span><span class="token punctuation">;</span>
                    <span class="token keyword">end</span>
                <span class="token keyword">else</span>
                    sameNum <span class="token operator">=</span> <span class="token number">0</span>
                <span class="token keyword">end</span>
                g<span class="token operator">=</span>j<span class="token punctuation">;</span>
            <span class="token keyword">end</span>
        <span class="token keyword">end</span>

        <span class="token keyword">return</span> <span class="token keyword">false</span>
    <span class="token keyword">end</span><span class="token punctuation">,</span>

    checkRight <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>chessInfoList<span class="token punctuation">)</span>
        <span class="token keyword">if</span> chessInfoList <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">false</span> <span class="token keyword">end</span><span class="token punctuation">;</span>

        table<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span>chessInfoList<span class="token punctuation">,</span><span class="token keyword">function</span> <span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span> <span class="token keyword">return</span> a<span class="token punctuation">.</span>x <span class="token operator">&gt;</span> b<span class="token punctuation">.</span>x  <span class="token keyword">end</span> <span class="token punctuation">)</span>

        <span class="token keyword">local</span> xIdenticalList <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token keyword">local</span> sameNum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">local</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">local</span> g <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

        <span class="token keyword">for</span> k<span class="token punctuation">,</span>v <span class="token keyword">in</span> <span class="token function">pairs</span><span class="token punctuation">(</span>chessInfoList<span class="token punctuation">)</span> <span class="token keyword">do</span>
            <span class="token keyword">if</span>  xIdenticalList<span class="token punctuation">[</span>v<span class="token punctuation">.</span>Xaddy<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span>
                xIdenticalList<span class="token punctuation">[</span>v<span class="token punctuation">.</span>Xaddy<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
            <span class="token keyword">end</span>
            table<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span> xIdenticalList<span class="token punctuation">[</span>v<span class="token punctuation">.</span>Xaddy<span class="token punctuation">]</span><span class="token punctuation">,</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">end</span>

        <span class="token keyword">for</span> k<span class="token punctuation">,</span> v <span class="token keyword">in</span>  <span class="token function">pairs</span><span class="token punctuation">(</span>xIdenticalList<span class="token punctuation">)</span> <span class="token keyword">do</span>
            sameNum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            g <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

            <span class="token keyword">for</span> k1<span class="token punctuation">,</span>v1 <span class="token keyword">in</span> <span class="token function">pairs</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token keyword">do</span>
                j <span class="token operator">=</span> v1<span class="token punctuation">.</span>x<span class="token punctuation">;</span>
                <span class="token function">print</span><span class="token punctuation">(</span>math<span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span>g<span class="token operator">-</span>j<span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token keyword">if</span> math<span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span>g<span class="token operator">-</span>j<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span> <span class="token keyword">then</span>
                    sameNum <span class="token operator">=</span> sameNum<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
                    <span class="token keyword">if</span> sameNum<span class="token operator">&gt;=</span><span class="token number">4</span> <span class="token keyword">then</span>

                        <span class="token keyword">return</span> <span class="token keyword">true</span><span class="token punctuation">;</span>
                    <span class="token keyword">end</span>
                <span class="token keyword">else</span>
                    sameNum <span class="token operator">=</span> <span class="token number">0</span>
                <span class="token keyword">end</span>
                g<span class="token operator">=</span>j<span class="token punctuation">;</span>
            <span class="token keyword">end</span>
        <span class="token keyword">end</span>

        <span class="token keyword">return</span> <span class="token keyword">false</span>
    <span class="token keyword">end</span><span class="token punctuation">,</span>

    checkLeft <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>chessInfoList<span class="token punctuation">)</span>
        <span class="token keyword">if</span> chessInfoList <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">false</span> <span class="token keyword">end</span><span class="token punctuation">;</span>

        table<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span>chessInfoList<span class="token punctuation">,</span><span class="token keyword">function</span> <span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span> <span class="token keyword">return</span> a<span class="token punctuation">.</span>x <span class="token operator">&gt;</span> b<span class="token punctuation">.</span>x  <span class="token keyword">end</span> <span class="token punctuation">)</span>

        <span class="token keyword">local</span> xIdenticalList <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token keyword">local</span> sameNum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">local</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">local</span> g <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

        <span class="token keyword">for</span> k<span class="token punctuation">,</span>v <span class="token keyword">in</span> <span class="token function">pairs</span><span class="token punctuation">(</span>chessInfoList<span class="token punctuation">)</span> <span class="token keyword">do</span>
            <span class="token keyword">if</span>  xIdenticalList<span class="token punctuation">[</span>v<span class="token punctuation">.</span>Xsuby<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span>
                xIdenticalList<span class="token punctuation">[</span>v<span class="token punctuation">.</span>Xsuby<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
            <span class="token keyword">end</span>
            table<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span> xIdenticalList<span class="token punctuation">[</span>v<span class="token punctuation">.</span>Xsuby<span class="token punctuation">]</span><span class="token punctuation">,</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">end</span>

        <span class="token keyword">for</span> k<span class="token punctuation">,</span> v <span class="token keyword">in</span>  <span class="token function">pairs</span><span class="token punctuation">(</span>xIdenticalList<span class="token punctuation">)</span> <span class="token keyword">do</span>
            sameNum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            g <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

            <span class="token keyword">for</span> k1<span class="token punctuation">,</span>v1 <span class="token keyword">in</span> <span class="token function">pairs</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token keyword">do</span>
                j <span class="token operator">=</span> v1<span class="token punctuation">.</span>x<span class="token punctuation">;</span>
                <span class="token function">print</span><span class="token punctuation">(</span>math<span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span>g<span class="token operator">-</span>j<span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token keyword">if</span> math<span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span>g<span class="token operator">-</span>j<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span> <span class="token keyword">then</span>
                    sameNum <span class="token operator">=</span> sameNum<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
                    <span class="token keyword">if</span> sameNum<span class="token operator">&gt;=</span><span class="token number">4</span> <span class="token keyword">then</span>

                        <span class="token keyword">return</span> <span class="token keyword">true</span><span class="token punctuation">;</span>
                    <span class="token keyword">end</span>
                <span class="token keyword">else</span>
                    sameNum <span class="token operator">=</span> <span class="token number">0</span>
                <span class="token keyword">end</span>
                g<span class="token operator">=</span>j<span class="token punctuation">;</span>
            <span class="token keyword">end</span>
        <span class="token keyword">end</span>

        <span class="token keyword">return</span> <span class="token keyword">false</span>
    <span class="token keyword">end</span><span class="token punctuation">,</span>


    GetChessListByBlockId <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>roomId<span class="token punctuation">,</span>blockid<span class="token punctuation">)</span>
        <span class="token keyword">if</span> blockid <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span><span class="token punctuation">;</span>
        <span class="token keyword">local</span> this <span class="token operator">=</span> BattleGame<span class="token punctuation">;</span>
        <span class="token keyword">local</span> data <span class="token operator">=</span> BattleGame<span class="token punctuation">.</span>BattleData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span>

        <span class="token keyword">if</span> <span class="token function">tonumber</span><span class="token punctuation">(</span>blockid<span class="token punctuation">)</span> <span class="token operator">==</span> Config<span class="token punctuation">.</span>BlockIdEnum<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token keyword">then</span>
            <span class="token keyword">return</span> data<span class="token punctuation">.</span>whiteChessList
        <span class="token keyword">elseif</span> <span class="token function">tonumber</span><span class="token punctuation">(</span>blockid<span class="token punctuation">)</span> <span class="token operator">==</span> Config<span class="token punctuation">.</span>BlockIdEnum<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token keyword">then</span>
            <span class="token keyword">return</span> data<span class="token punctuation">.</span>blackChessList
        <span class="token keyword">else</span>
            <span class="token keyword">return</span> <span class="token keyword">nil</span><span class="token punctuation">;</span>
        <span class="token keyword">end</span>
    <span class="token keyword">end</span><span class="token punctuation">,</span>


    SaveChessInfo <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>blockid<span class="token punctuation">,</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>z<span class="token punctuation">)</span>
        chessInfo <span class="token operator">=</span> <span class="token punctuation">{</span>
            x<span class="token operator">=</span>x<span class="token punctuation">,</span>
            y<span class="token operator">=</span>y<span class="token punctuation">,</span>
            z<span class="token operator">=</span>z<span class="token punctuation">,</span>
            Xsuby <span class="token operator">=</span> x<span class="token operator">-</span>z<span class="token punctuation">;</span>
            Xaddy <span class="token operator">=</span> x<span class="token operator">+</span>z<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">local</span> this <span class="token operator">=</span> BattleGame<span class="token punctuation">;</span>
        <span class="token keyword">local</span> curRoomId <span class="token operator">=</span> GobangMgr<span class="token punctuation">.</span><span class="token function">GetRoomidByPos</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>z<span class="token punctuation">)</span>

        <span class="token keyword">local</span> chessList <span class="token operator">=</span> this<span class="token punctuation">.</span><span class="token function">GetChessListByBlockId</span><span class="token punctuation">(</span>curRoomId<span class="token punctuation">,</span>blockid<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> chessList <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span><span class="token punctuation">;</span>

        table<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>chessList<span class="token punctuation">,</span>chessInfo<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">end</span><span class="token punctuation">,</span>


    SetChessRoundData <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>roomId<span class="token punctuation">)</span>
        <span class="token keyword">if</span> roomId <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">or</span> curNum <span class="token operator">==</span><span class="token keyword">nil</span> <span class="token keyword">or</span> roundNum <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>

        <span class="token keyword">local</span> data <span class="token operator">=</span> BattleGame<span class="token punctuation">.</span>BattleData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>battleData<span class="token punctuation">;</span>
        <span class="token keyword">if</span> data <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>

        <span class="token keyword">local</span> num <span class="token operator">=</span> <span class="token number">0</span>
        <span class="token keyword">for</span> k<span class="token punctuation">,</span>v <span class="token keyword">in</span> <span class="token function">pairs</span><span class="token punctuation">(</span>BattleGame<span class="token punctuation">.</span>BattleData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>whiteChessList<span class="token punctuation">)</span> <span class="token keyword">do</span>
            num <span class="token operator">=</span> num<span class="token operator">+</span><span class="token number">1</span>
        <span class="token keyword">end</span>

        <span class="token keyword">for</span> k<span class="token punctuation">,</span>v <span class="token keyword">in</span> <span class="token function">pairs</span><span class="token punctuation">(</span>BattleGame<span class="token punctuation">.</span>BattleData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>whiteChessList<span class="token punctuation">)</span> <span class="token keyword">do</span>
            num <span class="token operator">=</span> num<span class="token operator">+</span><span class="token number">1</span>
        <span class="token keyword">end</span>

        <span class="token keyword">if</span> num <span class="token operator">&gt;=</span> BattleGame<span class="token punctuation">.</span>BattleData<span class="token punctuation">.</span>AllChessNum <span class="token keyword">then</span>

            <span class="token keyword">return</span>
        <span class="token keyword">end</span>

        <span class="token keyword">if</span> num <span class="token operator">==</span> data<span class="token punctuation">.</span>curNum <span class="token keyword">and</span> data<span class="token punctuation">.</span>beginTime<span class="token operator">+</span><span class="token number">20</span> <span class="token operator">&lt;</span>os<span class="token punctuation">.</span><span class="token function">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">and</span> data<span class="token punctuation">.</span>roundNum <span class="token operator">&gt;=</span><span class="token number">4</span> <span class="token keyword">then</span>

            <span class="token keyword">return</span>
        <span class="token keyword">end</span>

        <span class="token keyword">if</span> num <span class="token operator">==</span> data<span class="token punctuation">.</span>curNum <span class="token keyword">and</span> data<span class="token punctuation">.</span>roundNum <span class="token operator">&lt;</span><span class="token number">4</span> <span class="token keyword">then</span>
            data<span class="token punctuation">.</span>roundNum <span class="token operator">=</span> data<span class="token punctuation">.</span>roundNum<span class="token operator">+</span><span class="token number">1</span>
        <span class="token keyword">else</span>
            data<span class="token punctuation">.</span>roundNum <span class="token operator">=</span> <span class="token number">1</span>
            data<span class="token punctuation">.</span>beginTime <span class="token operator">=</span> os<span class="token punctuation">.</span><span class="token function">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            data<span class="token punctuation">.</span>curNum <span class="token operator">=</span> num

        <span class="token keyword">end</span>

    <span class="token keyword">end</span><span class="token punctuation">,</span>


    SetPlaceThreeChess <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>roomId<span class="token punctuation">)</span>
        <span class="token keyword">if</span> roomId <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">or</span> GobangData <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">or</span> GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>
        <span class="token keyword">if</span> GobangData<span class="token punctuation">.</span>IsDesignatedStart <span class="token operator">==</span> <span class="token keyword">false</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>
        <span class="token keyword">if</span> GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>IsAI <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>
        <span class="token keyword">if</span> GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>IsStartModeFinish <span class="token operator">==</span> <span class="token keyword">false</span> <span class="token keyword">or</span> GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>IsBeginRound <span class="token operator">==</span><span class="token keyword">false</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>

        <span class="token keyword">local</span> this <span class="token operator">=</span> BattleGame<span class="token punctuation">;</span>
        <span class="token keyword">local</span> data <span class="token operator">=</span> BattleGame<span class="token punctuation">.</span>BattleData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span>
        <span class="token keyword">local</span> ChessData <span class="token operator">=</span> GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span>
        <span class="token keyword">local</span> checkerboardCenterPos<span class="token punctuation">;</span>
        <span class="token keyword">local</span> curRelativePos
        checkerboardCenterPos <span class="token operator">=</span> Config<span class="token punctuation">.</span>CheckerboardCenterPos<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span>
        curRelativePos <span class="token operator">=</span> Config<span class="token punctuation">.</span>ThreeChessRelativePos<span class="token punctuation">[</span>ChessData<span class="token punctuation">.</span>CurStartModeIndex<span class="token punctuation">]</span>

        <span class="token keyword">for</span> k<span class="token punctuation">,</span>v <span class="token keyword">in</span> <span class="token function">pairs</span><span class="token punctuation">(</span>curRelativePos<span class="token punctuation">)</span> <span class="token keyword">do</span>
            <span class="token keyword">local</span> x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>z
            <span class="token keyword">local</span> chessType<span class="token punctuation">;</span>

            x <span class="token operator">=</span> v<span class="token punctuation">.</span>x <span class="token operator">+</span>checkerboardCenterPos<span class="token punctuation">.</span>x
            y <span class="token operator">=</span> v<span class="token punctuation">.</span>y <span class="token operator">+</span>checkerboardCenterPos<span class="token punctuation">.</span>y
            z <span class="token operator">=</span> v<span class="token punctuation">.</span>z <span class="token operator">+</span>checkerboardCenterPos<span class="token punctuation">.</span>z

            <span class="token keyword">if</span> k <span class="token operator">==</span> <span class="token number">2</span> <span class="token keyword">then</span>
                chessType <span class="token operator">=</span> Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>WhiteChess
            <span class="token keyword">else</span>
                chessType <span class="token operator">=</span> Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>BlackChess
            <span class="token keyword">end</span>

            this<span class="token punctuation">.</span><span class="token function">SaveChessInfo</span><span class="token punctuation">(</span>Config<span class="token punctuation">.</span>BlockIdEnum<span class="token punctuation">[</span>chessType<span class="token punctuation">]</span><span class="token punctuation">,</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>z<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">end</span>

    <span class="token keyword">end</span><span class="token punctuation">,</span>


    StartRound <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>roomId<span class="token punctuation">)</span>
        <span class="token keyword">if</span> GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>IsAI <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>

        <span class="token keyword">if</span> GobangData<span class="token punctuation">.</span>IsDesignatedStart <span class="token keyword">then</span>
            GobangData<span class="token punctuation">.</span><span class="token function">SetCurChess</span><span class="token punctuation">(</span>roomId<span class="token punctuation">,</span>Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>WhiteChess<span class="token punctuation">)</span>
        <span class="token keyword">else</span>
            GobangData<span class="token punctuation">.</span><span class="token function">SetCurChess</span><span class="token punctuation">(</span>roomId<span class="token punctuation">,</span>Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>BlackChess<span class="token punctuation">)</span>
        <span class="token keyword">end</span>
        SettingRule<span class="token punctuation">.</span><span class="token function">RoundTimeLimited</span><span class="token punctuation">(</span>roomId<span class="token punctuation">)</span>
        <span class="token keyword">if</span> GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>CurChessType <span class="token operator">==</span> Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>WhiteChess <span class="token keyword">then</span>
            Api<span class="token punctuation">.</span>Chat<span class="token punctuation">:</span><span class="token function">sendSystemMsg</span><span class="token punctuation">(</span><span class="token string">&quot;White round, please place the stone &quot;</span><span class="token punctuation">)</span>
        <span class="token keyword">elseif</span> GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>CurChessType <span class="token operator">==</span> Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>BlackChess <span class="token keyword">then</span>
            Api<span class="token punctuation">.</span>Chat<span class="token punctuation">:</span><span class="token function">sendSystemMsg</span><span class="token punctuation">(</span><span class="token string">&quot;Black round, please place the stone &quot;</span><span class="token punctuation">)</span>
        <span class="token keyword">end</span>
    <span class="token keyword">end</span><span class="token punctuation">,</span>


    BlockPlacedBy <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z<span class="token punctuation">,</span> blockid<span class="token punctuation">,</span> byactor<span class="token punctuation">)</span>
        <span class="token keyword">local</span> this <span class="token operator">=</span> BattleGame<span class="token punctuation">;</span>
        <span class="token keyword">local</span> curRoomId <span class="token operator">=</span> GobangMgr<span class="token punctuation">.</span><span class="token function">GetRoomidByPos</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>z<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">local</span> data <span class="token operator">=</span> GobangData<span class="token punctuation">[</span>curRoomId<span class="token punctuation">]</span>
        <span class="token keyword">local</span> changeState <span class="token operator">=</span> <span class="token keyword">false</span>

        <span class="token keyword">if</span> data<span class="token punctuation">.</span>IsAI <span class="token keyword">or</span> data<span class="token punctuation">.</span>CurChessType <span class="token operator">==</span> Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>None <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>

        <span class="token keyword">if</span> data<span class="token punctuation">.</span>CurChessType <span class="token operator">==</span> Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>BlackChess <span class="token keyword">then</span>
            <span class="token keyword">if</span> blockid <span class="token operator">==</span> Config<span class="token punctuation">.</span>BlockIdEnum<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token keyword">and</span> byactor <span class="token operator">==</span> data<span class="token punctuation">.</span>BlackChess<span class="token punctuation">.</span>uin <span class="token keyword">then</span>
                changeState <span class="token operator">=</span> <span class="token keyword">true</span>
            <span class="token keyword">end</span>
        <span class="token keyword">elseif</span> data<span class="token punctuation">.</span>CurChessType <span class="token operator">==</span> Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>WhiteChess <span class="token keyword">then</span>
            <span class="token keyword">if</span> blockid <span class="token operator">==</span> Config<span class="token punctuation">.</span>BlockIdEnum<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token keyword">and</span> byactor <span class="token operator">==</span> data<span class="token punctuation">.</span>WhiteChess<span class="token punctuation">.</span>uin <span class="token keyword">then</span>
                changeState <span class="token operator">=</span> <span class="token keyword">true</span>
            <span class="token keyword">end</span>
        <span class="token keyword">end</span>

        <span class="token keyword">if</span> changeState <span class="token operator">==</span> <span class="token keyword">false</span> <span class="token keyword">then</span>
            Api<span class="token punctuation">.</span>Player<span class="token punctuation">:</span><span class="token function">notifyGameInfo2Self</span><span class="token punctuation">(</span>byactor<span class="token punctuation">,</span><span class="token string">&quot;It is other side turn &quot;</span><span class="token punctuation">)</span>
            Api<span class="token punctuation">.</span>Block<span class="token punctuation">:</span><span class="token function">destroyBlock</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>z<span class="token punctuation">,</span><span class="token keyword">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span>
        <span class="token keyword">end</span>

        <span class="token keyword">local</span> chessList <span class="token operator">=</span> this<span class="token punctuation">.</span><span class="token function">GetChessListByBlockId</span><span class="token punctuation">(</span>curRoomId<span class="token punctuation">,</span>blockid<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> chessList <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span><span class="token punctuation">;</span>

        this<span class="token punctuation">.</span><span class="token function">SaveChessInfo</span><span class="token punctuation">(</span>blockid<span class="token punctuation">,</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>z<span class="token punctuation">)</span>
        this<span class="token punctuation">.</span><span class="token function">JudgeVictory</span><span class="token punctuation">(</span>curRoomId<span class="token punctuation">,</span>chessList<span class="token punctuation">,</span>byactor<span class="token punctuation">)</span>

        <span class="token keyword">if</span> data<span class="token punctuation">.</span>CurChessType <span class="token operator">==</span> Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>BlackChess <span class="token keyword">then</span>

            GobangData<span class="token punctuation">.</span><span class="token function">SetCurChess</span><span class="token punctuation">(</span>curRoomId<span class="token punctuation">,</span>Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>WhiteChess<span class="token punctuation">)</span>

        <span class="token keyword">elseif</span> data<span class="token punctuation">.</span>CurChessType <span class="token operator">==</span> Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>WhiteChess <span class="token keyword">then</span>

            GobangData<span class="token punctuation">.</span><span class="token function">SetCurChess</span><span class="token punctuation">(</span>curRoomId<span class="token punctuation">,</span>Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>BlackChess<span class="token punctuation">)</span>
        <span class="token keyword">end</span>

        SettingRule<span class="token punctuation">.</span><span class="token function">RoundTimeLimited</span><span class="token punctuation">(</span>curRoomId<span class="token punctuation">)</span>
        <span class="token keyword">if</span> GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>CurChessType <span class="token operator">==</span> Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>WhiteChess <span class="token keyword">then</span>
            Api<span class="token punctuation">.</span>Chat<span class="token punctuation">:</span><span class="token function">sendSystemMsg</span><span class="token punctuation">(</span><span class="token string">&quot;White round, please place the stone &quot;</span><span class="token punctuation">)</span>
        <span class="token keyword">elseif</span> GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>CurChessType <span class="token operator">==</span> Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>BlackChess <span class="token keyword">then</span>
            Api<span class="token punctuation">.</span>Chat<span class="token punctuation">:</span><span class="token function">sendSystemMsg</span><span class="token punctuation">(</span><span class="token string">&quot;Black round, please place the stone &quot;</span><span class="token punctuation">)</span>
        <span class="token keyword">end</span>

    <span class="token keyword">end</span><span class="token punctuation">,</span>


    SetStartGameData <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>roomId<span class="token punctuation">)</span>
        <span class="token keyword">if</span> roomId <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>
        <span class="token keyword">if</span> GobangData<span class="token punctuation">.</span>IsDesignatedStart <span class="token operator">~=</span> <span class="token keyword">true</span> <span class="token keyword">then</span>
            GobangData<span class="token punctuation">.</span><span class="token function">SetBeginRound</span><span class="token punctuation">(</span>roomId<span class="token punctuation">,</span><span class="token keyword">true</span><span class="token punctuation">)</span>
        <span class="token keyword">end</span>
    <span class="token keyword">end</span><span class="token punctuation">,</span>


    ResetData <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>roomId<span class="token punctuation">)</span>
        <span class="token keyword">local</span> data <span class="token operator">=</span> BattleGame<span class="token punctuation">.</span>BattleData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span>

        <span class="token keyword">for</span> k<span class="token punctuation">,</span>v <span class="token keyword">in</span> <span class="token function">pairs</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>whiteChessList<span class="token punctuation">)</span> <span class="token keyword">do</span>
            Api<span class="token punctuation">.</span>Block<span class="token punctuation">:</span><span class="token function">destroyBlock</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span>x<span class="token punctuation">,</span>v<span class="token punctuation">.</span>y<span class="token punctuation">,</span>v<span class="token punctuation">.</span>z<span class="token punctuation">,</span><span class="token keyword">false</span><span class="token punctuation">)</span>
        <span class="token keyword">end</span>

        <span class="token keyword">for</span> k<span class="token punctuation">,</span>v <span class="token keyword">in</span> <span class="token function">pairs</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>blackChessList<span class="token punctuation">)</span> <span class="token keyword">do</span>
            Api<span class="token punctuation">.</span>Block<span class="token punctuation">:</span><span class="token function">destroyBlock</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span>x<span class="token punctuation">,</span>v<span class="token punctuation">.</span>y<span class="token punctuation">,</span>v<span class="token punctuation">.</span>z<span class="token punctuation">,</span><span class="token keyword">false</span><span class="token punctuation">)</span>
        <span class="token keyword">end</span>

        BattleGame<span class="token punctuation">.</span>BattleData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>whiteChessList <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
        BattleGame<span class="token punctuation">.</span>BattleData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>blackChessList <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
        BattleGame<span class="token punctuation">.</span>BattleData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>battleData <span class="token operator">=</span> <span class="token punctuation">{</span>
            beginTime<span class="token operator">=</span>os<span class="token punctuation">.</span><span class="token function">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            roundNum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>
            curNum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span>

    <span class="token keyword">end</span><span class="token punctuation">,</span>


<span class="token punctuation">}</span>


TimerManager <span class="token operator">=</span> <span class="token punctuation">{</span>

    TaskList <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    CountdownTaskList <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    Tick <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>
    CountdownTick <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>

    RoundTimer <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>

    CreateTimer <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>timeInterval<span class="token punctuation">,</span>func<span class="token punctuation">)</span>
        <span class="token keyword">if</span> timeInterval <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>
        <span class="token keyword">local</span> this <span class="token operator">=</span> TimerManager
        <span class="token keyword">local</span> timeList <span class="token operator">=</span> <span class="token punctuation">{</span>
            beginTime <span class="token operator">=</span> os<span class="token punctuation">.</span><span class="token function">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            timeInterval <span class="token operator">=</span> timeInterval<span class="token punctuation">,</span>
            func <span class="token operator">=</span> func<span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
        table<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>this<span class="token punctuation">.</span>TaskList<span class="token punctuation">,</span>timeList<span class="token punctuation">)</span>
    <span class="token keyword">end</span><span class="token punctuation">,</span>


    CreateCountdownTimer <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>timeInterval<span class="token punctuation">,</span>uin<span class="token punctuation">,</span>func<span class="token punctuation">)</span>
        <span class="token keyword">if</span> timeInterval <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">or</span> timeInterval <span class="token operator">&lt;=</span><span class="token number">0</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>
        <span class="token keyword">local</span> this <span class="token operator">=</span> TimerManager

        <span class="token keyword">local</span> timeList <span class="token operator">=</span> <span class="token punctuation">{</span>
            beginTime <span class="token operator">=</span> os<span class="token punctuation">.</span><span class="token function">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            timeInterval <span class="token operator">=</span> timeInterval<span class="token punctuation">,</span>
            uin <span class="token operator">=</span> uin<span class="token punctuation">,</span>
            func <span class="token operator">=</span> func<span class="token punctuation">,</span>
        <span class="token punctuation">}</span>

        table<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>this<span class="token punctuation">.</span>CountdownTaskList<span class="token punctuation">,</span>timeList<span class="token punctuation">)</span>
    <span class="token keyword">end</span><span class="token punctuation">,</span>


    StartRoundTimer <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>roomId<span class="token punctuation">,</span>uins<span class="token punctuation">,</span>timeInterval<span class="token punctuation">,</span>func<span class="token punctuation">)</span>
        <span class="token keyword">if</span> func <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">or</span> roomId <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>
        <span class="token keyword">local</span> timer <span class="token operator">=</span> TimerManager<span class="token punctuation">.</span>RoundTimer<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span>
        <span class="token keyword">if</span> timer <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">or</span> timer<span class="token punctuation">.</span>timerid <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span>
            <span class="token keyword">local</span> ret<span class="token punctuation">,</span>timerid <span class="token operator">=</span> Api<span class="token punctuation">.</span>MiniTimer<span class="token punctuation">:</span><span class="token function">createTimer</span><span class="token punctuation">(</span><span class="token string">&quot;Countdown&quot;</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span> ret <span class="token operator">==</span> ErrorCode<span class="token punctuation">.</span>OK <span class="token keyword">then</span>
                <span class="token keyword">local</span> round <span class="token operator">=</span> <span class="token punctuation">{</span>
                    RoundInterval <span class="token operator">=</span> <span class="token number">60</span><span class="token punctuation">,</span>
                    RoundFunc <span class="token operator">=</span> func<span class="token punctuation">,</span>
                    BeginTime <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>
                    Uins <span class="token operator">=</span> uins<span class="token punctuation">,</span>
                    timerid <span class="token operator">=</span> timerid<span class="token punctuation">,</span>
                <span class="token punctuation">}</span>

                <span class="token keyword">if</span> timeInterval <span class="token operator">~=</span> <span class="token keyword">nil</span> <span class="token keyword">and</span> timeInterval <span class="token operator">&gt;=</span> <span class="token number">0</span> <span class="token keyword">then</span>
                    round<span class="token punctuation">.</span>RoundInterval <span class="token operator">=</span> timeInterval<span class="token punctuation">;</span>
                <span class="token keyword">end</span>
                TimerManager<span class="token punctuation">.</span>RoundTimer<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span> <span class="token operator">=</span> round
                timer <span class="token operator">=</span> round
            <span class="token keyword">end</span>
        <span class="token keyword">end</span>

        <span class="token keyword">local</span> ret <span class="token operator">=</span> Api<span class="token punctuation">.</span>MiniTimer<span class="token punctuation">:</span><span class="token function">startBackwardTimer</span><span class="token punctuation">(</span>timer<span class="token punctuation">.</span>timerid<span class="token punctuation">,</span>timer<span class="token punctuation">.</span>RoundInterval<span class="token punctuation">,</span><span class="token keyword">false</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> ret <span class="token operator">~=</span> ErrorCode<span class="token punctuation">.</span>OK <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>

        <span class="token keyword">local</span> text <span class="token operator">=</span> <span class="token string">&quot;&quot;</span>
        <span class="token keyword">if</span> GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>CurChessType <span class="token operator">==</span> Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>BlackChess <span class="token keyword">then</span>
            text <span class="token operator">=</span> <span class="token string">&quot;Black round countdown： &quot;</span>
        <span class="token keyword">elseif</span> GobangData<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span><span class="token punctuation">.</span>CurChessType <span class="token operator">==</span> Config<span class="token punctuation">.</span>ChessType<span class="token punctuation">.</span>WhiteChess <span class="token keyword">then</span>
            text <span class="token operator">=</span> <span class="token string">&quot;White round countdown： &quot;</span>
        <span class="token keyword">end</span>

        <span class="token keyword">local</span> ret <span class="token operator">=</span> Api<span class="token punctuation">.</span>MiniTimer<span class="token punctuation">:</span><span class="token function">showTimerTips</span><span class="token punctuation">(</span>timer<span class="token punctuation">.</span>Uins<span class="token punctuation">,</span>timer<span class="token punctuation">.</span>timerid<span class="token punctuation">,</span>text<span class="token punctuation">,</span><span class="token keyword">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> ret <span class="token operator">~=</span> ErrorCode<span class="token punctuation">.</span>OK <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>
        timer<span class="token punctuation">.</span>BeginTime <span class="token operator">=</span> os<span class="token punctuation">.</span><span class="token function">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">end</span><span class="token punctuation">,</span>

    ClearRoundTimer <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>roomId<span class="token punctuation">)</span>
        <span class="token keyword">if</span> roomId <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>

        <span class="token keyword">local</span> this <span class="token operator">=</span> TimerManager
        <span class="token keyword">local</span> timer <span class="token operator">=</span> this<span class="token punctuation">.</span>RoundTimer<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span>
        <span class="token keyword">if</span> timer <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span> <span class="token keyword">return</span> <span class="token keyword">end</span>

        Api<span class="token punctuation">.</span>MiniTimer<span class="token punctuation">:</span><span class="token function">showTimerTips</span><span class="token punctuation">(</span>timer<span class="token punctuation">.</span>Uins<span class="token punctuation">,</span>timer<span class="token punctuation">.</span>timerid<span class="token punctuation">,</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span><span class="token keyword">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        Api<span class="token punctuation">.</span>MiniTimer<span class="token punctuation">:</span><span class="token function">deleteTimer</span><span class="token punctuation">(</span>timer<span class="token punctuation">.</span>timerid<span class="token punctuation">)</span>
        this<span class="token punctuation">.</span>RoundTimer<span class="token punctuation">[</span>roomId<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">nil</span>
    <span class="token keyword">end</span><span class="token punctuation">,</span>

    Update <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">local</span> this <span class="token operator">=</span> TimerManager
        this<span class="token punctuation">.</span>Tick <span class="token operator">=</span> this<span class="token punctuation">.</span>Tick <span class="token operator">+</span> <span class="token number">1</span>
        this<span class="token punctuation">.</span>CountdownTick <span class="token operator">=</span> this<span class="token punctuation">.</span>CountdownTick <span class="token operator">+</span> <span class="token number">1</span>

        <span class="token keyword">if</span> this<span class="token punctuation">.</span>Tick <span class="token operator">&gt;=</span><span class="token number">10</span> <span class="token keyword">then</span>
            this<span class="token punctuation">.</span>Tick <span class="token operator">=</span> <span class="token number">0</span>
            <span class="token keyword">for</span> k<span class="token punctuation">,</span>v <span class="token keyword">in</span> <span class="token function">pairs</span><span class="token punctuation">(</span>this<span class="token punctuation">.</span>TaskList<span class="token punctuation">)</span> <span class="token keyword">do</span>
                <span class="token keyword">if</span> v <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span> <span class="token keyword">break</span> <span class="token keyword">end</span>
                <span class="token keyword">if</span> os<span class="token punctuation">.</span><span class="token function">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;=</span>v<span class="token punctuation">.</span>beginTime<span class="token operator">+</span>v<span class="token punctuation">.</span>timeInterval <span class="token keyword">and</span> v<span class="token punctuation">.</span>func <span class="token operator">~=</span> <span class="token keyword">nil</span> <span class="token keyword">then</span>
                    v<span class="token punctuation">.</span><span class="token function">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

                    table<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>this<span class="token punctuation">.</span>TaskList<span class="token punctuation">,</span>k<span class="token punctuation">)</span>
                <span class="token keyword">end</span>
            <span class="token keyword">end</span>
        <span class="token keyword">end</span>

        <span class="token keyword">if</span> this<span class="token punctuation">.</span>CountdownTick <span class="token operator">&gt;=</span><span class="token number">20</span> <span class="token keyword">then</span>
            this<span class="token punctuation">.</span>CountdownTick <span class="token operator">=</span> <span class="token number">0</span>

            <span class="token keyword">for</span> k<span class="token punctuation">,</span>v <span class="token keyword">in</span> <span class="token function">pairs</span><span class="token punctuation">(</span>this<span class="token punctuation">.</span>CountdownTaskList<span class="token punctuation">)</span> <span class="token keyword">do</span>
                <span class="token keyword">if</span> v <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span> <span class="token keyword">break</span> <span class="token keyword">end</span>
                <span class="token keyword">local</span> num <span class="token operator">=</span> v<span class="token punctuation">.</span>beginTime<span class="token operator">+</span>v<span class="token punctuation">.</span>timeInterval <span class="token operator">-</span> os<span class="token punctuation">.</span><span class="token function">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token keyword">if</span> num <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token keyword">and</span> v<span class="token punctuation">.</span>uin <span class="token operator">~=</span> <span class="token keyword">nil</span> <span class="token keyword">then</span>
                    Api<span class="token punctuation">.</span>Player<span class="token punctuation">:</span><span class="token function">notifyGameInfo2Self</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span>uin<span class="token punctuation">,</span><span class="token string">&quot;countdown &quot;</span><span class="token operator">..</span>num<span class="token operator">..</span><span class="token string">&quot;seconds &quot;</span><span class="token punctuation">)</span>
                <span class="token keyword">end</span>
                <span class="token keyword">if</span> os<span class="token punctuation">.</span><span class="token function">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;=</span>v<span class="token punctuation">.</span>beginTime<span class="token operator">+</span>v<span class="token punctuation">.</span>timeInterval <span class="token keyword">and</span> v<span class="token punctuation">.</span>func <span class="token operator">~=</span> <span class="token keyword">nil</span> <span class="token keyword">then</span>
                    v<span class="token punctuation">.</span><span class="token function">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                    table<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>this<span class="token punctuation">.</span>CountdownTaskList<span class="token punctuation">,</span>k<span class="token punctuation">)</span>
                <span class="token keyword">end</span>
            <span class="token keyword">end</span>


        <span class="token keyword">end</span>

        <span class="token keyword">for</span> k<span class="token punctuation">,</span>v <span class="token keyword">in</span> <span class="token function">pairs</span><span class="token punctuation">(</span>this<span class="token punctuation">.</span>RoundTimer<span class="token punctuation">)</span> <span class="token keyword">do</span>
            <span class="token keyword">if</span> GobangData<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">.</span>IsBeginRound <span class="token operator">==</span> <span class="token keyword">false</span> <span class="token keyword">then</span> <span class="token keyword">break</span> <span class="token keyword">end</span>
            <span class="token keyword">if</span> v <span class="token operator">==</span> <span class="token keyword">nil</span> <span class="token keyword">then</span> <span class="token keyword">break</span> <span class="token keyword">end</span>
            <span class="token keyword">if</span> v<span class="token punctuation">.</span>BeginTime <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token keyword">then</span> <span class="token keyword">break</span> <span class="token keyword">end</span>

            <span class="token keyword">local</span> ret<span class="token punctuation">,</span>time <span class="token operator">=</span> Api<span class="token punctuation">.</span>MiniTimer<span class="token punctuation">:</span><span class="token function">getTimerTime</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span>timerid<span class="token punctuation">)</span>
            <span class="token keyword">if</span> ret <span class="token operator">==</span> ErrorCode<span class="token punctuation">.</span>OK <span class="token keyword">and</span> time <span class="token operator">==</span>  <span class="token number">1</span> <span class="token keyword">then</span>
                v<span class="token punctuation">.</span>BeginTime <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span>
                Api<span class="token punctuation">.</span>MiniTimer<span class="token punctuation">:</span><span class="token function">showTimerTips</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span>Uins<span class="token punctuation">,</span>v<span class="token punctuation">.</span>timerid<span class="token punctuation">,</span><span class="token string">&quot;countdown： &quot;</span><span class="token punctuation">,</span><span class="token keyword">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> v<span class="token punctuation">.</span>RoundFunc <span class="token operator">~=</span> <span class="token keyword">nil</span> <span class="token keyword">then</span>
                    <span class="token keyword">local</span> func <span class="token operator">=</span> v<span class="token punctuation">.</span>RoundFunc
                    <span class="token function">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token keyword">end</span>
                this<span class="token punctuation">.</span>RoundTimer<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">nil</span>
            <span class="token keyword">end</span>
        <span class="token keyword">end</span>
    <span class="token keyword">end</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token function">listenevents_gobang</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/Lua/Stone_code.html" class="prev">
        Stone Code
      </a></span> <span class="next"><a href="/Lua/fight_for_gold_bricks.html">
        夺金之战（Fight for Gold Bricks）
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.ef735673.js" defer></script><script src="/assets/js/2.b51029ec.js" defer></script><script src="/assets/js/37.72568f5d.js" defer></script>
  </body>
</html>
